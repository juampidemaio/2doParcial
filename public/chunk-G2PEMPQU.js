import{A as gf,D as Re,Da as mf,E as ac,Ea as yf,F as sn,G as Ww,Ja as vf,K as uc,L as cc,M as lc,N as Kw,O as zi,P as dc,Pa as _f,R as ot,a as $,b as De,e as ff,f as x,g as Hw,h as rc,i as qw,j as zw,n as ic,p as oc,pb as wf,q as ea,v as pf,w as Gw,x as sc}from"./chunk-USSI7TAN.js";function Qw(n,e){return Object.is(n,e)}var Qe=null,hc=!1,fc=1,Nn=Symbol("SIGNAL");function ge(n){let e=Qe;return Qe=n,e}function Yw(){return Qe}var na={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Df(n){if(hc)throw new Error("");if(Qe===null)return;Qe.consumerOnSignalRead(n);let e=Qe.nextProducerIndex++;if(yc(Qe),e<Qe.producerNode.length&&Qe.producerNode[e]!==n&&ta(Qe)){let t=Qe.producerNode[e];mc(t,Qe.producerIndexOfThis[e])}Qe.producerNode[e]!==n&&(Qe.producerNode[e]=n,Qe.producerIndexOfThis[e]=ta(Qe)?eI(n,Qe,e):0),Qe.producerLastReadVersion[e]=n.version}function gR(){fc++}function Zw(n){if(!(ta(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===fc)){if(!n.producerMustRecompute(n)&&!Cf(n)){n.dirty=!1,n.lastCleanEpoch=fc;return}n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=fc}}function Jw(n){if(n.liveConsumerNode===void 0)return;let e=hc;hc=!0;try{for(let t of n.liveConsumerNode)t.dirty||mR(t)}finally{hc=e}}function Xw(){return Qe?.consumerAllowSignalWrites!==!1}function mR(n){n.dirty=!0,Jw(n),n.consumerMarkedDirty?.(n)}function gc(n){return n&&(n.nextProducerIndex=0),ge(n)}function Tf(n,e){if(ge(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(ta(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)mc(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function Cf(n){yc(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(Zw(t),r!==t.version))return!0}return!1}function bf(n){if(yc(n),ta(n))for(let e=0;e<n.producerNode.length;e++)mc(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function eI(n,e,t){if(tI(n),n.liveConsumerNode.length===0&&nI(n))for(let r=0;r<n.producerNode.length;r++)n.producerIndexOfThis[r]=eI(n.producerNode[r],n,r);return n.liveConsumerIndexOfThis.push(t),n.liveConsumerNode.push(e)-1}function mc(n,e){if(tI(n),n.liveConsumerNode.length===1&&nI(n))for(let r=0;r<n.producerNode.length;r++)mc(n.producerNode[r],n.producerIndexOfThis[r]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];yc(i),i.producerIndexOfThis[r]=e}}function ta(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function yc(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function tI(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function nI(n){return n.producerNode!==void 0}function rI(n){let e=Object.create(yR);e.computation=n;let t=()=>{if(Zw(e),Df(e),e.value===pc)throw e.error;return e.value};return t[Nn]=e,t}var If=Symbol("UNSET"),Ef=Symbol("COMPUTING"),pc=Symbol("ERRORED"),yR=De($({},na),{value:If,dirty:!0,error:null,equal:Qw,producerMustRecompute(n){return n.value===If||n.value===Ef},producerRecomputeValue(n){if(n.value===Ef)throw new Error("Detected cycle in computations.");let e=n.value;n.value=Ef;let t=gc(n),r;try{r=n.computation()}catch(i){r=pc,n.error=i}finally{Tf(n,t)}if(e!==If&&e!==pc&&r!==pc&&n.equal(e,r)){n.value=e;return}n.value=r,n.version++}});function vR(){throw new Error}var iI=vR;function oI(){iI()}function sI(n){iI=n}var _R=null;function aI(n){let e=Object.create(cI);e.value=n;let t=()=>(Df(e),e.value);return t[Nn]=e,t}function Sf(n,e){Xw()||oI(),n.equal(n.value,e)||(n.value=e,wR(n))}function uI(n,e){Xw()||oI(),Sf(n,e(n.value))}var cI=De($({},na),{equal:Qw,value:void 0});function wR(n){n.version++,gR(),Jw(n),_R?.()}function X(n){return typeof n=="function"}function Gi(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var vc=Gi(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Qr(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var ke=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(X(r))try{r()}catch(o){e=o instanceof vc?o.errors:[o]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let o of i)try{lI(o)}catch(s){e=e??[],s instanceof vc?e=[...e,...s.errors]:e.push(s)}}if(e)throw new vc(e)}}add(e){var t;if(e&&e!==this)if(this.closed)lI(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Qr(t,e)}remove(e){let{_finalizers:t}=this;t&&Qr(t,e),e instanceof n&&e._removeParent(this)}};ke.EMPTY=(()=>{let n=new ke;return n.closed=!0,n})();var Af=ke.EMPTY;function _c(n){return n instanceof ke||n&&"closed"in n&&X(n.remove)&&X(n.add)&&X(n.unsubscribe)}function lI(n){X(n)?n():n.unsubscribe()}var Yt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Wi={setTimeout(n,e,...t){let{delegate:r}=Wi;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=Wi;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function wc(n){Wi.setTimeout(()=>{let{onUnhandledError:e}=Yt;if(e)e(n);else throw n})}function ra(){}var dI=Rf("C",void 0,void 0);function hI(n){return Rf("E",void 0,n)}function fI(n){return Rf("N",n,void 0)}function Rf(n,e,t){return{kind:n,value:e,error:t}}var Yr=null;function Ki(n){if(Yt.useDeprecatedSynchronousErrorHandling){let e=!Yr;if(e&&(Yr={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=Yr;if(Yr=null,t)throw r}}else n()}function pI(n){Yt.useDeprecatedSynchronousErrorHandling&&Yr&&(Yr.errorThrown=!0,Yr.error=n)}var Zr=class extends ke{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,_c(e)&&e.add(this)):this.destination=DR}static create(e,t,r){return new Pn(e,t,r)}next(e){this.isStopped?Mf(fI(e),this):this._next(e)}error(e){this.isStopped?Mf(hI(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Mf(dI,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},IR=Function.prototype.bind;function xf(n,e){return IR.call(n,e)}var Nf=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){Ic(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){Ic(r)}else Ic(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Ic(t)}}},Pn=class extends Zr{constructor(e,t,r){super();let i;if(X(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let o;this&&Yt.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&xf(e.next,o),error:e.error&&xf(e.error,o),complete:e.complete&&xf(e.complete,o)}):i=e}this.destination=new Nf(i)}};function Ic(n){Yt.useDeprecatedSynchronousErrorHandling?pI(n):wc(n)}function ER(n){throw n}function Mf(n,e){let{onStoppedNotification:t}=Yt;t&&Wi.setTimeout(()=>t(n,e))}var DR={closed:!0,next:ra,error:ER,complete:ra};var Qi=typeof Symbol=="function"&&Symbol.observable||"@@observable";function vt(n){return n}function Pf(...n){return kf(n)}function kf(n){return n.length===0?vt:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var he=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let o=CR(t)?t:new Pn(t,r,i);return Ki(()=>{let{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=gI(r),new r((i,o)=>{let s=new Pn({next:a=>{try{t(a)}catch(u){o(u),s.unsubscribe()}},error:o,complete:i});this.subscribe(s)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[Qi](){return this}pipe(...t){return kf(t)(this)}toPromise(t){return t=gI(t),new t((r,i)=>{let o;this.subscribe(s=>o=s,s=>i(s),()=>r(o))})}}return n.create=e=>new n(e),n})();function gI(n){var e;return(e=n??Yt.Promise)!==null&&e!==void 0?e:Promise}function TR(n){return n&&X(n.next)&&X(n.error)&&X(n.complete)}function CR(n){return n&&n instanceof Zr||TR(n)&&_c(n)}function Of(n){return X(n?.lift)}function oe(n){return e=>{if(Of(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function se(n,e,t,r,i){return new Ff(n,e,t,r,i)}var Ff=class extends Zr{constructor(e,t,r,i,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(u){e.error(u)}}:super._next,this._error=i?function(a){try{i(a)}catch(u){e.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Yi(){return oe((n,e)=>{let t=null;n._refCount++;let r=se(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let i=n._connection,o=t;t=null,i&&(!o||i===o)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}var Zi=class extends he{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Of(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new ke;let t=this.getSubject();e.add(this.source.subscribe(se(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=ke.EMPTY)}return e}refCount(){return Yi()(this)}};var mI=Gi(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Ye=(()=>{class n extends he{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new Ec(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new mI}next(t){Ki(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){Ki(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){Ki(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:o}=this;return r||i?Af:(this.currentObservers=null,o.push(t),new ke(()=>{this.currentObservers=null,Qr(o,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:o}=this;r?t.error(i):o&&t.complete()}asObservable(){let t=new he;return t.source=this,t}}return n.create=(e,t)=>new Ec(e,t),n})(),Ec=class extends Ye{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:Af}};var Ze=class extends Ye{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var ia={now(){return(ia.delegate||Date).now()},delegate:void 0};var Dc=class extends Ye{constructor(e=1/0,t=1/0,r=ia){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){let{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:o,_windowTime:s}=this;t||(r.push(e),!i&&r.push(o.now()+s)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,o=i.slice();for(let s=0;s<o.length&&!e.closed;s+=r?1:2)e.next(o[s]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){let{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,o=(i?1:2)*e;if(e<1/0&&o<r.length&&r.splice(0,r.length-o),!i){let s=t.now(),a=0;for(let u=1;u<r.length&&r[u]<=s;u+=2)a=u;a&&r.splice(0,a+1)}}};var Tc=class extends ke{constructor(e,t){super()}schedule(e,t=0){return this}};var oa={setInterval(n,e,...t){let{delegate:r}=oa;return r?.setInterval?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=oa;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var Ji=class extends Tc{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;let i=this.id,o=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(o,i,t)),this.pending=!0,this.delay=t,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(o,this.id,t),this}requestAsyncId(e,t,r=0){return oa.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return t;t!=null&&oa.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,t);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r=!1,i;try{this.work(e)}catch(o){r=!0,i=o||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Qr(r,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var Xi=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}};Xi.now=ia.now;var eo=class extends Xi{constructor(e,t=Xi.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}};var Lf=new eo(Ji);var Cc=class extends Ji{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,t,r):(e.flush(this),0)}};var bc=class extends eo{};var Vf=new bc(Cc);var _t=new he(n=>n.complete());function yI(n){return n&&X(n.schedule)}function jf(n){return n[n.length-1]}function Sc(n){return X(jf(n))?n.pop():void 0}function an(n){return yI(jf(n))?n.pop():void 0}function vI(n,e){return typeof jf(n)=="number"?n.pop():e}var Ac=n=>n&&typeof n.length=="number"&&typeof n!="function";function Rc(n){return X(n?.then)}function xc(n){return X(n[Qi])}function Mc(n){return Symbol.asyncIterator&&X(n?.[Symbol.asyncIterator])}function Nc(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function bR(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Pc=bR();function kc(n){return X(n?.[Pc])}function Oc(n){return qw(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield rc(t.read());if(i)return yield rc(void 0);yield yield rc(r)}}finally{t.releaseLock()}})}function Fc(n){return X(n?.getReader)}function Se(n){if(n instanceof he)return n;if(n!=null){if(xc(n))return SR(n);if(Ac(n))return AR(n);if(Rc(n))return RR(n);if(Mc(n))return _I(n);if(kc(n))return xR(n);if(Fc(n))return MR(n)}throw Nc(n)}function SR(n){return new he(e=>{let t=n[Qi]();if(X(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function AR(n){return new he(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function RR(n){return new he(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,wc)})}function xR(n){return new he(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function _I(n){return new he(e=>{NR(n,e).catch(t=>e.error(t))})}function MR(n){return _I(Oc(n))}function NR(n,e){var t,r,i,o;return Hw(this,void 0,void 0,function*(){try{for(t=zw(n);r=yield t.next(),!r.done;){let s=r.value;if(e.next(s),e.closed)return}}catch(s){i={error:s}}finally{try{r&&!r.done&&(o=t.return)&&(yield o.call(t))}finally{if(i)throw i.error}}e.complete()})}function At(n,e,t,r=0,i=!1){let o=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(o),!i)return o}function or(n,e=0){return oe((t,r)=>{t.subscribe(se(r,i=>At(r,n,()=>r.next(i),e),()=>At(r,n,()=>r.complete(),e),i=>At(r,n,()=>r.error(i),e)))})}function sr(n,e=0){return oe((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function wI(n,e){return Se(n).pipe(sr(e),or(e))}function II(n,e){return Se(n).pipe(sr(e),or(e))}function EI(n,e){return new he(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function DI(n,e){return new he(t=>{let r;return At(t,e,()=>{r=n[Pc](),At(t,e,()=>{let i,o;try{({value:i,done:o}=r.next())}catch(s){t.error(s);return}o?t.complete():t.next(i)},0,!0)}),()=>X(r?.return)&&r.return()})}function Lc(n,e){if(!n)throw new Error("Iterable cannot be null");return new he(t=>{At(t,e,()=>{let r=n[Symbol.asyncIterator]();At(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function TI(n,e){return Lc(Oc(n),e)}function CI(n,e){if(n!=null){if(xc(n))return wI(n,e);if(Ac(n))return EI(n,e);if(Rc(n))return II(n,e);if(Mc(n))return Lc(n,e);if(kc(n))return DI(n,e);if(Fc(n))return TI(n,e)}throw Nc(n)}function Me(n,e){return e?CI(n,e):Se(n)}function J(...n){let e=an(n);return Me(n,e)}function to(n,e){let t=X(n)?n:()=>n,r=i=>i.error(t());return new he(e?i=>e.schedule(r,0,i):r)}function Uf(n){return!!n&&(n instanceof he||X(n.lift)&&X(n.subscribe))}var kn=Gi(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function le(n,e){return oe((t,r)=>{let i=0;t.subscribe(se(r,o=>{r.next(n.call(e,o,i++))}))})}var{isArray:PR}=Array;function kR(n,e){return PR(e)?n(...e):n(e)}function Vc(n){return le(e=>kR(n,e))}var{isArray:OR}=Array,{getPrototypeOf:FR,prototype:LR,keys:VR}=Object;function jc(n){if(n.length===1){let e=n[0];if(OR(e))return{args:e,keys:null};if(jR(e)){let t=VR(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function jR(n){return n&&typeof n=="object"&&FR(n)===LR}function Uc(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function sa(...n){let e=an(n),t=Sc(n),{args:r,keys:i}=jc(n);if(r.length===0)return Me([],e);let o=new he(UR(r,e,i?s=>Uc(i,s):vt));return t?o.pipe(Vc(t)):o}function UR(n,e,t=vt){return r=>{bI(e,()=>{let{length:i}=n,o=new Array(i),s=i,a=i;for(let u=0;u<i;u++)bI(e,()=>{let l=Me(n[u],e),h=!1;l.subscribe(se(r,p=>{o[u]=p,h||(h=!0,a--),a||r.next(t(o.slice()))},()=>{--s||r.complete()}))},r)},r)}}function bI(n,e,t){n?At(t,n,e):e()}function SI(n,e,t,r,i,o,s,a){let u=[],l=0,h=0,p=!1,m=()=>{p&&!u.length&&!l&&e.complete()},y=R=>l<r?D(R):u.push(R),D=R=>{o&&e.next(R),l++;let S=!1;Se(t(R,h++)).subscribe(se(e,O=>{i?.(O),o?y(O):e.next(O)},()=>{S=!0},void 0,()=>{if(S)try{for(l--;u.length&&l<r;){let O=u.shift();s?At(e,s,()=>D(O)):D(O)}m()}catch(O){e.error(O)}}))};return n.subscribe(se(e,y,()=>{p=!0,m()})),()=>{a?.()}}function qe(n,e,t=1/0){return X(e)?qe((r,i)=>le((o,s)=>e(r,o,i,s))(Se(n(r,i))),t):(typeof e=="number"&&(t=e),oe((r,i)=>SI(r,i,n,t)))}function ar(n=1/0){return qe(vt,n)}function AI(){return ar(1)}function no(...n){return AI()(Me(n,an(n)))}function Bc(n){return new he(e=>{Se(n()).subscribe(e)})}function BR(...n){let e=Sc(n),{args:t,keys:r}=jc(n),i=new he(o=>{let{length:s}=t;if(!s){o.complete();return}let a=new Array(s),u=s,l=s;for(let h=0;h<s;h++){let p=!1;Se(t[h]).subscribe(se(o,m=>{p||(p=!0,l--),a[h]=m},()=>u--,void 0,()=>{(!u||!p)&&(l||o.next(r?Uc(r,a):a),o.complete())}))}});return e?i.pipe(Vc(e)):i}function $R(...n){let e=an(n),t=vI(n,1/0),r=n;return r.length?r.length===1?Se(r[0]):ar(t)(Me(r,e)):_t}function Bt(n,e){return oe((t,r)=>{let i=0;t.subscribe(se(r,o=>n.call(e,o,i++)&&r.next(o)))})}function ur(n){return oe((e,t)=>{let r=null,i=!1,o;r=e.subscribe(se(t,void 0,void 0,s=>{o=Se(n(s,ur(n)(e))),r?(r.unsubscribe(),r=null,o.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,o.subscribe(t))})}function RI(n,e,t,r,i){return(o,s)=>{let a=t,u=e,l=0;o.subscribe(se(s,h=>{let p=l++;u=a?n(u,h,p):(a=!0,h),r&&s.next(u)},i&&(()=>{a&&s.next(u),s.complete()})))}}function Jr(n,e){return X(e)?qe(n,e,1):qe(n,1)}function cr(n){return oe((e,t)=>{let r=!1;e.subscribe(se(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function On(n){return n<=0?()=>_t:oe((e,t)=>{let r=0;e.subscribe(se(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function Bf(n){return le(()=>n)}function HR(n,e=vt){return n=n??qR,oe((t,r)=>{let i,o=!0;t.subscribe(se(r,s=>{let a=e(s);(o||!n(i,a))&&(o=!1,i=a,r.next(s))}))})}function qR(n,e){return n===e}function $c(n=zR){return oe((e,t)=>{let r=!1;e.subscribe(se(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function zR(){return new kn}function aa(n){return oe((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function un(n,e){let t=arguments.length>=2;return r=>r.pipe(n?Bt((i,o)=>n(i,o,r)):vt,On(1),t?cr(e):$c(()=>new kn))}function ro(n){return n<=0?()=>_t:oe((e,t)=>{let r=[];e.subscribe(se(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function $f(n,e){let t=arguments.length>=2;return r=>r.pipe(n?Bt((i,o)=>n(i,o,r)):vt,ro(1),t?cr(e):$c(()=>new kn))}function GR(){return oe((n,e)=>{let t,r=!1;n.subscribe(se(e,i=>{let o=t;t=i,r&&e.next([o,i]),r=!0}))})}function Hf(n,e){return oe(RI(n,e,arguments.length>=2,!0))}function xI(n={}){let{connector:e=()=>new Ye,resetOnError:t=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=n;return o=>{let s,a,u,l=0,h=!1,p=!1,m=()=>{a?.unsubscribe(),a=void 0},y=()=>{m(),s=u=void 0,h=p=!1},D=()=>{let R=s;y(),R?.unsubscribe()};return oe((R,S)=>{l++,!p&&!h&&m();let O=u=u??e();S.add(()=>{l--,l===0&&!p&&!h&&(a=qf(D,i))}),O.subscribe(S),!s&&l>0&&(s=new Pn({next:U=>O.next(U),error:U=>{p=!0,m(),a=qf(y,t,U),O.error(U)},complete:()=>{h=!0,m(),a=qf(y,r),O.complete()}}),Se(R).subscribe(s))})(o)}}function qf(n,e,...t){if(e===!0){n();return}if(e===!1)return;let r=new Pn({next:()=>{r.unsubscribe(),n()}});return Se(e(...t)).subscribe(r)}function WR(n,e,t){let r,i=!1;return n&&typeof n=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:t}=n:r=n??1/0,xI({connector:()=>new Dc(r,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function zf(...n){let e=an(n);return oe((t,r)=>{(e?no(n,t,e):no(n,t)).subscribe(r)})}function wt(n,e){return oe((t,r)=>{let i=null,o=0,s=!1,a=()=>s&&!i&&r.complete();t.subscribe(se(r,u=>{i?.unsubscribe();let l=0,h=o++;Se(n(u,h)).subscribe(i=se(r,p=>r.next(e?e(u,p,h,l++):p),()=>{i=null,a()}))},()=>{s=!0,a()}))})}function KR(n,e){return X(e)?wt(()=>n,e):wt(()=>n)}function Gf(n){return oe((e,t)=>{Se(n).subscribe(se(t,()=>t.complete(),ra)),!t.closed&&e.subscribe(t)})}function Je(n,e,t){let r=X(n)||e||t?{next:n,error:e,complete:t}:n;return r?oe((i,o)=>{var s;(s=r.subscribe)===null||s===void 0||s.call(r);let a=!0;i.subscribe(se(o,u=>{var l;(l=r.next)===null||l===void 0||l.call(r,u),o.next(u)},()=>{var u;a=!1,(u=r.complete)===null||u===void 0||u.call(r),o.complete()},u=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,u),o.error(u)},()=>{var u,l;a&&((u=r.unsubscribe)===null||u===void 0||u.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):vt}var pE="https://g.co/ng/security#xss",Q=class extends Error{constructor(e,t){super(Yp(e,t)),this.code=e}};function Yp(n,e){return`${`NG0${Math.abs(n)}`}${e?": "+e:""}`}function ma(n){return{toString:n}.toString()}var Hc="__parameters__";function QR(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function gE(n,e,t){return ma(()=>{let r=QR(e);function i(...o){if(this instanceof i)return r.apply(this,o),this;let s=new i(...o);return a.annotation=s,a;function a(u,l,h){let p=u.hasOwnProperty(Hc)?u[Hc]:Object.defineProperty(u,Hc,{value:[]})[Hc];for(;p.length<=h;)p.push(null);return(p[h]=p[h]||[]).push(s),u}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}function Te(n){for(let e in n)if(n[e]===Te)return e;throw Error("Could not find renamed property on target object.")}function YR(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function Dt(n){if(typeof n=="string")return n;if(Array.isArray(n))return"["+n.map(Dt).join(", ")+"]";if(n==null)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;let e=n.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function MI(n,e){return n==null||n===""?e===null?"":e:e==null||e===""?n:n+" "+e}var ZR=Te({__forward_ref__:Te});function mE(n){return n.__forward_ref__=mE,n.toString=function(){return Dt(this())},n}function It(n){return yE(n)?n():n}function yE(n){return typeof n=="function"&&n.hasOwnProperty(ZR)&&n.__forward_ref__===mE}function K(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function ya(n){return{providers:n.providers||[],imports:n.imports||[]}}function Dl(n){return NI(n,_E)||NI(n,wE)}function vE(n){return Dl(n)!==null}function NI(n,e){return n.hasOwnProperty(e)?n[e]:null}function JR(n){let e=n&&(n[_E]||n[wE]);return e||null}function PI(n){return n&&(n.hasOwnProperty(kI)||n.hasOwnProperty(XR))?n[kI]:null}var _E=Te({\u0275prov:Te}),kI=Te({\u0275inj:Te}),wE=Te({ngInjectableDef:Te}),XR=Te({ngInjectorDef:Te}),Y=class{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=K({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function IE(n){return n&&!!n.\u0275providers}var ex=Te({\u0275cmp:Te}),tx=Te({\u0275dir:Te}),nx=Te({\u0275pipe:Te}),rx=Te({\u0275mod:Te}),Jc=Te({\u0275fac:Te}),ca=Te({__NG_ELEMENT_ID__:Te}),OI=Te({__NG_ENV_ID__:Te});function Tl(n){return typeof n=="string"?n:n==null?"":String(n)}function ix(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():Tl(n)}function ox(n,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new Q(-200,n)}function Zp(n,e){throw new Q(-201,!1)}var ae=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(ae||{}),sp;function EE(){return sp}function Rt(n){let e=sp;return sp=n,e}function DE(n,e,t){let r=Dl(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&ae.Optional)return null;if(e!==void 0)return e;Zp(n,"Injector")}var sx={},la=sx,ap="__NG_DI_FLAG__",Xc="ngTempTokenPath",ax="ngTokenPath",ux=/\n/gm,cx="\u0275",FI="__source",uo;function lx(){return uo}function lr(n){let e=uo;return uo=n,e}function dx(n,e=ae.Default){if(uo===void 0)throw new Q(-203,!1);return uo===null?DE(n,void 0,e):uo.get(n,e&ae.Optional?null:void 0,e)}function Z(n,e=ae.Default){return(EE()||dx)(It(n),e)}function L(n,e=ae.Default){return Z(n,Cl(e))}function Cl(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function up(n){let e=[];for(let t=0;t<n.length;t++){let r=It(n[t]);if(Array.isArray(r)){if(r.length===0)throw new Q(900,!1);let i,o=ae.Default;for(let s=0;s<r.length;s++){let a=r[s],u=hx(a);typeof u=="number"?u===-1?i=a.token:o|=u:i=a}e.push(Z(i,o))}else e.push(Z(r))}return e}function TE(n,e){return n[ap]=e,n.prototype[ap]=e,n}function hx(n){return n[ap]}function fx(n,e,t,r){let i=n[Xc];throw e[FI]&&i.unshift(e[FI]),n.message=px(`
`+n.message,i,t,r),n[ax]=i,n[Xc]=null,n}function px(n,e,t,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==cx?n.slice(2):n;let i=Dt(e);if(Array.isArray(e))i=e.map(Dt).join(" -> ");else if(typeof e=="object"){let o=[];for(let s in e)if(e.hasOwnProperty(s)){let a=e[s];o.push(s+":"+(typeof a=="string"?JSON.stringify(a):Dt(a)))}i=`{${o.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(ux,`
  `)}`}var ft=TE(gE("Optional"),8);var Jp=TE(gE("SkipSelf"),4);function ei(n,e){let t=n.hasOwnProperty(Jc);return t?n[Jc]:null}function Xp(n,e){n.forEach(t=>Array.isArray(t)?Xp(t,e):e(t))}function CE(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function el(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function gx(n,e,t,r){let i=n.length;if(i==e)n.push(t,r);else if(i===1)n.push(r,n[0]),n[0]=t;else{for(i--,n.push(n[i-1],n[i]);i>e;){let o=i-2;n[i]=n[o],i--}n[e]=t,n[e+1]=r}}function mx(n,e,t){let r=va(n,e);return r>=0?n[r|1]=t:(r=~r,gx(n,r,e,t)),r}function Wf(n,e){let t=va(n,e);if(t>=0)return n[t|1]}function va(n,e){return yx(n,e,1)}function yx(n,e,t){let r=0,i=n.length>>t;for(;i!==r;){let o=r+(i-r>>1),s=n[o<<t];if(e===s)return o<<t;s>e?i=o:r=o+1}return~(i<<t)}var lo={},$t=[],ho=new Y(""),bE=new Y("",-1),SE=new Y(""),tl=class{get(e,t=la){if(t===la){let r=new Error(`NullInjectorError: No provider for ${Dt(e)}!`);throw r.name="NullInjectorError",r}return t}},AE=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(AE||{}),dn=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(dn||{}),fr=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(fr||{});function vx(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let o=e.length;if(i+o===r||n.charCodeAt(i+o)<=32)return i}t=i+1}}function cp(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let o=t[r++],s=t[r++],a=t[r++];n.setAttribute(e,s,a,o)}else{let o=i,s=t[++r];wx(o)?n.setProperty(e,o,s):n.setAttribute(e,o,s),r++}}return r}function _x(n){return n===3||n===4||n===6}function wx(n){return n.charCodeAt(0)===64}function da(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?LI(n,t,i,null,e[++r]):LI(n,t,i,null,null))}}return n}function LI(n,e,t,r,i){let o=0,s=n.length;if(e===-1)s=-1;else for(;o<n.length;){let a=n[o++];if(typeof a=="number"){if(a===e){s=-1;break}else if(a>e){s=o-1;break}}}for(;o<n.length;){let a=n[o];if(typeof a=="number")break;if(a===t){if(r===null){i!==null&&(n[o+1]=i);return}else if(r===n[o+1]){n[o+2]=i;return}}o++,r!==null&&o++,i!==null&&o++}s!==-1&&(n.splice(s,0,e),o=s+1),n.splice(o++,0,t),r!==null&&n.splice(o++,0,r),i!==null&&n.splice(o++,0,i)}var RE="ng-template";function Ix(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&vx(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(eg(n))return!1;if(i=e.indexOf(1,i),i>-1){let o;for(;++i<e.length&&typeof(o=e[i])=="string";)if(o.toLowerCase()===t)return!0}return!1}function eg(n){return n.type===4&&n.value!==RE}function Ex(n,e,t){let r=n.type===4&&!t?RE:n.value;return e===r}function Dx(n,e,t){let r=4,i=n.attrs,o=i!==null?bx(i):0,s=!1;for(let a=0;a<e.length;a++){let u=e[a];if(typeof u=="number"){if(!s&&!Zt(r)&&!Zt(u))return!1;if(s&&Zt(u))continue;s=!1,r=u|r&1;continue}if(!s)if(r&4){if(r=2|r&1,u!==""&&!Ex(n,u,t)||u===""&&e.length===1){if(Zt(r))return!1;s=!0}}else if(r&8){if(i===null||!Ix(n,i,u,t)){if(Zt(r))return!1;s=!0}}else{let l=e[++a],h=Tx(u,i,eg(n),t);if(h===-1){if(Zt(r))return!1;s=!0;continue}if(l!==""){let p;if(h>o?p="":p=i[h+1].toLowerCase(),r&2&&l!==p){if(Zt(r))return!1;s=!0}}}}return Zt(r)||s}function Zt(n){return(n&1)===0}function Tx(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let o=!1;for(;i<e.length;){let s=e[i];if(s===n)return i;if(s===3||s===6)o=!0;else if(s===1||s===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(s===4)break;if(s===0){i+=4;continue}}i+=o?1:2}return-1}else return Sx(e,n)}function Cx(n,e,t=!1){for(let r=0;r<e.length;r++)if(Dx(n,e[r],t))return!0;return!1}function bx(n){for(let e=0;e<n.length;e++){let t=n[e];if(_x(t))return e}return n.length}function Sx(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function VI(n,e){return n?":not("+e.trim()+")":e}function Ax(n){let e=n[0],t=1,r=2,i="",o=!1;for(;t<n.length;){let s=n[t];if(typeof s=="string")if(r&2){let a=n[++t];i+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+s:r&4&&(i+=" "+s);else i!==""&&!Zt(s)&&(e+=VI(o,i),i=""),r=s,o=o||!Zt(r);t++}return i!==""&&(e+=VI(o,i)),e}function Rx(n){return n.map(Ax).join(",")}function xx(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let o=n[r];if(typeof o=="string")i===2?o!==""&&e.push(o,n[++r]):i===8&&t.push(o);else{if(!Zt(i))break;i=o}r++}return{attrs:e,classes:t}}function xE(n){return ma(()=>{let e=FE(n),t=De($({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===AE.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||dn.Emulated,styles:n.styles||$t,_:null,schemas:n.schemas||null,tView:null,id:""});LE(t);let r=n.dependencies;return t.directiveDefs=UI(r,!1),t.pipeDefs=UI(r,!0),t.id=Px(t),t})}function Mx(n){return pr(n)||NE(n)}function Nx(n){return n!==null}function _a(n){return ma(()=>({type:n.type,bootstrap:n.bootstrap||$t,declarations:n.declarations||$t,imports:n.imports||$t,exports:n.exports||$t,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function jI(n,e){if(n==null)return lo;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],o,s,a=fr.None;Array.isArray(i)?(a=i[0],o=i[1],s=i[2]??o):(o=i,s=i),e?(t[o]=a!==fr.None?[r,a]:r,e[o]=s):t[o]=r}return t}function Do(n){return ma(()=>{let e=FE(n);return LE(e),e})}function ME(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone===!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function pr(n){return n[ex]||null}function NE(n){return n[tx]||null}function PE(n){return n[nx]||null}function kE(n){let e=pr(n)||NE(n)||PE(n);return e!==null?e.standalone:!1}function OE(n,e){let t=n[rx]||null;if(!t&&e===!0)throw new Error(`Type ${Dt(n)} does not have '\u0275mod' property.`);return t}function FE(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||lo,exportAs:n.exportAs||null,standalone:n.standalone===!0,signals:n.signals===!0,selectors:n.selectors||$t,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:jI(n.inputs,e),outputs:jI(n.outputs),debugInfo:null}}function LE(n){n.features?.forEach(e=>e(n))}function UI(n,e){if(!n)return null;let t=e?PE:Mx;return()=>(typeof n=="function"?n():n).map(r=>t(r)).filter(Nx)}function Px(n){let e=0,t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(let i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function mn(n){return{\u0275providers:n}}function kx(...n){return{\u0275providers:VE(!0,n),\u0275fromNgModule:!0}}function VE(n,...e){let t=[],r=new Set,i,o=s=>{t.push(s)};return Xp(e,s=>{let a=s;lp(a,o,[],r)&&(i||=[],i.push(a))}),i!==void 0&&jE(i,o),t}function jE(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];tg(i,o=>{e(o,r)})}}function lp(n,e,t,r){if(n=It(n),!n)return!1;let i=null,o=PI(n),s=!o&&pr(n);if(!o&&!s){let u=n.ngModule;if(o=PI(u),o)i=u;else return!1}else{if(s&&!s.standalone)return!1;i=n}let a=r.has(i);if(s){if(a)return!1;if(r.add(i),s.dependencies){let u=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let l of u)lp(l,e,t,r)}}else if(o){if(o.imports!=null&&!a){r.add(i);let l;try{Xp(o.imports,h=>{lp(h,e,t,r)&&(l||=[],l.push(h))})}finally{}l!==void 0&&jE(l,e)}if(!a){let l=ei(i)||(()=>new i);e({provide:i,useFactory:l,deps:$t},i),e({provide:SE,useValue:i,multi:!0},i),e({provide:ho,useValue:()=>Z(i),multi:!0},i)}let u=o.providers;if(u!=null&&!a){let l=n;tg(u,h=>{e(h,l)})}}else return!1;return i!==n&&n.providers!==void 0}function tg(n,e){for(let t of n)IE(t)&&(t=t.\u0275providers),Array.isArray(t)?tg(t,e):e(t)}var Ox=Te({provide:String,useValue:Te});function UE(n){return n!==null&&typeof n=="object"&&Ox in n}function Fx(n){return!!(n&&n.useExisting)}function Lx(n){return!!(n&&n.useFactory)}function fo(n){return typeof n=="function"}function Vx(n){return!!n.useClass}var bl=new Y(""),Wc={},jx={},Kf;function ng(){return Kf===void 0&&(Kf=new tl),Kf}var Ft=class{},ha=class extends Ft{get destroyed(){return this._destroyed}constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,hp(e,s=>this.processProvider(s)),this.records.set(bE,io(void 0,this)),i.has("environment")&&this.records.set(Ft,io(void 0,this));let o=this.records.get(bl);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(SE,$t,ae.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=ge(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),ge(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let t=lr(this),r=Rt(void 0),i;try{return e()}finally{lr(t),Rt(r)}}get(e,t=la,r=ae.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(OI))return e[OI](this);r=Cl(r);let i,o=lr(this),s=Rt(void 0);try{if(!(r&ae.SkipSelf)){let u=this.records.get(e);if(u===void 0){let l=qx(e)&&Dl(e);l&&this.injectableDefInScope(l)?u=io(dp(e),Wc):u=null,this.records.set(e,u)}if(u!=null)return this.hydrate(e,u)}let a=r&ae.Self?ng():this.parent;return t=r&ae.Optional&&t===la?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[Xc]=a[Xc]||[]).unshift(Dt(e)),o)throw a;return fx(a,e,"R3InjectorError",this.source)}else throw a}finally{Rt(s),lr(o)}}resolveInjectorInitializers(){let e=ge(null),t=lr(this),r=Rt(void 0),i;try{let o=this.get(ho,$t,ae.Self);for(let s of o)s()}finally{lr(t),Rt(r),ge(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(Dt(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Q(205,!1)}processProvider(e){e=It(e);let t=fo(e)?e:It(e&&e.provide),r=Bx(e);if(!fo(e)&&e.multi===!0){let i=this.records.get(t);i||(i=io(void 0,Wc,!0),i.factory=()=>up(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){let r=ge(null);try{return t.value===Wc&&(t.value=jx,t.value=t.factory()),typeof t.value=="object"&&t.value&&Hx(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{ge(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=It(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function dp(n){let e=Dl(n),t=e!==null?e.factory:ei(n);if(t!==null)return t;if(n instanceof Y)throw new Q(204,!1);if(n instanceof Function)return Ux(n);throw new Q(204,!1)}function Ux(n){if(n.length>0)throw new Q(204,!1);let t=JR(n);return t!==null?()=>t.factory(n):()=>new n}function Bx(n){if(UE(n))return io(void 0,n.useValue);{let e=BE(n);return io(e,Wc)}}function BE(n,e,t){let r;if(fo(n)){let i=It(n);return ei(i)||dp(i)}else if(UE(n))r=()=>It(n.useValue);else if(Lx(n))r=()=>n.useFactory(...up(n.deps||[]));else if(Fx(n))r=()=>Z(It(n.useExisting));else{let i=It(n&&(n.useClass||n.provide));if($x(n))r=()=>new i(...up(n.deps));else return ei(i)||dp(i)}return r}function io(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function $x(n){return!!n.deps}function Hx(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function qx(n){return typeof n=="function"||typeof n=="object"&&n instanceof Y}function hp(n,e){for(let t of n)Array.isArray(t)?hp(t,e):t&&IE(t)?hp(t.\u0275providers,e):e(t)}function yn(n,e){n instanceof ha&&n.assertNotDestroyed();let t,r=lr(n),i=Rt(void 0);try{return e()}finally{lr(r),Rt(i)}}function $E(){return EE()!==void 0||lx()!=null}function zx(n){if(!$E())throw new Q(-203,!1)}function Gx(n){return typeof n=="function"}var Vn=0,ue=1,ee=2,Tt=3,Jt=4,en=5,nl=6,rl=7,Xt=8,po=9,hn=10,Xe=11,fa=12,BI=13,To=14,fn=15,go=16,oo=17,mo=18,Sl=19,HE=20,dr=21,Qf=22,Ht=23,pn=25,qE=1;var ti=7,il=8,ol=9,qt=10,sl=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n}(sl||{});function hr(n){return Array.isArray(n)&&typeof n[qE]=="object"}function jn(n){return Array.isArray(n)&&n[qE]===!0}function zE(n){return(n.flags&4)!==0}function Al(n){return n.componentOffset>-1}function rg(n){return(n.flags&1)===1}function gr(n){return!!n.template}function fp(n){return(n[ee]&512)!==0}var pp=class{constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function GE(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}function Rl(){return WE}function WE(n){return n.type.prototype.ngOnChanges&&(n.setInput=Kx),Wx}Rl.ngInherit=!0;function Wx(){let n=QE(this),e=n?.current;if(e){let t=n.previous;if(t===lo)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function Kx(n,e,t,r,i){let o=this.declaredInputs[r],s=QE(n)||Qx(n,{previous:lo,current:null}),a=s.current||(s.current={}),u=s.previous,l=u[o];a[o]=new pp(l&&l.currentValue,t,u===lo),GE(n,e,i,t)}var KE="__ngSimpleChanges__";function QE(n){return n[KE]||null}function Qx(n,e){return n[KE]=e}var $I=null;var cn=function(n,e,t){$I?.(n,e,t)},Yx="svg",Zx="math";function gn(n){for(;Array.isArray(n);)n=n[Vn];return n}function YE(n,e){return gn(e[n])}function zt(n,e){return gn(e[n.index])}function ZE(n,e){return n.data[e]}function Jx(n,e){return n[e]}function _r(n,e){let t=e[n];return hr(t)?t:t[Vn]}function ig(n){return(n[ee]&128)===128}function Xx(n){return jn(n[Tt])}function al(n,e){return e==null?null:n[e]}function JE(n){n[oo]=0}function XE(n){n[ee]&1024||(n[ee]|=1024,ig(n)&&Ml(n))}function eM(n,e){for(;n>0;)e=e[To],n--;return e}function xl(n){return!!(n[ee]&9216||n[Ht]?.dirty)}function gp(n){n[hn].changeDetectionScheduler?.notify(8),n[ee]&64&&(n[ee]|=1024),xl(n)&&Ml(n)}function Ml(n){n[hn].changeDetectionScheduler?.notify(0);let e=ni(n);for(;e!==null&&!(e[ee]&8192||(e[ee]|=8192,!ig(e)));)e=ni(e)}function eD(n,e){if((n[ee]&256)===256)throw new Q(911,!1);n[dr]===null&&(n[dr]=[]),n[dr].push(e)}function tM(n,e){if(n[dr]===null)return;let t=n[dr].indexOf(e);t!==-1&&n[dr].splice(t,1)}function ni(n){let e=n[Tt];return jn(e)?e[Tt]:e}var ce={lFrame:lD(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var tD=!1;function nM(){return ce.lFrame.elementDepthCount}function rM(){ce.lFrame.elementDepthCount++}function iM(){ce.lFrame.elementDepthCount--}function nD(){return ce.bindingsEnabled}function oM(){return ce.skipHydrationRootTNode!==null}function sM(n){return ce.skipHydrationRootTNode===n}function aM(){ce.skipHydrationRootTNode=null}function Ie(){return ce.lFrame.lView}function xt(){return ce.lFrame.tView}function M9(n){return ce.lFrame.contextLView=n,n[Xt]}function N9(n){return ce.lFrame.contextLView=null,n}function Mt(){let n=rD();for(;n!==null&&n.type===64;)n=n.parent;return n}function rD(){return ce.lFrame.currentTNode}function uM(){let n=ce.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function wa(n,e){let t=ce.lFrame;t.currentTNode=n,t.isParent=e}function iD(){return ce.lFrame.isParent}function cM(){ce.lFrame.isParent=!1}function oD(){return tD}function HI(n){tD=n}function sD(){let n=ce.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function lM(n){return ce.lFrame.bindingIndex=n}function Nl(){return ce.lFrame.bindingIndex++}function dM(n){let e=ce.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function hM(){return ce.lFrame.inI18n}function fM(n,e){let t=ce.lFrame;t.bindingIndex=t.bindingRootIndex=n,mp(e)}function pM(){return ce.lFrame.currentDirectiveIndex}function mp(n){ce.lFrame.currentDirectiveIndex=n}function gM(n){let e=ce.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function aD(n){ce.lFrame.currentQueryIndex=n}function mM(n){let e=n[ue];return e.type===2?e.declTNode:e.type===1?n[en]:null}function uD(n,e,t){if(t&ae.SkipSelf){let i=e,o=n;for(;i=i.parent,i===null&&!(t&ae.Host);)if(i=mM(o),i===null||(o=o[To],i.type&10))break;if(i===null)return!1;e=i,n=o}let r=ce.lFrame=cD();return r.currentTNode=e,r.lView=n,!0}function og(n){let e=cD(),t=n[ue];ce.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function cD(){let n=ce.lFrame,e=n===null?null:n.child;return e===null?lD(n):e}function lD(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function dD(){let n=ce.lFrame;return ce.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var hD=dD;function sg(){let n=dD();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function yM(n){return(ce.lFrame.contextLView=eM(n,ce.lFrame.contextLView))[Xt]}function Co(){return ce.lFrame.selectedIndex}function ri(n){ce.lFrame.selectedIndex=n}function ag(){let n=ce.lFrame;return ZE(n.tView,n.selectedIndex)}function vM(){return ce.lFrame.currentNamespace}var fD=!0;function ug(){return fD}function cg(n){fD=n}function _M(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=e.type.prototype;if(r){let s=WE(e);(t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s)}i&&(t.preOrderHooks??=[]).push(0-n,i),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}function lg(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let o=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:u,ngAfterViewChecked:l,ngOnDestroy:h}=o;s&&(n.contentHooks??=[]).push(-t,s),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),u&&(n.viewHooks??=[]).push(-t,u),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),h!=null&&(n.destroyHooks??=[]).push(t,h)}}function Kc(n,e,t){pD(n,e,3,t)}function Qc(n,e,t,r){(n[ee]&3)===t&&pD(n,e,t,r)}function Yf(n,e){let t=n[ee];(t&3)===e&&(t&=16383,t+=1,n[ee]=t)}function pD(n,e,t,r){let i=r!==void 0?n[oo]&65535:0,o=r??-1,s=e.length-1,a=0;for(let u=i;u<s;u++)if(typeof e[u+1]=="number"){if(a=e[u],r!=null&&a>=r)break}else e[u]<0&&(n[oo]+=65536),(a<o||o==-1)&&(wM(n,t,e,u),n[oo]=(n[oo]&4294901760)+u+2),u++}function qI(n,e){cn(4,n,e);let t=ge(null);try{e.call(n)}finally{ge(t),cn(5,n,e)}}function wM(n,e,t,r){let i=t[r]<0,o=t[r+1],s=i?-t[r]:t[r],a=n[s];i?n[ee]>>14<n[oo]>>16&&(n[ee]&3)===e&&(n[ee]+=16384,qI(a,o)):qI(a,o)}var co=-1,ii=class{constructor(e,t,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}};function IM(n){return n instanceof ii}function EM(n){return(n.flags&8)!==0}function DM(n){return(n.flags&16)!==0}var Zf={},yp=class{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=Cl(r);let i=this.injector.get(e,Zf,r);return i!==Zf||t===Zf?i:this.parentInjector.get(e,t,r)}};function gD(n){return n!==co}function ul(n){return n&32767}function TM(n){return n>>16}function cl(n,e){let t=TM(n),r=e;for(;t>0;)r=r[To],t--;return r}var vp=!0;function ll(n){let e=vp;return vp=n,e}var CM=256,mD=CM-1,yD=5,bM=0,ln={};function SM(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(ca)&&(r=t[ca]),r==null&&(r=t[ca]=bM++);let i=r&mD,o=1<<i;e.data[n+(i>>yD)]|=o}function dl(n,e){let t=vD(n,e);if(t!==-1)return t;let r=e[ue];r.firstCreatePass&&(n.injectorIndex=e.length,Jf(r.data,n),Jf(e,null),Jf(r.blueprint,null));let i=dg(n,e),o=n.injectorIndex;if(gD(i)){let s=ul(i),a=cl(i,e),u=a[ue].data;for(let l=0;l<8;l++)e[o+l]=a[s+l]|u[s+l]}return e[o+8]=i,o}function Jf(n,e){n.push(0,0,0,0,0,0,0,0,e)}function vD(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function dg(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=DD(i),r===null)return co;if(t++,i=i[To],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return co}function _p(n,e,t){SM(n,e,t)}function _D(n,e,t){if(t&ae.Optional||n!==void 0)return n;Zp(e,"NodeInjector")}function wD(n,e,t,r){if(t&ae.Optional&&r===void 0&&(r=null),!(t&(ae.Self|ae.Host))){let i=n[po],o=Rt(void 0);try{return i?i.get(e,r,t&ae.Optional):DE(e,r,t&ae.Optional)}finally{Rt(o)}}return _D(r,e,t)}function ID(n,e,t,r=ae.Default,i){if(n!==null){if(e[ee]&2048&&!(r&ae.Self)){let s=NM(n,e,t,r,ln);if(s!==ln)return s}let o=ED(n,e,t,r,ln);if(o!==ln)return o}return wD(e,t,r,i)}function ED(n,e,t,r,i){let o=xM(t);if(typeof o=="function"){if(!uD(e,n,r))return r&ae.Host?_D(i,t,r):wD(e,t,r,i);try{let s;if(s=o(r),s==null&&!(r&ae.Optional))Zp(t);else return s}finally{hD()}}else if(typeof o=="number"){let s=null,a=vD(n,e),u=co,l=r&ae.Host?e[fn][en]:null;for((a===-1||r&ae.SkipSelf)&&(u=a===-1?dg(n,e):e[a+8],u===co||!GI(r,!1)?a=-1:(s=e[ue],a=ul(u),e=cl(u,e)));a!==-1;){let h=e[ue];if(zI(o,a,h.data)){let p=AM(a,e,t,s,r,l);if(p!==ln)return p}u=e[a+8],u!==co&&GI(r,e[ue].data[a+8]===l)&&zI(o,a,e)?(s=h,a=ul(u),e=cl(u,e)):a=-1}}return i}function AM(n,e,t,r,i,o){let s=e[ue],a=s.data[n+8],u=r==null?Al(a)&&vp:r!=s&&(a.type&3)!==0,l=i&ae.Host&&o===a,h=RM(a,s,t,u,l);return h!==null?yo(e,s,h,a):ln}function RM(n,e,t,r,i){let o=n.providerIndexes,s=e.data,a=o&1048575,u=n.directiveStart,l=n.directiveEnd,h=o>>20,p=r?a:a+h,m=i?a+h:l;for(let y=p;y<m;y++){let D=s[y];if(y<u&&t===D||y>=u&&D.type===t)return y}if(i){let y=s[u];if(y&&gr(y)&&y.type===t)return u}return null}function yo(n,e,t,r){let i=n[t],o=e.data;if(IM(i)){let s=i;s.resolving&&ox(ix(o[t]));let a=ll(s.canSeeViewProviders);s.resolving=!0;let u,l=s.injectImpl?Rt(s.injectImpl):null,h=uD(n,r,ae.Default);try{i=n[t]=s.factory(void 0,o,n,r),e.firstCreatePass&&t>=r.directiveStart&&_M(t,o[t],e)}finally{l!==null&&Rt(l),ll(a),s.resolving=!1,hD()}}return i}function xM(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(ca)?n[ca]:void 0;return typeof e=="number"?e>=0?e&mD:MM:e}function zI(n,e,t){let r=1<<n;return!!(t[e+(n>>yD)]&r)}function GI(n,e){return!(n&ae.Self)&&!(n&ae.Host&&e)}var Xr=class{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return ID(this._tNode,this._lView,e,Cl(r),t)}};function MM(){return new Xr(Mt(),Ie())}function hg(n){return ma(()=>{let e=n.prototype.constructor,t=e[Jc]||wp(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let o=i[Jc]||wp(i);if(o&&o!==t)return o;i=Object.getPrototypeOf(i)}return o=>new o})}function wp(n){return yE(n)?()=>{let e=wp(It(n));return e&&e()}:ei(n)}function NM(n,e,t,r,i){let o=n,s=e;for(;o!==null&&s!==null&&s[ee]&2048&&!(s[ee]&512);){let a=ED(o,s,t,r|ae.Self,ln);if(a!==ln)return a;let u=o.parent;if(!u){let l=s[HE];if(l){let h=l.get(t,ln,r);if(h!==ln)return h}u=DD(s),s=s[To]}o=u}return i}function DD(n){let e=n[ue],t=e.type;return t===2?e.declTNode:t===1?n[en]:null}function WI(n,e=null,t=null,r){let i=TD(n,e,t,r);return i.resolveInjectorInitializers(),i}function TD(n,e=null,t=null,r,i=new Set){let o=[t||$t,kx(n)];return r=r||(typeof n=="object"?void 0:Dt(n)),new ha(o,e||ng(),r||null,i)}var ht=class n{static{this.THROW_IF_NOT_FOUND=la}static{this.NULL=new tl}static create(e,t){if(Array.isArray(e))return WI({name:""},t,e,"");{let r=e.name??"";return WI({name:r},e.parent,e.providers,r)}}static{this.\u0275prov=K({token:n,providedIn:"any",factory:()=>Z(bE)})}static{this.__NG_ELEMENT_ID__=-1}};var PM=new Y("");PM.__NG_ELEMENT_ID__=n=>{let e=Mt();if(e===null)throw new Q(204,!1);if(e.type&2)return e.value;if(n&ae.Optional)return null;throw new Q(204,!1)};var kM="ngOriginalError";function Xf(n){return n[kM]}var CD=!0,fg=(()=>{class n{static{this.__NG_ELEMENT_ID__=OM}static{this.__NG_ENV_ID__=t=>t}}return n})(),Ip=class extends fg{constructor(e){super(),this._lView=e}onDestroy(e){return eD(this._lView,e),()=>tM(this._lView,e)}};function OM(){return new Ip(Ie())}var bo=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Ze(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static{this.\u0275prov=K({token:n,providedIn:"root",factory:()=>new n})}}return n})();var Ep=class extends Ye{constructor(e=!1){super(),this.destroyRef=void 0,this.pendingTasks=void 0,this.__isAsync=e,$E()&&(this.destroyRef=L(fg,{optional:!0})??void 0,this.pendingTasks=L(bo,{optional:!0})??void 0)}emit(e){let t=ge(null);try{super.next(e)}finally{ge(t)}}subscribe(e,t,r){let i=e,o=t||(()=>null),s=r;if(e&&typeof e=="object"){let u=e;i=u.next?.bind(u),o=u.error?.bind(u),s=u.complete?.bind(u)}this.__isAsync&&(o=this.wrapInTimeout(o),i&&(i=this.wrapInTimeout(i)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:i,error:o,complete:s});return e instanceof ke&&e.add(a),a}wrapInTimeout(e){return t=>{let r=this.pendingTasks?.add();setTimeout(()=>{e(t),r!==void 0&&this.pendingTasks?.remove(r)})}}},Et=Ep;function hl(...n){}function bD(n){let e,t;function r(){n=hl;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),r()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),r()})),()=>r()}function KI(n){return queueMicrotask(()=>n()),()=>{n=hl}}var pg="isAngularZone",fl=pg+"_ID",FM=0,ve=class n{constructor(e){this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Et(!1),this.onMicrotaskEmpty=new Et(!1),this.onStable=new Et(!1),this.onError=new Et(!1);let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:o=CD}=e;if(typeof Zone>"u")throw new Q(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!i&&r,s.shouldCoalesceRunChangeDetection=i,s.callbackScheduled=!1,s.scheduleInRootZone=o,jM(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(pg)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new Q(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new Q(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+i,e,LM,hl,hl);try{return o.runTask(s,t,r)}finally{o.cancelTask(s)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},LM={};function gg(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function VM(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){bD(()=>{n.callbackScheduled=!1,Dp(n),n.isCheckStableRunning=!0,gg(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),Dp(n)}function jM(n){let e=()=>{VM(n)},t=FM++;n._inner=n._inner.fork({name:"angular",properties:{[pg]:!0,[fl]:t,[fl+t]:!0},onInvokeTask:(r,i,o,s,a,u)=>{if(UM(u))return r.invokeTask(o,s,a,u);try{return QI(n),r.invokeTask(o,s,a,u)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),YI(n)}},onInvoke:(r,i,o,s,a,u,l)=>{try{return QI(n),r.invoke(o,s,a,u,l)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!BM(u)&&e(),YI(n)}},onHasTask:(r,i,o,s)=>{r.hasTask(o,s),i===o&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,Dp(n),gg(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(r,i,o,s)=>(r.handleError(o,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function Dp(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function QI(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function YI(n){n._nesting--,gg(n)}var Tp=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Et,this.onMicrotaskEmpty=new Et,this.onStable=new Et,this.onError=new Et}run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function UM(n){return SD(n,"__ignore_ng_zone__")}function BM(n){return SD(n,"__scheduler_tick__")}function SD(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var Fn=class{constructor(){this._console=console}handleError(e){let t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&Xf(e);for(;t&&Xf(t);)t=Xf(t);return t||null}},$M=new Y("",{providedIn:"root",factory:()=>{let n=L(ve),e=L(Fn);return t=>n.runOutsideAngular(()=>e.handleError(t))}});function HM(){return Pl(Mt(),Ie())}function Pl(n,e){return new Ia(zt(n,e))}var Ia=(()=>{class n{constructor(t){this.nativeElement=t}static{this.__NG_ELEMENT_ID__=HM}}return n})();function AD(n){return(n.flags&128)===128}var RD=new Map,qM=0;function zM(){return qM++}function GM(n){RD.set(n[Sl],n)}function Cp(n){RD.delete(n[Sl])}var ZI="__ngContext__";function oi(n,e){hr(e)?(n[ZI]=e[Sl],GM(e)):n[ZI]=e}function xD(n){return ND(n[fa])}function MD(n){return ND(n[Jt])}function ND(n){for(;n!==null&&!jn(n);)n=n[Jt];return n}var bp;function PD(n){bp=n}function WM(){if(bp!==void 0)return bp;if(typeof document<"u")return document;throw new Q(210,!1)}var mg=new Y("",{providedIn:"root",factory:()=>KM}),KM="ng",yg=new Y(""),vn=new Y("",{providedIn:"platform",factory:()=>"unknown"});var vg=new Y("",{providedIn:"root",factory:()=>WM().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var QM="h",YM="b";var ZM=()=>null;function _g(n,e,t=!1){return ZM(n,e,t)}var kD=!1,JM=new Y("",{providedIn:"root",factory:()=>kD});var pl=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${pE})`}};function kl(n){return n instanceof pl?n.changingThisBreaksApplicationSecurity:n}function OD(n,e){let t=XM(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${pE})`)}return t===e}function XM(n){return n instanceof pl&&n.getTypeName()||null}var eN=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function FD(n){return n=String(n),n.match(eN)?n:"unsafe:"+n}var wg=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(wg||{});function P9(n){let e=tN();return e?e.sanitize(wg.URL,n)||"":OD(n,"URL")?kl(n):FD(Tl(n))}function tN(){let n=Ie();return n&&n[hn].sanitizer}function LD(n){return n instanceof Function?n():n}function nN(n){return(n??L(ht)).get(vn)==="browser"}var Ln=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Ln||{}),rN;function Ig(n,e){return rN(n,e)}function so(n,e,t,r,i){if(r!=null){let o,s=!1;jn(r)?o=r:hr(r)&&(s=!0,r=r[Vn]);let a=gn(r);n===0&&t!==null?i==null?$D(e,t,a):gl(e,t,a,i||null,!0):n===1&&t!==null?gl(e,t,a,i||null,!0):n===2?vN(e,a,s):n===3&&e.destroyNode(a),o!=null&&wN(e,n,o,t,i)}}function iN(n,e){return n.createText(e)}function oN(n,e,t){n.setValue(e,t)}function VD(n,e,t){return n.createElement(e,t)}function sN(n,e){jD(n,e),e[Vn]=null,e[en]=null}function aN(n,e,t,r,i,o){r[Vn]=i,r[en]=e,Ol(n,r,t,1,i,o)}function jD(n,e){e[hn].changeDetectionScheduler?.notify(9),Ol(n,e,e[Xe],2,null,null)}function uN(n){let e=n[fa];if(!e)return ep(n[ue],n);for(;e;){let t=null;if(hr(e))t=e[fa];else{let r=e[qt];r&&(t=r)}if(!t){for(;e&&!e[Jt]&&e!==n;)hr(e)&&ep(e[ue],e),e=e[Tt];e===null&&(e=n),hr(e)&&ep(e[ue],e),t=e&&e[Jt]}e=t}}function cN(n,e,t,r){let i=qt+r,o=t.length;r>0&&(t[i-1][Jt]=e),r<o-qt?(e[Jt]=t[i],CE(t,qt+r,e)):(t.push(e),e[Jt]=null),e[Tt]=t;let s=e[go];s!==null&&t!==s&&UD(s,e);let a=e[mo];a!==null&&a.insertView(n),gp(e),e[ee]|=128}function UD(n,e){let t=n[ol],r=e[Tt];if(hr(r))n[ee]|=sl.HasTransplantedViews;else{let i=r[Tt][fn];e[fn]!==i&&(n[ee]|=sl.HasTransplantedViews)}t===null?n[ol]=[e]:t.push(e)}function Eg(n,e){let t=n[ol],r=t.indexOf(e);t.splice(r,1)}function Sp(n,e){if(n.length<=qt)return;let t=qt+e,r=n[t];if(r){let i=r[go];i!==null&&i!==n&&Eg(i,r),e>0&&(n[t-1][Jt]=r[Jt]);let o=el(n,qt+e);sN(r[ue],r);let s=o[mo];s!==null&&s.detachView(o[ue]),r[Tt]=null,r[Jt]=null,r[ee]&=-129}return r}function BD(n,e){if(!(e[ee]&256)){let t=e[Xe];t.destroyNode&&Ol(n,e,t,3,null,null),uN(e)}}function ep(n,e){if(e[ee]&256)return;let t=ge(null);try{e[ee]&=-129,e[ee]|=256,e[Ht]&&bf(e[Ht]),dN(n,e),lN(n,e),e[ue].type===1&&e[Xe].destroy();let r=e[go];if(r!==null&&jn(e[Tt])){r!==e[Tt]&&Eg(r,e);let i=e[mo];i!==null&&i.detachView(n)}Cp(e)}finally{ge(t)}}function lN(n,e){let t=n.cleanup,r=e[rl];if(t!==null)for(let o=0;o<t.length-1;o+=2)if(typeof t[o]=="string"){let s=t[o+3];s>=0?r[s]():r[-s].unsubscribe(),o+=2}else{let s=r[t[o+1]];t[o].call(s)}r!==null&&(e[rl]=null);let i=e[dr];if(i!==null){e[dr]=null;for(let o=0;o<i.length;o++){let s=i[o];s()}}}function dN(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof ii)){let o=t[r+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let a=i[o[s]],u=o[s+1];cn(4,a,u);try{u.call(a)}finally{cn(5,a,u)}}else{cn(4,i,o);try{o.call(i)}finally{cn(5,i,o)}}}}}function hN(n,e,t){return fN(n,e.parent,t)}function fN(n,e,t){let r=e;for(;r!==null&&r.type&168;)e=r,r=e.parent;if(r===null)return t[Vn];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:o}=n.data[r.directiveStart+i];if(o===dn.None||o===dn.Emulated)return null}return zt(r,t)}}function gl(n,e,t,r,i){n.insertBefore(e,t,r,i)}function $D(n,e,t){n.appendChild(e,t)}function JI(n,e,t,r,i){r!==null?gl(n,e,t,r,i):$D(n,e,t)}function HD(n,e){return n.parentNode(e)}function pN(n,e){return n.nextSibling(e)}function gN(n,e,t){return yN(n,e,t)}function mN(n,e,t){return n.type&40?zt(n,t):null}var yN=mN,XI;function Dg(n,e,t,r){let i=hN(n,r,e),o=e[Xe],s=r.parent||e[en],a=gN(s,r,e);if(i!=null)if(Array.isArray(t))for(let u=0;u<t.length;u++)JI(o,i,t[u],a,!1);else JI(o,i,t,a,!1);XI!==void 0&&XI(o,r,e,t,i)}function ua(n,e){if(e!==null){let t=e.type;if(t&3)return zt(e,n);if(t&4)return Ap(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return ua(n,r);{let i=n[e.index];return jn(i)?Ap(-1,i):gn(i)}}else{if(t&128)return ua(n,e.next);if(t&32)return Ig(e,n)()||gn(n[e.index]);{let r=qD(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=ni(n[fn]);return ua(i,r)}else return ua(n,e.next)}}}return null}function qD(n,e){if(e!==null){let r=n[fn][en],i=e.projection;return r.projection[i]}return null}function Ap(n,e){let t=qt+n+1;if(t<e.length){let r=e[t],i=r[ue].firstChild;if(i!==null)return ua(r,i)}return e[ti]}function vN(n,e,t){n.removeChild(null,e,t)}function Tg(n,e,t,r,i,o,s){for(;t!=null;){if(t.type===128){t=t.next;continue}let a=r[t.index],u=t.type;if(s&&e===0&&(a&&oi(gn(a),r),t.flags|=2),(t.flags&32)!==32)if(u&8)Tg(n,e,t.child,r,i,o,!1),so(e,n,i,a,o);else if(u&32){let l=Ig(t,r),h;for(;h=l();)so(e,n,i,h,o);so(e,n,i,a,o)}else u&16?_N(n,e,r,t,i,o):so(e,n,i,a,o);t=s?t.projectionNext:t.next}}function Ol(n,e,t,r,i,o){Tg(t,r,n.firstChild,e,i,o,!1)}function _N(n,e,t,r,i,o){let s=t[fn],u=s[en].projection[r.projection];if(Array.isArray(u))for(let l=0;l<u.length;l++){let h=u[l];so(e,n,i,h,o)}else{let l=u,h=s[Tt];AD(r)&&(l.flags|=128),Tg(n,e,l,h,i,o,!0)}}function wN(n,e,t,r,i){let o=t[ti],s=gn(t);o!==s&&so(e,n,r,o,i);for(let a=qt;a<t.length;a++){let u=t[a];Ol(u[ue],u,n,e,r,o)}}function IN(n,e,t,r,i){if(e)i?n.addClass(t,r):n.removeClass(t,r);else{let o=r.indexOf("-")===-1?void 0:Ln.DashCase;i==null?n.removeStyle(t,r,o):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),o|=Ln.Important),n.setStyle(t,r,i,o))}}function EN(n,e,t){n.setAttribute(e,"style",t)}function zD(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function GD(n,e,t){let{mergedAttrs:r,classes:i,styles:o}=t;r!==null&&cp(n,e,r),i!==null&&zD(n,e,i),o!==null&&EN(n,e,o)}var ui={};function k9(n=1){WD(xt(),Ie(),Co()+n,!1)}function WD(n,e,t,r){if(!r)if((e[ee]&3)===3){let o=n.preOrderCheckHooks;o!==null&&Kc(e,o,t)}else{let o=n.preOrderHooks;o!==null&&Qc(e,o,0,t)}ri(t)}function Nt(n,e=ae.Default){let t=Ie();if(t===null)return Z(n,e);let r=Mt();return ID(r,t,It(n),e)}function KD(){let n="invalid";throw new Error(n)}function QD(n,e,t,r,i,o){let s=ge(null);try{let a=null;i&fr.SignalBased&&(a=e[r][Nn]),a!==null&&a.transformFn!==void 0&&(o=a.transformFn(o)),i&fr.HasDecoratorInputTransform&&(o=n.inputTransforms[r].call(e,o)),n.setInput!==null?n.setInput(e,a,o,t,r):GE(e,a,r,o)}finally{ge(s)}}function DN(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)ri(~i);else{let o=i,s=t[++r],a=t[++r];fM(s,o);let u=e[o];a(2,u)}}}finally{ri(-1)}}function Fl(n,e,t,r,i,o,s,a,u,l,h){let p=e.blueprint.slice();return p[Vn]=i,p[ee]=r|4|128|8|64,(l!==null||n&&n[ee]&2048)&&(p[ee]|=2048),JE(p),p[Tt]=p[To]=n,p[Xt]=t,p[hn]=s||n&&n[hn],p[Xe]=a||n&&n[Xe],p[po]=u||n&&n[po]||null,p[en]=o,p[Sl]=zM(),p[nl]=h,p[HE]=l,p[fn]=e.type==2?n[fn]:p,p}function Ll(n,e,t,r,i){let o=n.data[e];if(o===null)o=TN(n,e,t,r,i),hM()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=r,o.attrs=i;let s=uM();o.injectorIndex=s===null?-1:s.injectorIndex}return wa(o,!0),o}function TN(n,e,t,r,i){let o=rD(),s=iD(),a=s?o:o&&o.parent,u=n.data[e]=RN(n,a,t,e,r,i);return n.firstChild===null&&(n.firstChild=u),o!==null&&(s?o.child==null&&u.parent!==null&&(o.child=u):o.next===null&&(o.next=u,u.prev=o)),u}function YD(n,e,t,r){if(t===0)return-1;let i=e.length;for(let o=0;o<t;o++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function ZD(n,e,t,r,i){let o=Co(),s=r&2;try{ri(-1),s&&e.length>pn&&WD(n,e,pn,!1),cn(s?2:0,i),t(r,i)}finally{ri(o),cn(s?3:1,i)}}function JD(n,e,t){if(zE(e)){let r=ge(null);try{let i=e.directiveStart,o=e.directiveEnd;for(let s=i;s<o;s++){let a=n.data[s];if(a.contentQueries){let u=t[s];a.contentQueries(1,u,s)}}}finally{ge(r)}}}function XD(n,e,t){nD()&&(ON(n,e,t,zt(t,e)),(t.flags&64)===64&&oT(n,e,t))}function eT(n,e,t=zt){let r=e.localNames;if(r!==null){let i=e.index+1;for(let o=0;o<r.length;o+=2){let s=r[o+1],a=s===-1?t(e,n):n[s];n[i++]=a}}}function tT(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=Cg(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function Cg(n,e,t,r,i,o,s,a,u,l,h){let p=pn+r,m=p+i,y=CN(p,m),D=typeof l=="function"?l():l;return y[ue]={type:n,blueprint:y,template:t,queries:null,viewQuery:a,declTNode:e,data:y.slice().fill(null,p),bindingStartIndex:p,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:u,consts:D,incompleteFirstPass:!1,ssrId:h}}function CN(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:ui);return t}function bN(n,e,t,r){let o=r.get(JM,kD)||t===dn.ShadowDom,s=n.selectRootElement(e,o);return SN(s),s}function SN(n){AN(n)}var AN=()=>null;function RN(n,e,t,r,i,o){let s=e?e.injectorIndex:-1,a=0;return oM()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function eE(n,e,t,r,i){for(let o in e){if(!e.hasOwnProperty(o))continue;let s=e[o];if(s===void 0)continue;r??={};let a,u=fr.None;Array.isArray(s)?(a=s[0],u=s[1]):a=s;let l=o;if(i!==null){if(!i.hasOwnProperty(o))continue;l=i[o]}n===0?tE(r,t,l,a,u):tE(r,t,l,a)}return r}function tE(n,e,t,r,i){let o;n.hasOwnProperty(t)?(o=n[t]).push(e,r):o=n[t]=[e,r],i!==void 0&&o.push(i)}function xN(n,e,t){let r=e.directiveStart,i=e.directiveEnd,o=n.data,s=e.attrs,a=[],u=null,l=null;for(let h=r;h<i;h++){let p=o[h],m=t?t.get(p):null,y=m?m.inputs:null,D=m?m.outputs:null;u=eE(0,p.inputs,h,u,y),l=eE(1,p.outputs,h,l,D);let R=u!==null&&s!==null&&!eg(e)?GN(u,h,s):null;a.push(R)}u!==null&&(u.hasOwnProperty("class")&&(e.flags|=8),u.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=u,e.outputs=l}function MN(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function nT(n,e,t,r,i,o,s,a){let u=zt(e,t),l=e.inputs,h;!a&&l!=null&&(h=l[r])?(bg(n,t,h,r,i),Al(e)&&NN(t,e.index)):e.type&3?(r=MN(r),i=s!=null?s(i,e.value||"",r):i,o.setProperty(u,r,i)):e.type&12}function NN(n,e){let t=_r(e,n);t[ee]&16||(t[ee]|=64)}function rT(n,e,t,r){if(nD()){let i=r===null?null:{"":-1},o=LN(n,t),s,a;o===null?s=a=null:[s,a]=o,s!==null&&iT(n,e,t,s,i,a),i&&VN(t,r,i)}t.mergedAttrs=da(t.mergedAttrs,t.attrs)}function iT(n,e,t,r,i,o){for(let l=0;l<r.length;l++)_p(dl(t,e),n,r[l].type);UN(t,n.data.length,r.length);for(let l=0;l<r.length;l++){let h=r[l];h.providersResolver&&h.providersResolver(h)}let s=!1,a=!1,u=YD(n,e,r.length,null);for(let l=0;l<r.length;l++){let h=r[l];t.mergedAttrs=da(t.mergedAttrs,h.hostAttrs),BN(n,t,e,u,h),jN(u,h,i),h.contentQueries!==null&&(t.flags|=4),(h.hostBindings!==null||h.hostAttrs!==null||h.hostVars!==0)&&(t.flags|=64);let p=h.type.prototype;!s&&(p.ngOnChanges||p.ngOnInit||p.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),s=!0),!a&&(p.ngOnChanges||p.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),u++}xN(n,t,o)}function PN(n,e,t,r,i){let o=i.hostBindings;if(o){let s=n.hostBindingOpCodes;s===null&&(s=n.hostBindingOpCodes=[]);let a=~e.index;kN(s)!=a&&s.push(a),s.push(t,r,o)}}function kN(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function ON(n,e,t,r){let i=t.directiveStart,o=t.directiveEnd;Al(t)&&$N(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||dl(t,e),oi(r,e);let s=t.initialInputs;for(let a=i;a<o;a++){let u=n.data[a],l=yo(e,n,a,t);if(oi(l,e),s!==null&&zN(e,a-i,l,u,t,s),gr(u)){let h=_r(t.index,e);h[Xt]=yo(e,n,a,t)}}}function oT(n,e,t){let r=t.directiveStart,i=t.directiveEnd,o=t.index,s=pM();try{ri(o);for(let a=r;a<i;a++){let u=n.data[a],l=e[a];mp(a),(u.hostBindings!==null||u.hostVars!==0||u.hostAttrs!==null)&&FN(u,l)}}finally{ri(-1),mp(s)}}function FN(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function LN(n,e){let t=n.directiveRegistry,r=null,i=null;if(t)for(let o=0;o<t.length;o++){let s=t[o];if(Cx(e,s.selectors,!1))if(r||(r=[]),gr(s))if(s.findHostDirectiveDefs!==null){let a=[];i=i||new Map,s.findHostDirectiveDefs(s,a,i),r.unshift(...a,s);let u=a.length;Rp(n,e,u)}else r.unshift(s),Rp(n,e,0);else i=i||new Map,s.findHostDirectiveDefs?.(s,r,i),r.push(s)}return r===null?null:[r,i]}function Rp(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function VN(n,e,t){if(e){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let o=t[e[i+1]];if(o==null)throw new Q(-301,!1);r.push(e[i],o)}}}function jN(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;gr(e)&&(t[""]=n)}}function UN(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function BN(n,e,t,r,i){n.data[r]=i;let o=i.factory||(i.factory=ei(i.type,!0)),s=new ii(o,gr(i),Nt);n.blueprint[r]=s,t[r]=s,PN(n,e,r,YD(n,t,i.hostVars,ui),i)}function $N(n,e,t){let r=zt(e,n),i=tT(t),o=n[hn].rendererFactory,s=16;t.signals?s=4096:t.onPush&&(s=64);let a=Vl(n,Fl(n,i,null,s,r,e,null,o.createRenderer(r,t),null,null,null));n[e.index]=a}function HN(n,e,t,r,i,o){let s=zt(n,e);qN(e[Xe],s,o,n.value,t,r,i)}function qN(n,e,t,r,i,o,s){if(o==null)n.removeAttribute(e,i,t);else{let a=s==null?Tl(o):s(o,r||"",i);n.setAttribute(e,i,a,t)}}function zN(n,e,t,r,i,o){let s=o[e];if(s!==null)for(let a=0;a<s.length;){let u=s[a++],l=s[a++],h=s[a++],p=s[a++];QD(r,t,u,l,h,p)}}function GN(n,e,t){let r=null,i=0;for(;i<t.length;){let o=t[i];if(o===0){i+=4;continue}else if(o===5){i+=2;continue}if(typeof o=="number")break;if(n.hasOwnProperty(o)){r===null&&(r=[]);let s=n[o];for(let a=0;a<s.length;a+=3)if(s[a]===e){r.push(o,s[a+1],s[a+2],t[i+1]);break}}i+=2}return r}function sT(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function aT(n,e){let t=n.contentQueries;if(t!==null){let r=ge(null);try{for(let i=0;i<t.length;i+=2){let o=t[i],s=t[i+1];if(s!==-1){let a=n.data[s];aD(o),a.contentQueries(2,e[s],s)}}}finally{ge(r)}}}function Vl(n,e){return n[fa]?n[BI][Jt]=e:n[fa]=e,n[BI]=e,e}function xp(n,e,t){aD(0);let r=ge(null);try{e(n,t)}finally{ge(r)}}function WN(n){return n[rl]??=[]}function KN(n){return n.cleanup??=[]}function uT(n,e){let t=n[po],r=t?t.get(Fn,null):null;r&&r.handleError(e)}function bg(n,e,t,r,i){for(let o=0;o<t.length;){let s=t[o++],a=t[o++],u=t[o++],l=e[s],h=n.data[s];QD(h,l,r,a,u,i)}}function QN(n,e,t){let r=YE(e,n);oN(n[Xe],r,t)}function YN(n,e){let t=_r(e,n),r=t[ue];ZN(r,t);let i=t[Vn];i!==null&&t[nl]===null&&(t[nl]=_g(i,t[po])),Sg(r,t,t[Xt])}function ZN(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function Sg(n,e,t){og(e);try{let r=n.viewQuery;r!==null&&xp(1,r,t);let i=n.template;i!==null&&ZD(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[mo]?.finishViewCreation(n),n.staticContentQueries&&aT(n,e),n.staticViewQueries&&xp(2,n.viewQuery,t);let o=n.components;o!==null&&JN(e,o)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[ee]&=-5,sg()}}function JN(n,e){for(let t=0;t<e.length;t++)YN(n,e[t])}function XN(n,e,t,r){let i=ge(null);try{let o=e.tView,a=n[ee]&4096?4096:16,u=Fl(n,o,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),l=n[e.index];u[go]=l;let h=n[mo];return h!==null&&(u[mo]=h.createEmbeddedView(o)),Sg(o,u,t),u}finally{ge(i)}}function nE(n,e){return!e||e.firstChild===null||AD(n)}function eP(n,e,t,r=!0){let i=e[ue];if(cN(i,e,n,t),r){let s=Ap(t,n),a=e[Xe],u=HD(a,n[ti]);u!==null&&aN(i,n[en],a,e,u,s)}let o=e[nl];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function ml(n,e,t,r,i=!1){for(;t!==null;){if(t.type===128){t=i?t.projectionNext:t.next;continue}let o=e[t.index];o!==null&&r.push(gn(o)),jn(o)&&tP(o,r);let s=t.type;if(s&8)ml(n,e,t.child,r);else if(s&32){let a=Ig(t,e),u;for(;u=a();)r.push(u)}else if(s&16){let a=qD(e,t);if(Array.isArray(a))r.push(...a);else{let u=ni(e[fn]);ml(u[ue],u,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function tP(n,e){for(let t=qt;t<n.length;t++){let r=n[t],i=r[ue].firstChild;i!==null&&ml(r[ue],r,i,e)}n[ti]!==n[Vn]&&e.push(n[ti])}var cT=[];function nP(n){return n[Ht]??rP(n)}function rP(n){let e=cT.pop()??Object.create(oP);return e.lView=n,e}function iP(n){n.lView[Ht]!==n&&(n.lView=null,cT.push(n))}var oP=De($({},na),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{Ml(n.lView)},consumerOnSignalRead(){this.lView[Ht]=this}});function sP(n){let e=n[Ht]??Object.create(aP);return e.lView=n,e}var aP=De($({},na),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{let e=ni(n.lView);for(;e&&!lT(e[ue]);)e=ni(e);e&&XE(e)},consumerOnSignalRead(){this.lView[Ht]=this}});function lT(n){return n.type!==2}var uP=100;function dT(n,e=!0,t=0){let r=n[hn],i=r.rendererFactory,o=!1;o||i.begin?.();try{cP(n,t)}catch(s){throw e&&uT(n,s),s}finally{o||(i.end?.(),r.inlineEffectRunner?.flush())}}function cP(n,e){let t=oD();try{HI(!0),Mp(n,e);let r=0;for(;xl(n);){if(r===uP)throw new Q(103,!1);r++,Mp(n,1)}}finally{HI(t)}}function lP(n,e,t,r){let i=e[ee];if((i&256)===256)return;let o=!1,s=!1;!o&&e[hn].inlineEffectRunner?.flush(),og(e);let a=!0,u=null,l=null;o||(lT(n)?(l=nP(e),u=gc(l)):Yw()===null?(a=!1,l=sP(e),u=gc(l)):e[Ht]&&(bf(e[Ht]),e[Ht]=null));try{JE(e),lM(n.bindingStartIndex),t!==null&&ZD(n,e,t,2,r);let h=(i&3)===3;if(!o)if(h){let y=n.preOrderCheckHooks;y!==null&&Kc(e,y,null)}else{let y=n.preOrderHooks;y!==null&&Qc(e,y,0,null),Yf(e,0)}if(s||dP(e),hT(e,0),n.contentQueries!==null&&aT(n,e),!o)if(h){let y=n.contentCheckHooks;y!==null&&Kc(e,y)}else{let y=n.contentHooks;y!==null&&Qc(e,y,1),Yf(e,1)}DN(n,e);let p=n.components;p!==null&&pT(e,p,0);let m=n.viewQuery;if(m!==null&&xp(2,m,r),!o)if(h){let y=n.viewCheckHooks;y!==null&&Kc(e,y)}else{let y=n.viewHooks;y!==null&&Qc(e,y,2),Yf(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[Qf]){for(let y of e[Qf])y();e[Qf]=null}o||(e[ee]&=-73)}catch(h){throw o||Ml(e),h}finally{l!==null&&(Tf(l,u),a&&iP(l)),sg()}}function hT(n,e){for(let t=xD(n);t!==null;t=MD(t))for(let r=qt;r<t.length;r++){let i=t[r];fT(i,e)}}function dP(n){for(let e=xD(n);e!==null;e=MD(e)){if(!(e[ee]&sl.HasTransplantedViews))continue;let t=e[ol];for(let r=0;r<t.length;r++){let i=t[r];XE(i)}}}function hP(n,e,t){let r=_r(e,n);fT(r,t)}function fT(n,e){ig(n)&&Mp(n,e)}function Mp(n,e){let r=n[ue],i=n[ee],o=n[Ht],s=!!(e===0&&i&16);if(s||=!!(i&64&&e===0),s||=!!(i&1024),s||=!!(o?.dirty&&Cf(o)),s||=!1,o&&(o.dirty=!1),n[ee]&=-9217,s)lP(r,n,r.template,n[Xt]);else if(i&8192){hT(n,1);let a=r.components;a!==null&&pT(n,a,1)}}function pT(n,e,t){for(let r=0;r<e.length;r++)hP(n,e[r],t)}function Ag(n,e){let t=oD()?64:1088;for(n[hn].changeDetectionScheduler?.notify(e);n;){n[ee]|=t;let r=ni(n);if(fp(n)&&!r)return n;n=r}return null}var si=class{get rootNodes(){let e=this._lView,t=e[ue];return ml(t,e,t.firstChild,[])}constructor(e,t,r=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Xt]}set context(e){this._lView[Xt]=e}get destroyed(){return(this._lView[ee]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Tt];if(jn(e)){let t=e[il],r=t?t.indexOf(this):-1;r>-1&&(Sp(e,r),el(t,r))}this._attachedToViewContainer=!1}BD(this._lView[ue],this._lView)}onDestroy(e){eD(this._lView,e)}markForCheck(){Ag(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[ee]&=-129}reattach(){gp(this._lView),this._lView[ee]|=128}detectChanges(){this._lView[ee]|=1024,dT(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Q(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=fp(this._lView),t=this._lView[go];t!==null&&!e&&Eg(t,this._lView),jD(this._lView[ue],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Q(902,!1);this._appRef=e;let t=fp(this._lView),r=this._lView[go];r!==null&&!t&&UD(r,this._lView),gp(this._lView)}},jl=(()=>{class n{static{this.__NG_ELEMENT_ID__=gP}}return n})(),fP=jl,pP=class extends fP{constructor(e,t,r){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,r){let i=XN(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:r});return new si(i)}};function gP(){return mP(Mt(),Ie())}function mP(n,e){return n.type&4?new pP(e,n,Pl(n,e)):null}var F9=new RegExp(`^(\\d+)*(${YM}|${QM})*(.*)`);var yP=()=>null;function rE(n,e){return yP(n,e)}var vo=class{},Ul=new Y("",{providedIn:"root",factory:()=>!1});var gT=new Y(""),mT=new Y(""),Np=class{},yl=class{};function vP(n){let e=Error(`No component factory found for ${Dt(n)}.`);return e[_P]=n,e}var _P="ngComponent";var Pp=class{resolveComponentFactory(e){throw vP(e)}},_o=class{static{this.NULL=new Pp}},wo=class{},Bl=(()=>{class n{constructor(){this.destroyNode=null}static{this.__NG_ELEMENT_ID__=()=>wP()}}return n})();function wP(){let n=Ie(),e=Mt(),t=_r(e.index,n);return(hr(t)?t:n)[Xe]}var IP=(()=>{class n{static{this.\u0275prov=K({token:n,providedIn:"root",factory:()=>null})}}return n})();function kp(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,o=0;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];if(typeof a=="number")o=a;else if(o==1)i=MI(i,a);else if(o==2){let u=a,l=e[++s];r=MI(r,u+": "+l+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}var vl=class extends _o{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=pr(e);return new Io(t,this.ngModule)}};function iE(n,e){let t=[];for(let r in n){if(!n.hasOwnProperty(r))continue;let i=n[r];if(i===void 0)continue;let o=Array.isArray(i),s=o?i[0]:i,a=o?i[1]:fr.None;e?t.push({propName:s,templateName:r,isSignal:(a&fr.SignalBased)!==0}):t.push({propName:s,templateName:r})}return t}function EP(n){let e=n.toLowerCase();return e==="svg"?Yx:e==="math"?Zx:null}var Io=class extends yl{get inputs(){let e=this.componentDef,t=e.inputTransforms,r=iE(e.inputs,!0);if(t!==null)for(let i of r)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return r}get outputs(){return iE(this.componentDef.outputs,!1)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=Rx(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,r,i){let o=ge(null);try{i=i||this.ngModule;let s=i instanceof Ft?i:i?.injector;s&&this.componentDef.getStandaloneInjector!==null&&(s=this.componentDef.getStandaloneInjector(s)||s);let a=s?new yp(e,s):e,u=a.get(wo,null);if(u===null)throw new Q(407,!1);let l=a.get(IP,null),h=a.get(vo,null),p={rendererFactory:u,sanitizer:l,inlineEffectRunner:null,changeDetectionScheduler:h},m=u.createRenderer(null,this.componentDef),y=this.componentDef.selectors[0][0]||"div",D=r?bN(m,r,this.componentDef.encapsulation,a):VD(m,y,EP(y)),R=512;this.componentDef.signals?R|=4096:this.componentDef.onPush||(R|=16);let S=null;D!==null&&(S=_g(D,a,!0));let O=Cg(0,null,null,1,0,null,null,null,null,null,null),U=Fl(null,O,null,R,null,null,p,m,a,null,S);og(U);let V,q,re=null;try{let G=this.componentDef,I,v=null;G.findHostDirectiveDefs?(I=[],v=new Map,G.findHostDirectiveDefs(G,I,v),I.push(G)):I=[G];let w=DP(U,D);re=TP(w,D,G,I,U,p,m),q=ZE(O,pn),D&&SP(m,G,D,r),t!==void 0&&AP(q,this.ngContentSelectors,t),V=bP(re,G,I,v,U,[RP]),Sg(O,U,null)}catch(G){throw re!==null&&Cp(re),Cp(U),G}finally{sg()}return new Op(this.componentType,V,Pl(q,U),U,q)}finally{ge(o)}}},Op=class extends Np{constructor(e,t,r,i,o){super(),this.location=r,this._rootLView=i,this._tNode=o,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new si(i,void 0,!1),this.componentType=e}setInput(e,t){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let o=this._rootLView;bg(o[ue],o,i,e,t),this.previousInputValues.set(e,t);let s=_r(this._tNode.index,o);Ag(s,1)}}get injector(){return new Xr(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function DP(n,e){let t=n[ue],r=pn;return n[r]=e,Ll(t,r,2,"#host",null)}function TP(n,e,t,r,i,o,s){let a=i[ue];CP(r,n,e,s);let u=null;e!==null&&(u=_g(e,i[po]));let l=o.rendererFactory.createRenderer(e,t),h=16;t.signals?h=4096:t.onPush&&(h=64);let p=Fl(i,tT(t),null,h,i[n.index],n,o,l,null,null,u);return a.firstCreatePass&&Rp(a,n,r.length-1),Vl(i,p),i[n.index]=p}function CP(n,e,t,r){for(let i of n)e.mergedAttrs=da(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(kp(e,e.mergedAttrs,!0),t!==null&&GD(r,t,e))}function bP(n,e,t,r,i,o){let s=Mt(),a=i[ue],u=zt(s,i);iT(a,i,s,t,null,r);for(let h=0;h<t.length;h++){let p=s.directiveStart+h,m=yo(i,a,p,s);oi(m,i)}oT(a,i,s),u&&oi(u,i);let l=yo(i,a,s.directiveStart+s.componentOffset,s);if(n[Xt]=i[Xt]=l,o!==null)for(let h of o)h(l,e);return JD(a,s,i),l}function SP(n,e,t,r){if(r)cp(n,t,["ng-version","18.2.9"]);else{let{attrs:i,classes:o}=xx(e.selectors[0]);i&&cp(n,t,i),o&&o.length>0&&zD(n,t,o.join(" "))}}function AP(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let o=t[i];r.push(o!=null?Array.from(o):null)}}function RP(){let n=Mt();lg(Ie()[ue],n)}var So=(()=>{class n{static{this.__NG_ELEMENT_ID__=xP}}return n})();function xP(){let n=Mt();return NP(n,Ie())}var MP=So,yT=class extends MP{constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return Pl(this._hostTNode,this._hostLView)}get injector(){return new Xr(this._hostTNode,this._hostLView)}get parentInjector(){let e=dg(this._hostTNode,this._hostLView);if(gD(e)){let t=cl(e,this._hostLView),r=ul(e),i=t[ue].data[r+8];return new Xr(i,t)}else return new Xr(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=oE(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-qt}createEmbeddedView(e,t,r){let i,o;typeof r=="number"?i=r:r!=null&&(i=r.index,o=r.injector);let s=rE(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},o,s);return this.insertImpl(a,i,nE(this._hostTNode,s)),a}createComponent(e,t,r,i,o){let s=e&&!Gx(e),a;if(s)a=t;else{let D=t||{};a=D.index,r=D.injector,i=D.projectableNodes,o=D.environmentInjector||D.ngModuleRef}let u=s?e:new Io(pr(e)),l=r||this.parentInjector;if(!o&&u.ngModule==null){let R=(s?l:this.parentInjector).get(Ft,null);R&&(o=R)}let h=pr(u.componentType??{}),p=rE(this._lContainer,h?.id??null),m=p?.firstChild??null,y=u.create(l,i,m,o);return this.insertImpl(y.hostView,a,nE(this._hostTNode,p)),y}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(Xx(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let u=i[Tt],l=new yT(u,u[en],u[Tt]);l.detach(l.indexOf(e))}}let o=this._adjustIndex(t),s=this._lContainer;return eP(s,i,o,r),e.attachToViewContainerRef(),CE(tp(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=oE(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=Sp(this._lContainer,t);r&&(el(tp(this._lContainer),t),BD(r[ue],r))}detach(e){let t=this._adjustIndex(e,-1),r=Sp(this._lContainer,t);return r&&el(tp(this._lContainer),t)!=null?new si(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function oE(n){return n[il]}function tp(n){return n[il]||(n[il]=[])}function NP(n,e){let t,r=e[n.index];return jn(r)?t=r:(t=sT(r,e,null,n),e[n.index]=t,Vl(e,t)),kP(t,e,n,r),new yT(t,n,e)}function PP(n,e){let t=n[Xe],r=t.createComment(""),i=zt(e,n),o=HD(t,i);return gl(t,o,r,pN(t,i),!1),r}var kP=LP,OP=()=>!1;function FP(n,e,t){return OP(n,e,t)}function LP(n,e,t,r){if(n[ti])return;let i;t.type&8?i=gn(r):i=PP(e,t),n[ti]=i}var sE=new Set;function Ao(n){sE.has(n)||(sE.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}function VP(n){return typeof n=="function"&&n[Nn]!==void 0}function V9(n,e){Ao("NgSignals");let t=aI(n),r=t[Nn];return e?.equal&&(r.equal=e.equal),t.set=i=>Sf(r,i),t.update=i=>uI(r,i),t.asReadonly=jP.bind(t),t}function jP(){let n=this[Nn];if(n.readonlyFn===void 0){let e=()=>this();e[Nn]=n,n.readonlyFn=e}return n.readonlyFn}function vT(n){return VP(n)&&typeof n.set=="function"}function UP(n){return Object.getPrototypeOf(n.prototype).constructor}function BP(n){let e=UP(n.type),t=!0,r=[n];for(;e;){let i;if(gr(n))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Q(903,!1);i=e.\u0275dir}if(i){if(t){r.push(i);let s=n;s.inputs=qc(n.inputs),s.inputTransforms=qc(n.inputTransforms),s.declaredInputs=qc(n.declaredInputs),s.outputs=qc(n.outputs);let a=i.hostBindings;a&&GP(n,a);let u=i.viewQuery,l=i.contentQueries;if(u&&qP(n,u),l&&zP(n,l),$P(n,i),YR(n.outputs,i.outputs),gr(i)&&i.data.animation){let h=n.data;h.animation=(h.animation||[]).concat(i.data.animation)}}let o=i.features;if(o)for(let s=0;s<o.length;s++){let a=o[s];a&&a.ngInherit&&a(n),a===BP&&(t=!1)}}e=Object.getPrototypeOf(e)}HP(r)}function $P(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let r=e.inputs[t];if(r!==void 0&&(n.inputs[t]=r,n.declaredInputs[t]=e.declaredInputs[t],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;n.inputTransforms??={},n.inputTransforms[i]=e.inputTransforms[i]}}}function HP(n){let e=0,t=null;for(let r=n.length-1;r>=0;r--){let i=n[r];i.hostVars=e+=i.hostVars,i.hostAttrs=da(i.hostAttrs,t=da(t,i.hostAttrs))}}function qc(n){return n===lo?{}:n===$t?[]:n}function qP(n,e){let t=n.viewQuery;t?n.viewQuery=(r,i)=>{e(r,i),t(r,i)}:n.viewQuery=e}function zP(n,e){let t=n.contentQueries;t?n.contentQueries=(r,i,o)=>{e(r,i,o),t(r,i,o)}:n.contentQueries=e}function GP(n,e){let t=n.hostBindings;t?n.hostBindings=(r,i)=>{e(r,i),t(r,i)}:n.hostBindings=e}var mr=class{},pa=class{};var Fp=class extends mr{constructor(e,t,r,i=!0){super(),this.ngModuleType=e,this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new vl(this);let o=OE(e);this._bootstrapComponents=LD(o.bootstrap),this._r3Injector=TD(e,t,[{provide:mr,useValue:this},{provide:_o,useValue:this.componentFactoryResolver},...r],Dt(e),new Set(["environment"])),i&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Lp=class extends pa{constructor(e){super(),this.moduleType=e}create(e){return new Fp(this.moduleType,e,[])}};var _l=class extends mr{constructor(e){super(),this.componentFactoryResolver=new vl(this),this.instance=null;let t=new ha([...e.providers,{provide:mr,useValue:this},{provide:_o,useValue:this.componentFactoryResolver}],e.parent||ng(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function $l(n,e,t=null){return new _l({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}function _T(n){return KP(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function WP(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),r;for(;!(r=t.next()).done;)e(r.value)}}function KP(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function wT(n,e,t){return n[e]=t}function yr(n,e,t){let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function QP(n,e,t,r){let i=yr(n,e,t);return yr(n,e+1,r)||i}function YP(n){return(n.flags&32)===32}function ZP(n,e,t,r,i,o,s,a,u){let l=e.consts,h=Ll(e,n,4,s||null,a||null);rT(e,t,h,al(l,u)),lg(e,h);let p=h.tView=Cg(2,h,r,i,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return e.queries!==null&&(e.queries.template(e,h),p.queries=e.queries.embeddedTView(h)),h}function JP(n,e,t,r,i,o,s,a,u,l){let h=t+pn,p=e.firstCreatePass?ZP(h,e,n,r,i,o,s,a,u):e.data[h];wa(p,!1);let m=e1(e,n,p,t);ug()&&Dg(e,n,m,p),oi(m,n);let y=sT(m,n,m,p);return n[h]=y,Vl(n,y),FP(y,p,n),rg(p)&&XD(e,n,p),u!=null&&eT(n,p,l),p}function XP(n,e,t,r,i,o,s,a){let u=Ie(),l=xt(),h=al(l.consts,o);return JP(u,l,n,e,t,r,i,h,s,a),XP}var e1=t1;function t1(n,e,t,r){return cg(!0),e[Xe].createComment("")}var ao=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(ao||{}),IT=(()=>{class n{constructor(){this.impl=null}execute(){this.impl?.execute()}static{this.\u0275prov=K({token:n,providedIn:"root",factory:()=>new n})}}return n})(),Vp=class n{constructor(){this.ngZone=L(ve),this.scheduler=L(vo),this.errorHandler=L(Fn,{optional:!0}),this.sequences=new Set,this.deferredRegistrations=new Set,this.executing=!1}static{this.PHASES=[ao.EarlyRead,ao.Write,ao.MixedReadWrite,ao.Read]}execute(){this.executing=!0;for(let e of n.PHASES)for(let t of this.sequences)if(!(t.erroredOrDestroyed||!t.hooks[e]))try{t.pipelinedValue=this.ngZone.runOutsideAngular(()=>t.hooks[e](t.pipelinedValue))}catch(r){t.erroredOrDestroyed=!0,this.errorHandler?.handleError(r)}this.executing=!1;for(let e of this.sequences)e.afterRun(),e.once&&(this.sequences.delete(e),e.destroy());for(let e of this.deferredRegistrations)this.sequences.add(e);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear()}register(e){this.executing?this.deferredRegistrations.add(e):(this.sequences.add(e),this.scheduler.notify(6))}unregister(e){this.executing&&this.sequences.has(e)?(e.erroredOrDestroyed=!0,e.pipelinedValue=void 0,e.once=!0):(this.sequences.delete(e),this.deferredRegistrations.delete(e))}static{this.\u0275prov=K({token:n,providedIn:"root",factory:()=>new n})}},jp=class{constructor(e,t,r,i){this.impl=e,this.hooks=t,this.once=r,this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.unregisterOnDestroy=i?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.()}};function Rg(n,e){!e?.injector&&zx(Rg);let t=e?.injector??L(ht);return nN(t)?(Ao("NgAfterNextRender"),r1(n,t,e,!0)):i1}function n1(n,e){if(n instanceof Function){let t=[void 0,void 0,void 0,void 0];return t[e]=n,t}else return[n.earlyRead,n.write,n.mixedReadWrite,n.read]}function r1(n,e,t,r){let i=e.get(IT);i.impl??=e.get(Vp);let o=t?.phase??ao.MixedReadWrite,s=t?.manualCleanup!==!0?e.get(fg):null,a=new jp(i.impl,n1(n,o),r,s);return i.impl.register(a),a}var i1={destroy(){}};function ET(n,e,t,r){let i=Ie(),o=Nl();if(yr(i,o,e)){let s=xt(),a=ag();HN(a,i,n,e,t,r)}return ET}function o1(n,e,t,r){return yr(n,Nl(),t)?e+Tl(t)+r:ui}function zc(n,e){return n<<17|e<<2}function ai(n){return n>>17&32767}function s1(n){return(n&2)==2}function a1(n,e){return n&131071|e<<17}function Up(n){return n|2}function Eo(n){return(n&131068)>>2}function np(n,e){return n&-131069|e<<2}function u1(n){return(n&1)===1}function Bp(n){return n|1}function c1(n,e,t,r,i,o){let s=o?e.classBindings:e.styleBindings,a=ai(s),u=Eo(s);n[r]=t;let l=!1,h;if(Array.isArray(t)){let p=t;h=p[1],(h===null||va(p,h)>0)&&(l=!0)}else h=t;if(i)if(u!==0){let m=ai(n[a+1]);n[r+1]=zc(m,a),m!==0&&(n[m+1]=np(n[m+1],r)),n[a+1]=a1(n[a+1],r)}else n[r+1]=zc(a,0),a!==0&&(n[a+1]=np(n[a+1],r)),a=r;else n[r+1]=zc(u,0),a===0?a=r:n[u+1]=np(n[u+1],r),u=r;l&&(n[r+1]=Up(n[r+1])),aE(n,h,r,!0),aE(n,h,r,!1),l1(e,h,n,r,o),s=zc(a,u),o?e.classBindings=s:e.styleBindings=s}function l1(n,e,t,r,i){let o=i?n.residualClasses:n.residualStyles;o!=null&&typeof e=="string"&&va(o,e)>=0&&(t[r+1]=Bp(t[r+1]))}function aE(n,e,t,r){let i=n[t+1],o=e===null,s=r?ai(i):Eo(i),a=!1;for(;s!==0&&(a===!1||o);){let u=n[s],l=n[s+1];d1(u,e)&&(a=!0,n[s+1]=r?Bp(l):Up(l)),s=r?ai(l):Eo(l)}a&&(n[t+1]=r?Up(i):Bp(i))}function d1(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?va(n,e)>=0:!1}function h1(n,e,t){let r=Ie(),i=Nl();if(yr(r,i,e)){let o=xt(),s=ag();nT(o,s,r,n,e,r[Xe],t,!1)}return h1}function uE(n,e,t,r,i){let o=e.inputs,s=i?"class":"style";bg(n,t,o[s],s,r)}function f1(n,e){return p1(n,e,null,!0),f1}function p1(n,e,t,r){let i=Ie(),o=xt(),s=dM(2);if(o.firstUpdatePass&&m1(o,n,s,r),e!==ui&&yr(i,s,e)){let a=o.data[Co()];I1(o,a,i,i[Xe],n,i[s+1]=E1(e,t),r,s)}}function g1(n,e){return e>=n.expandoStartIndex}function m1(n,e,t,r){let i=n.data;if(i[t+1]===null){let o=i[Co()],s=g1(n,t);D1(o,r)&&e===null&&!s&&(e=!1),e=y1(i,o,e,r),c1(i,o,e,t,s,r)}}function y1(n,e,t,r){let i=gM(n),o=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(t=rp(null,n,e,t,r),t=ga(t,e.attrs,r),o=null);else{let s=e.directiveStylingLast;if(s===-1||n[s]!==i)if(t=rp(i,n,e,t,r),o===null){let u=v1(n,e,r);u!==void 0&&Array.isArray(u)&&(u=rp(null,n,e,u[1],r),u=ga(u,e.attrs,r),_1(n,e,r,u))}else o=w1(n,e,r)}return o!==void 0&&(r?e.residualClasses=o:e.residualStyles=o),t}function v1(n,e,t){let r=t?e.classBindings:e.styleBindings;if(Eo(r)!==0)return n[ai(r)]}function _1(n,e,t,r){let i=t?e.classBindings:e.styleBindings;n[ai(i)]=r}function w1(n,e,t){let r,i=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<i;o++){let s=n[o].hostAttrs;r=ga(r,s,t)}return ga(r,e.attrs,t)}function rp(n,e,t,r,i){let o=null,s=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<s&&(o=e[a],r=ga(r,o.hostAttrs,i),o!==n);)a++;return n!==null&&(t.directiveStylingLast=a),r}function ga(n,e,t){let r=t?1:2,i=-1;if(e!==null)for(let o=0;o<e.length;o++){let s=e[o];typeof s=="number"?i=s:i===r&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),mx(n,s,t?!0:e[++o]))}return n===void 0?null:n}function I1(n,e,t,r,i,o,s,a){if(!(e.type&3))return;let u=n.data,l=u[a+1],h=u1(l)?cE(u,e,t,i,Eo(l),s):void 0;if(!wl(h)){wl(o)||s1(l)&&(o=cE(u,null,t,i,a,s));let p=YE(Co(),t);IN(r,s,p,i,o)}}function cE(n,e,t,r,i,o){let s=e===null,a;for(;i>0;){let u=n[i],l=Array.isArray(u),h=l?u[1]:u,p=h===null,m=t[i+1];m===ui&&(m=p?$t:void 0);let y=p?Wf(m,r):h===r?m:void 0;if(l&&!wl(y)&&(y=Wf(u,r)),wl(y)&&(a=y,s))return a;let D=n[i+1];i=s?ai(D):Eo(D)}if(e!==null){let u=o?e.residualClasses:e.residualStyles;u!=null&&(a=Wf(u,r))}return a}function wl(n){return n!==void 0}function E1(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=Dt(kl(n)))),n}function D1(n,e){return(n.flags&(e?8:16))!==0}function T1(n,e,t,r,i,o){let s=e.consts,a=al(s,i),u=Ll(e,n,2,r,a);return rT(e,t,u,al(s,o)),u.attrs!==null&&kp(u,u.attrs,!1),u.mergedAttrs!==null&&kp(u,u.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,u),u}function DT(n,e,t,r){let i=Ie(),o=xt(),s=pn+n,a=i[Xe],u=o.firstCreatePass?T1(s,o,i,e,t,r):o.data[s],l=C1(o,i,u,a,e,n);i[s]=l;let h=rg(u);return wa(u,!0),GD(a,l,u),!YP(u)&&ug()&&Dg(o,i,l,u),nM()===0&&oi(l,i),rM(),h&&(XD(o,i,u),JD(o,u,i)),r!==null&&eT(i,u),DT}function TT(){let n=Mt();iD()?cM():(n=n.parent,wa(n,!1));let e=n;sM(e)&&aM(),iM();let t=xt();return t.firstCreatePass&&(lg(t,n),zE(n)&&t.queries.elementEnd(n)),e.classesWithoutHost!=null&&EM(e)&&uE(t,e,Ie(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&DM(e)&&uE(t,e,Ie(),e.stylesWithoutHost,!1),TT}function xg(n,e,t,r){return DT(n,e,t,r),TT(),xg}var C1=(n,e,t,r,i,o)=>(cg(!0),VD(r,i,vM()));function j9(){return Ie()}var Il="en-US";var b1=Il;function S1(n){typeof n=="string"&&(b1=n.toLowerCase().replace(/_/g,"-"))}var A1=(n,e,t)=>{};function CT(n,e,t,r){let i=Ie(),o=xt(),s=Mt();return bT(o,i,i[Xe],s,n,e,r),CT}function R1(n,e,t,r){let i=n.cleanup;if(i!=null)for(let o=0;o<i.length-1;o+=2){let s=i[o];if(s===t&&i[o+1]===r){let a=e[rl],u=i[o+2];return a.length>u?a[u]:null}typeof s=="string"&&(o+=2)}return null}function bT(n,e,t,r,i,o,s){let a=rg(r),l=n.firstCreatePass&&KN(n),h=e[Xt],p=WN(e),m=!0;if(r.type&3||s){let R=zt(r,e),S=s?s(R):R,O=p.length,U=s?q=>s(gn(q[r.index])):r.index,V=null;if(!s&&a&&(V=R1(n,e,i,r.index)),V!==null){let q=V.__ngLastListenerFn__||V;q.__ngNextListenerFn__=o,V.__ngLastListenerFn__=o,m=!1}else{o=dE(r,e,h,o),A1(R,i,o);let q=t.listen(S,i,o);p.push(o,q),l&&l.push(i,U,O,O+1)}}else o=dE(r,e,h,o);let y=r.outputs,D;if(m&&y!==null&&(D=y[i])){let R=D.length;if(R)for(let S=0;S<R;S+=2){let O=D[S],U=D[S+1],re=e[O][U].subscribe(o),G=p.length;p.push(o,re),l&&l.push(i,r.index,G,-(G+1))}}}function lE(n,e,t,r){let i=ge(null);try{return cn(6,e,t),t(r)!==!1}catch(o){return uT(n,o),!1}finally{cn(7,e,t),ge(i)}}function dE(n,e,t,r){return function i(o){if(o===Function)return r;let s=n.componentOffset>-1?_r(n.index,e):e;Ag(s,5);let a=lE(e,t,r,o),u=i.__ngNextListenerFn__;for(;u;)a=lE(e,t,u,o)&&a,u=u.__ngNextListenerFn__;return a}}function U9(n=1){return yM(n)}function x1(n,e,t,r){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=r}function B9(n,e=""){let t=Ie(),r=xt(),i=n+pn,o=r.firstCreatePass?Ll(r,i,1,e,null):r.data[i],s=M1(r,t,o,e,n);t[i]=s,ug()&&Dg(r,t,s,o),wa(o,!1)}var M1=(n,e,t,r,i)=>(cg(!0),iN(e[Xe],r));function N1(n){return ST("",n,""),N1}function ST(n,e,t){let r=Ie(),i=o1(r,n,e,t);return i!==ui&&QN(r,Co(),i),ST}function P1(n,e,t){vT(e)&&(e=e());let r=Ie(),i=Nl();if(yr(r,i,e)){let o=xt(),s=ag();nT(o,s,r,n,e,r[Xe],t,!1)}return P1}function $9(n,e){let t=vT(n);return t&&n.set(e),t}function k1(n,e){let t=Ie(),r=xt(),i=Mt();return bT(r,t,t[Xe],i,n,e),k1}function O1(n,e,t){let r=xt();if(r.firstCreatePass){let i=gr(n);$p(t,r.data,r.blueprint,i,!0),$p(e,r.data,r.blueprint,i,!1)}}function $p(n,e,t,r,i){if(n=It(n),Array.isArray(n))for(let o=0;o<n.length;o++)$p(n[o],e,t,r,i);else{let o=xt(),s=Ie(),a=Mt(),u=fo(n)?n:It(n.provide),l=BE(n),h=a.providerIndexes&1048575,p=a.directiveStart,m=a.providerIndexes>>20;if(fo(n)||!n.multi){let y=new ii(l,i,Nt),D=op(u,e,i?h:h+m,p);D===-1?(_p(dl(a,s),o,u),ip(o,n,e.length),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(y),s.push(y)):(t[D]=y,s[D]=y)}else{let y=op(u,e,h+m,p),D=op(u,e,h,h+m),R=y>=0&&t[y],S=D>=0&&t[D];if(i&&!S||!i&&!R){_p(dl(a,s),o,u);let O=V1(i?L1:F1,t.length,i,r,l);!i&&S&&(t[D].providerFactory=O),ip(o,n,e.length,0),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(O),s.push(O)}else{let O=AT(t[i?D:y],l,!i&&r);ip(o,n,y>-1?y:D,O)}!i&&r&&S&&t[D].componentProviders++}}}function ip(n,e,t,r){let i=fo(e),o=Vx(e);if(i||o){let u=(o?It(e.useClass):e).prototype.ngOnDestroy;if(u){let l=n.destroyHooks||(n.destroyHooks=[]);if(!i&&e.multi){let h=l.indexOf(t);h===-1?l.push(t,[r,u]):l[h+1].push(r,u)}else l.push(t,u)}}}function AT(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function op(n,e,t,r){for(let i=t;i<r;i++)if(e[i]===n)return i;return-1}function F1(n,e,t,r){return Hp(this.multi,[])}function L1(n,e,t,r){let i=this.multi,o;if(this.providerFactory){let s=this.providerFactory.componentProviders,a=yo(t,t[ue],this.providerFactory.index,r);o=a.slice(0,s),Hp(i,o);for(let u=s;u<a.length;u++)o.push(a[u])}else o=[],Hp(i,o);return o}function Hp(n,e){for(let t=0;t<n.length;t++){let r=n[t];e.push(r())}return e}function V1(n,e,t,r,i){let o=new ii(n,t,Nt);return o.multi=[],o.index=e,o.componentProviders=0,AT(o,i,r&&!t),o}function H9(n,e=[]){return t=>{t.providersResolver=(r,i)=>O1(r,i?i(n):n,e)}}var j1=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let r=VE(!1,t.type),i=r.length>0?$l([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static{this.\u0275prov=K({token:n,providedIn:"environment",factory:()=>new n(Z(Ft))})}}return n})();function RT(n){Ao("NgStandalone"),n.getStandaloneInjector=e=>e.get(j1).getOrCreateStandaloneInjector(n)}function q9(n,e,t,r,i){return B1(Ie(),sD(),n,e,t,r,i)}function xT(n,e){let t=n[e];return t===ui?void 0:t}function U1(n,e,t,r,i,o){let s=e+t;return yr(n,s,i)?wT(n,s+1,o?r.call(o,i):r(i)):xT(n,s+1)}function B1(n,e,t,r,i,o,s){let a=e+t;return QP(n,a,i,o)?wT(n,a+2,s?r.call(s,i,o):r(i,o)):xT(n,a+2)}function z9(n,e){let t=xt(),r,i=n+pn;t.firstCreatePass?(r=$1(e,t.pipeRegistry),t.data[i]=r,r.onDestroy&&(t.destroyHooks??=[]).push(i,r.onDestroy)):r=t.data[i];let o=r.factory||(r.factory=ei(r.type,!0)),s,a=Rt(Nt);try{let u=ll(!1),l=o();return ll(u),x1(t,Ie(),i,l),l}finally{Rt(a)}}function $1(n,e){if(e)for(let t=e.length-1;t>=0;t--){let r=e[t];if(n===r.name)return r}}function G9(n,e,t){let r=n+pn,i=Ie(),o=Jx(i,r);return H1(i,r)?U1(i,sD(),e,o.transform,t,o):o.transform(t)}function H1(n,e){return n[ue].data[e].pure}var vr=class{constructor(e){this.full=e;let t=e.split(".");this.major=t[0],this.minor=t[1],this.patch=t.slice(2).join(".")}},MT=new vr("18.2.9");var Hl=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"platform"})}}return n})();var NT=new Y("");function Ro(n){return!!n&&typeof n.then=="function"}function Mg(n){return!!n&&typeof n.subscribe=="function"}var ql=new Y(""),PT=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r}),this.appInits=L(ql,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let t=[];for(let i of this.appInits){let o=i();if(Ro(o))t.push(o);else if(Mg(o)){let s=new Promise((a,u)=>{o.subscribe({complete:a,error:u})});t.push(s)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),t.length===0&&r(),this.initialized=!0}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),zl=new Y("");function q1(){sI(()=>{throw new Q(600,!1)})}function z1(n){return n.isBoundToModule}var G1=10;function W1(n,e,t){try{let r=t();return Ro(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}var ci=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=L($M),this.afterRenderManager=L(IT),this.zonelessEnabled=L(Ul),this.dirtyFlags=0,this.deferredDirtyFlags=0,this.externalTestViews=new Set,this.beforeRender=new Ye,this.afterTick=new Ye,this.componentTypes=[],this.components=[],this.isStable=L(bo).hasPendingTasks.pipe(le(t=>!t)),this._injector=L(Ft)}get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}whenStable(){let t;return new Promise(r=>{t=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{t.unsubscribe()})}get injector(){return this._injector}bootstrap(t,r){let i=t instanceof yl;if(!this._injector.get(PT).done){let m=!i&&kE(t),y=!1;throw new Q(405,y)}let s;i?s=t:s=this._injector.get(_o).resolveComponentFactory(t),this.componentTypes.push(s.componentType);let a=z1(s)?void 0:this._injector.get(mr),u=r||s.selector,l=s.create(ht.NULL,[],u,a),h=l.location.nativeElement,p=l.injector.get(NT,null);return p?.registerApplication(h),l.onDestroy(()=>{this.detachView(l.hostView),Yc(this.components,l),p?.unregisterApplication(h)}),this._loadComponent(l),l}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){if(this._runningTick)throw new Q(101,!1);let t=ge(null);try{this._runningTick=!0,this.synchronize()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1,ge(t),this.afterTick.next()}}synchronize(){let t=null;this._injector.destroyed||(t=this._injector.get(wo,null,{optional:!0})),this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0;let r=0;for(;this.dirtyFlags!==0&&r++<G1;)this.synchronizeOnce(t)}synchronizeOnce(t){if(this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0,this.dirtyFlags&7){let r=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8,this.beforeRender.next(r);for(let{_lView:i,notifyErrorHandler:o}of this._views)K1(i,o,r,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&7)return}else t?.begin?.(),t?.end?.();this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>xl(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){let r=t;Yc(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);let r=this._injector.get(zl,[]);[...this._bootstrapListeners,...r].forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Yc(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new Q(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function Yc(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function K1(n,e,t,r){if(!t&&!xl(n))return;dT(n,e,t&&!r?0:1)}var qp=class{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},Gl=(()=>{class n{compileModuleSync(t){return new Lp(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let r=this.compileModuleSync(t),i=OE(t),o=LD(i.declarations).reduce((s,a)=>{let u=pr(a);return u&&s.push(new Io(u)),s},[]);return new qp(r,o)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var Q1=(()=>{class n{constructor(){this.zone=L(ve),this.changeDetectionScheduler=L(vo),this.applicationRef=L(ci)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Y1=new Y("",{factory:()=>!1});function kT({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new ve(De($({},OT()),{scheduleInRootZone:t})),[{provide:ve,useFactory:n},{provide:ho,multi:!0,useFactory:()=>{let r=L(Q1,{optional:!0});return()=>r.initialize()}},{provide:ho,multi:!0,useFactory:()=>{let r=L(Z1);return()=>{r.initialize()}}},e===!0?{provide:gT,useValue:!0}:[],{provide:mT,useValue:t??CD}]}function W9(n){let e=n?.ignoreChangesOutsideZone,t=n?.scheduleInRootZone,r=kT({ngZoneFactory:()=>{let i=OT(n);return i.scheduleInRootZone=t,i.shouldCoalesceEventChangeDetection&&Ao("NgZone_CoalesceEvent"),new ve(i)},ignoreChangesOutsideZone:e,scheduleInRootZone:t});return mn([{provide:Y1,useValue:!0},{provide:Ul,useValue:!1},r])}function OT(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var Z1=(()=>{class n{constructor(){this.subscription=new ke,this.initialized=!1,this.zone=L(ve),this.pendingTasks=L(bo)}initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{ve.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{ve.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var J1=(()=>{class n{constructor(){this.appRef=L(ci),this.taskService=L(bo),this.ngZone=L(ve),this.zonelessEnabled=L(Ul),this.disableScheduling=L(gT,{optional:!0})??!1,this.zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run,this.schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}],this.subscriptions=new ke,this.angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(fl):null,this.scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(L(mT,{optional:!0})??!1),this.cancelScheduledCallback=null,this.useMicrotaskScheduler=!1,this.runningTick=!1,this.pendingRenderTaskId=null,this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof Tp||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&t===5)return;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 7:{this.appRef.deferredDirtyFlags|=8;break}case 9:case 8:case 6:case 10:default:this.appRef.dirtyFlags|=8}if(!this.shouldScheduleTick())return;let r=this.useMicrotaskScheduler?KI:bD;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>r(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(){return!(this.disableScheduling||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(fl+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){throw this.taskService.remove(t),r}finally{this.cleanup()}this.useMicrotaskScheduler=!0,KI(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function X1(){return typeof $localize<"u"&&$localize.locale||Il}var Ng=new Y("",{providedIn:"root",factory:()=>L(Ng,ae.Optional|ae.SkipSelf)||X1()});var zp=new Y("");function Gc(n){return!n.moduleRef}function ek(n){let e=Gc(n)?n.r3Injector:n.moduleRef.injector,t=e.get(ve);return t.run(()=>{Gc(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let r=e.get(Fn,null),i;if(t.runOutsideAngular(()=>{i=t.onError.subscribe({next:o=>{r.handleError(o)}})}),Gc(n)){let o=()=>e.destroy(),s=n.platformInjector.get(zp);s.add(o),e.onDestroy(()=>{i.unsubscribe(),s.delete(o)})}else{let o=()=>n.moduleRef.destroy(),s=n.platformInjector.get(zp);s.add(o),n.moduleRef.onDestroy(()=>{Yc(n.allPlatformModules,n.moduleRef),i.unsubscribe(),s.delete(o)})}return W1(r,t,()=>{let o=e.get(PT);return o.runInitializers(),o.donePromise.then(()=>{let s=e.get(Ng,Il);if(S1(s||Il),Gc(n)){let a=e.get(ci);return n.rootComponent!==void 0&&a.bootstrap(n.rootComponent),a}else return tk(n.moduleRef,n.allPlatformModules),n.moduleRef})})})}function tk(n,e){let t=n.injector.get(ci);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(r=>t.bootstrap(r));else if(n.instance.ngDoBootstrap)n.instance.ngDoBootstrap(t);else throw new Q(-403,!1);e.push(n)}var Zc=null;function nk(n=[],e){return ht.create({name:e,providers:[{provide:bl,useValue:"platform"},{provide:zp,useValue:new Set([()=>Zc=null])},...n]})}function rk(n=[]){if(Zc)return Zc;let e=nk(n);return Zc=e,q1(),ik(e),e}function ik(n){n.get(yg,null)?.forEach(t=>t())}function K9(){return!1}var xo=(()=>{class n{static{this.__NG_ELEMENT_ID__=ok}}return n})();function ok(n){return sk(Mt(),Ie(),(n&16)===16)}function sk(n,e,t){if(Al(n)&&!t){let r=_r(n.index,e);return new si(r,r)}else if(n.type&175){let r=e[fn];return new si(r,e)}return null}var Gp=class{constructor(){}supports(e){return _T(e)}create(e){return new Wp(e)}},ak=(n,e)=>e,Wp=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||ak}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,o=null;for(;t||r;){let s=!r||t&&t.currentIndex<hE(r,i,o)?t:r,a=hE(s,i,o),u=s.currentIndex;if(s===r)i--,r=r._nextRemoved;else if(t=t._next,s.previousIndex==null)i++;else{o||(o=[]);let l=a-i,h=u-i;if(l!=h){for(let m=0;m<l;m++){let y=m<o.length?o[m]:o[m]=0,D=y+m;h<=D&&D<l&&(o[m]=y+1)}let p=s.previousIndex;o[p]=h-l}}a!==u&&e(s,a,u)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!_T(e))throw new Q(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,r=!1,i,o,s;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)o=e[a],s=this._trackByFn(a,o),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,o,s,a),r=!0):(r&&(t=this._verifyReinsertion(t,o,s,a)),Object.is(t.item,o)||this._addIdentityChange(t,o)),t=t._next}else i=0,WP(e,a=>{s=this._trackByFn(i,a),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,a,s,i),r=!0):(r&&(t=this._verifyReinsertion(t,a,s,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let o;return e===null?o=this._itTail:(o=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,i)):e=this._addAfter(new Kp(t,r),o,i)),e}_verifyReinsertion(e,t,r,i){let o=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return o!==null?e=this._reinsertAfter(o,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,o=e._nextRemoved;return i===null?this._removalsHead=o:i._nextRemoved=o,o===null?this._removalsTail=i:o._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){let i=t===null?this._itHead:t._next;return e._next=i,e._prev=t,i===null?this._itTail=e:i._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new El),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,r=e._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new El),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},Kp=class{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},Qp=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let t=e._prevDup,r=e._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},El=class{constructor(){this.map=new Map}put(e){let t=e.trackById,r=this.map.get(t);r||(r=new Qp,this.map.set(t,r)),r.add(e)}get(e,t){let r=e,i=this.map.get(r);return i?i.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function hE(n,e,t){let r=n.previousIndex;if(r===null)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}function fE(){return new Pg([new Gp])}var Pg=(()=>{class n{static{this.\u0275prov=K({token:n,providedIn:"root",factory:fE})}constructor(t){this.factories=t}static create(t,r){if(r!=null){let i=r.factories.slice();t=t.concat(i)}return new n(t)}static extend(t){return{provide:n,useFactory:r=>n.create(t,r||fE()),deps:[[n,new Jp,new ft]]}}find(t){let r=this.factories.find(i=>i.supports(t));if(r!=null)return r;throw new Q(901,!1)}}return n})();function FT(n){try{let{rootComponent:e,appProviders:t,platformProviders:r}=n,i=rk(r),o=[kT({}),{provide:vo,useExisting:J1},...t||[]],s=new _l({providers:o,parent:i,debugName:"",runEnvironmentInitializers:!1});return ek({r3Injector:s.injector,platformInjector:i,rootComponent:e})}catch(e){return Promise.reject(e)}}function LT(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}function Q9(n,e){Ao("NgSignals");let t=rI(n);return e?.equal&&(t[Nn].equal=e.equal),t}function kg(n){let e=ge(null);try{return n()}finally{ge(e)}}function VT(n){let e=pr(n);if(!e)return null;let t=new Io(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var qT=null;function Mo(){return qT}function zT(n){qT??=n}var Wl=class{};var Pt=new Y(""),$g=(()=>{class n{historyGo(t){throw new Error("")}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=K({token:n,factory:()=>L(lk),providedIn:"platform"})}}return n})(),GT=new Y(""),lk=(()=>{class n extends $g{constructor(){super(),this._doc=L(Pt),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Mo().getBaseHref(this._doc)}onPopState(t){let r=Mo().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=Mo().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=K({token:n,factory:()=>new n,providedIn:"platform"})}}return n})();function Hg(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function jT(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,r=t-(n[t-1]==="/"?1:0);return n.slice(0,r)+n.slice(t)}function Un(n){return n&&n[0]!=="?"?"?"+n:n}var li=(()=>{class n{historyGo(t){throw new Error("")}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=K({token:n,factory:()=>L(qg),providedIn:"root"})}}return n})(),WT=new Y(""),qg=(()=>{class n extends li{constructor(t,r){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??L(Pt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Hg(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+Un(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,o){let s=this.prepareExternalUrl(i+Un(o));this._platformLocation.pushState(t,r,s)}replaceState(t,r,i,o){let s=this.prepareExternalUrl(i+Un(o));this._platformLocation.replaceState(t,r,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(r){return new(r||n)(Z($g),Z(WT,8))}}static{this.\u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),KT=(()=>{class n extends li{constructor(t,r){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],r!=null&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let r=this._platformLocation.hash??"#";return r.length>0?r.substring(1):r}prepareExternalUrl(t){let r=Hg(this._baseHref,t);return r.length>0?"#"+r:r}pushState(t,r,i,o){let s=this.prepareExternalUrl(i+Un(o));s.length==0&&(s=this._platformLocation.pathname),this._platformLocation.pushState(t,r,s)}replaceState(t,r,i,o){let s=this.prepareExternalUrl(i+Un(o));s.length==0&&(s=this._platformLocation.pathname),this._platformLocation.replaceState(t,r,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(r){return new(r||n)(Z($g),Z(WT,8))}}static{this.\u0275prov=K({token:n,factory:n.\u0275fac})}}return n})(),No=(()=>{class n{constructor(t){this._subject=new Et,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=fk(jT(UT(r))),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+Un(r))}normalize(t){return n.stripTrailingSlash(hk(this._basePath,UT(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Un(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Un(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r,complete:i})}static{this.normalizeQueryParams=Un}static{this.joinWithSlash=Hg}static{this.stripTrailingSlash=jT}static{this.\u0275fac=function(r){return new(r||n)(Z(li))}}static{this.\u0275prov=K({token:n,factory:()=>dk(),providedIn:"root"})}}return n})();function dk(){return new No(Z(li))}function hk(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function UT(n){return n.replace(/\/index.html$/,"")}function fk(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}function QT(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,o]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(o)}return null}var Og=/\s+/,BT=[],IG=(()=>{class n{constructor(t,r){this._ngEl=t,this._renderer=r,this.initialClasses=BT,this.stateMap=new Map}set klass(t){this.initialClasses=t!=null?t.trim().split(Og):BT}set ngClass(t){this.rawClass=typeof t=="string"?t.trim().split(Og):t}ngDoCheck(){for(let r of this.initialClasses)this._updateState(r,!0);let t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(let r of t)this._updateState(r,!0);else if(t!=null)for(let r of Object.keys(t))this._updateState(r,!!t[r]);this._applyStateDiff()}_updateState(t,r){let i=this.stateMap.get(t);i!==void 0?(i.enabled!==r&&(i.changed=!0,i.enabled=r),i.touched=!0):this.stateMap.set(t,{enabled:r,changed:!0,touched:!0})}_applyStateDiff(){for(let t of this.stateMap){let r=t[0],i=t[1];i.changed?(this._toggleClass(r,i.enabled),i.changed=!1):i.touched||(i.enabled&&this._toggleClass(r,!1),this.stateMap.delete(r)),i.touched=!1}}_toggleClass(t,r){t=t.trim(),t.length>0&&t.split(Og).forEach(i=>{r?this._renderer.addClass(this._ngEl.nativeElement,i):this._renderer.removeClass(this._ngEl.nativeElement,i)})}static{this.\u0275fac=function(r){return new(r||n)(Nt(Ia),Nt(Bl))}}static{this.\u0275dir=Do({type:n,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"},standalone:!0})}}return n})();var Fg=class{constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},EG=(()=>{class n{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;if(!this._differ&&t)if(0)try{}catch{}else this._differ=this._differs.find(t).create(this.ngForTrackBy)}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let r=this._viewContainer;t.forEachOperation((i,o,s)=>{if(i.previousIndex==null)r.createEmbeddedView(this._template,new Fg(i.item,this._ngForOf,-1,-1),s===null?void 0:s);else if(s==null)r.remove(o===null?void 0:o);else if(o!==null){let a=r.get(o);r.move(a,s),$T(a,i)}});for(let i=0,o=r.length;i<o;i++){let a=r.get(i).context;a.index=i,a.count=o,a.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{let o=r.get(i.currentIndex);$T(o,i)})}static ngTemplateContextGuard(t,r){return!0}static{this.\u0275fac=function(r){return new(r||n)(Nt(So),Nt(jl),Nt(Pg))}}static{this.\u0275dir=Do({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}}return n})();function $T(n,e){n.context.$implicit=e.item}var DG=(()=>{class n{constructor(t,r){this._viewContainer=t,this._context=new Lg,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){HT("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){HT("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,r){return!0}static{this.\u0275fac=function(r){return new(r||n)(Nt(So),Nt(jl))}}static{this.\u0275dir=Do({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}}return n})(),Lg=class{constructor(){this.$implicit=null,this.ngIf=null}};function HT(n,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${n} must be a TemplateRef, but received '${Dt(e)}'.`)}function pk(n,e){return new Q(2100,!1)}var Vg=class{createSubscription(e,t){return kg(()=>e.subscribe({next:t,error:r=>{throw r}}))}dispose(e){kg(()=>e.unsubscribe())}},jg=class{createSubscription(e,t){return e.then(t,r=>{throw r})}dispose(e){}},gk=new jg,mk=new Vg,TG=(()=>{class n{constructor(t){this._latestValue=null,this.markForCheckOnValueUpdate=!0,this._subscription=null,this._obj=null,this._strategy=null,this._ref=t}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(t){if(!this._obj){if(t)try{this.markForCheckOnValueUpdate=!1,this._subscribe(t)}finally{this.markForCheckOnValueUpdate=!0}return this._latestValue}return t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,r=>this._updateLatestValue(t,r))}_selectStrategy(t){if(Ro(t))return gk;if(Mg(t))return mk;throw pk(n,t)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,r){t===this._obj&&(this._latestValue=r,this.markForCheckOnValueUpdate&&this._ref?.markForCheck())}static{this.\u0275fac=function(r){return new(r||n)(Nt(xo,16))}}static{this.\u0275pipe=ME({name:"async",type:n,pure:!1,standalone:!0})}}return n})();var yk=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=_a({type:n})}static{this.\u0275inj=ya({})}}return n})(),zg="browser",vk="server";function _k(n){return n===zg}function Gg(n){return n===vk}var YT=(()=>{class n{static{this.\u0275prov=K({token:n,providedIn:"root",factory:()=>_k(L(vn))?new Ug(L(Pt),window):new Bg})}}return n})(),Ug=class{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let t=wk(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,o=this.offset();this.window.scrollTo(r-o[0],i-o[1])}};function wk(n,e){let t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if(typeof n.createTreeWalker=="function"&&n.body&&typeof n.body.attachShadow=="function"){let r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let o=i.shadowRoot;if(o){let s=o.getElementById(e)||o.querySelector(`[name="${e}"]`);if(s)return s}i=r.nextNode()}}return null}var Bg=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},Kl=class{};var Qg=class extends Wl{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Yg=class n extends Qg{static makeCurrent(){zT(new n)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=Ik();return t==null?null:Ek(t)}resetBaseElement(){Da=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return QT(document.cookie,e)}},Da=null;function Ik(){return Da=Da||document.querySelector("base"),Da?Da.getAttribute("href"):null}function Ek(n){return new URL(n,document.baseURI).pathname}var Dk=(()=>{class n{build(){return new XMLHttpRequest}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=K({token:n,factory:n.\u0275fac})}}return n})(),Zg=new Y(""),eC=(()=>{class n{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i){return this._findPluginFor(r).addEventListener(t,r,i)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(o=>o.supports(t)),!r)throw new Q(5101,!1);return this._eventNameToPlugin.set(t,r),r}static{this.\u0275fac=function(r){return new(r||n)(Z(Zg),Z(ve))}}static{this.\u0275prov=K({token:n,factory:n.\u0275fac})}}return n})(),Ql=class{constructor(e){this._doc=e}},Wg="ng-app-id",tC=(()=>{class n{constructor(t,r,i,o={}){this.doc=t,this.appId=r,this.nonce=i,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Gg(o),this.resetHostNodes()}addStyles(t){for(let r of t)this.changeUsageCount(r,1)===1&&this.onStyleAdded(r)}removeStyles(t){for(let r of t)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){let t=this.styleNodesInDOM;t&&(t.forEach(r=>r.remove()),t.clear());for(let r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(let r of this.getAllStyles())this.addStyleToHost(t,r)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(let r of this.hostNodes)this.addStyleToHost(r,t)}onStyleRemoved(t){let r=this.styleRef;r.get(t)?.elements?.forEach(i=>i.remove()),r.delete(t)}collectServerRenderedStyles(){let t=this.doc.head?.querySelectorAll(`style[${Wg}="${this.appId}"]`);if(t?.length){let r=new Map;return t.forEach(i=>{i.textContent!=null&&r.set(i.textContent,i)}),r}return null}changeUsageCount(t,r){let i=this.styleRef;if(i.has(t)){let o=i.get(t);return o.usage+=r,o.usage}return i.set(t,{usage:r,elements:[]}),r}getStyleElement(t,r){let i=this.styleNodesInDOM,o=i?.get(r);if(o?.parentNode===t)return i.delete(r),o.removeAttribute(Wg),o;{let s=this.doc.createElement("style");return this.nonce&&s.setAttribute("nonce",this.nonce),s.textContent=r,this.platformIsServer&&s.setAttribute(Wg,this.appId),t.appendChild(s),s}}addStyleToHost(t,r){let i=this.getStyleElement(t,r),o=this.styleRef,s=o.get(r)?.elements;s?s.push(i):o.set(r,{elements:[i],usage:1})}resetHostNodes(){let t=this.hostNodes;t.clear(),t.add(this.doc.head)}static{this.\u0275fac=function(r){return new(r||n)(Z(Pt),Z(mg),Z(vg,8),Z(vn))}}static{this.\u0275prov=K({token:n,factory:n.\u0275fac})}}return n})(),Kg={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Xg=/%COMP%/g,nC="%COMP%",Tk=`_nghost-${nC}`,Ck=`_ngcontent-${nC}`,bk=!0,Sk=new Y("",{providedIn:"root",factory:()=>bk});function Ak(n){return Ck.replace(Xg,n)}function Rk(n){return Tk.replace(Xg,n)}function rC(n,e){return e.map(t=>t.replace(Xg,n))}var ZT=(()=>{class n{constructor(t,r,i,o,s,a,u,l=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=o,this.doc=s,this.platformId=a,this.ngZone=u,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=Gg(a),this.defaultRenderer=new Ta(t,s,u,this.platformIsServer)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===dn.ShadowDom&&(r=De($({},r),{encapsulation:dn.Emulated}));let i=this.getOrCreateRenderer(t,r);return i instanceof Yl?i.applyToHost(t):i instanceof Ca&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,o=i.get(r.id);if(!o){let s=this.doc,a=this.ngZone,u=this.eventManager,l=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,p=this.platformIsServer;switch(r.encapsulation){case dn.Emulated:o=new Yl(u,l,r,this.appId,h,s,a,p);break;case dn.ShadowDom:return new Jg(u,l,t,r,s,a,this.nonce,p);default:o=new Ca(u,l,r,h,s,a,p);break}i.set(r.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(r){return new(r||n)(Z(eC),Z(tC),Z(mg),Z(Sk),Z(Pt),Z(vn),Z(ve),Z(vg))}}static{this.\u0275prov=K({token:n,factory:n.\u0275fac})}}return n})(),Ta=class{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(Kg[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(JT(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(JT(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new Q(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let o=Kg[i];o?e.setAttributeNS(o,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=Kg[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Ln.DashCase|Ln.Important)?e.style.setProperty(t,r,i&Ln.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Ln.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r){if(typeof e=="string"&&(e=Mo().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function JT(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var Jg=class extends Ta{constructor(e,t,r,i,o,s,a,u){super(e,o,s,u),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=rC(i.id,i.styles);for(let h of l){let p=document.createElement("style");a&&p.setAttribute("nonce",a),p.textContent=h,this.shadowRoot.appendChild(p)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Ca=class extends Ta{constructor(e,t,r,i,o,s,a,u){super(e,o,s,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=u?rC(u,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Yl=class extends Ca{constructor(e,t,r,i,o,s,a,u){let l=i+"-"+r.id;super(e,t,r,o,s,a,u,l),this.contentAttr=Ak(l),this.hostAttr=Rk(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},xk=(()=>{class n extends Ql{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i){return t.addEventListener(r,i,!1),()=>this.removeEventListener(t,r,i)}removeEventListener(t,r,i){return t.removeEventListener(r,i)}static{this.\u0275fac=function(r){return new(r||n)(Z(Pt))}}static{this.\u0275prov=K({token:n,factory:n.\u0275fac})}}return n})(),XT=["alt","control","meta","shift"],Mk={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Nk={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},Pk=(()=>{class n extends Ql{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i){let o=n.parseEventName(r),s=n.eventCallback(o.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Mo().onAndCancel(t,o.domEventName,s))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let o=n._normalizeKey(r.pop()),s="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),s="code."),XT.forEach(l=>{let h=r.indexOf(l);h>-1&&(r.splice(h,1),s+=l+".")}),s+=o,r.length!=0||o.length===0)return null;let u={};return u.domEventName=i,u.fullKey=s,u}static matchEventFullKeyCode(t,r){let i=Mk[t.key]||t.key,o="";return r.indexOf("code.")>-1&&(i=t.code,o="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),XT.forEach(s=>{if(s!==i){let a=Nk[s];a(t)&&(o+=s+".")}}),o+=i,o===r)}static eventCallback(t,r,i){return o=>{n.matchEventFullKeyCode(o,t)&&i.runGuarded(()=>r(o))}}static _normalizeKey(t){return t==="esc"?"escape":t}static{this.\u0275fac=function(r){return new(r||n)(Z(Pt))}}static{this.\u0275prov=K({token:n,factory:n.\u0275fac})}}return n})();function ZG(n,e){return FT($({rootComponent:n},kk(e)))}function kk(n){return{appProviders:[...jk,...n?.providers??[]],platformProviders:Vk}}function Ok(){Yg.makeCurrent()}function Fk(){return new Fn}function Lk(){return PD(document),document}var Vk=[{provide:vn,useValue:zg},{provide:yg,useValue:Ok,multi:!0},{provide:Pt,useFactory:Lk,deps:[]}];var jk=[{provide:bl,useValue:"root"},{provide:Fn,useFactory:Fk,deps:[]},{provide:Zg,useClass:xk,multi:!0,deps:[Pt,ve,vn]},{provide:Zg,useClass:Pk,multi:!0,deps:[Pt]},ZT,tC,eC,{provide:wo,useExisting:ZT},{provide:Kl,useClass:Dk,deps:[]},[]];var iC=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static{this.\u0275fac=function(r){return new(r||n)(Z(Pt))}}static{this.\u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var ie="primary",Ba=Symbol("RouteTitle"),im=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Vo(n){return new im(n)}function Bk(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let o=0;o<r.length;o++){let s=r[o],a=n[o];if(s[0]===":")i[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function $k(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!_n(n[t],e[t]))return!1;return!0}function _n(n,e){let t=n?om(n):void 0,r=e?om(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let o=0;o<t.length;o++)if(i=t[o],!gC(n[i],e[i]))return!1;return!0}function om(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function gC(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,o)=>r[o]===i)}else return n===e}function mC(n){return n.length>0?n[n.length-1]:null}function Er(n){return Uf(n)?n:Ro(n)?Me(Promise.resolve(n)):J(n)}var Hk={exact:vC,subset:_C},yC={exact:qk,subset:zk,ignored:()=>!0};function oC(n,e,t){return Hk[t.paths](n.root,e.root,t.matrixParams)&&yC[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function qk(n,e){return _n(n,e)}function vC(n,e,t){if(!hi(n.segments,e.segments)||!Xl(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!vC(n.children[r],e.children[r],t))return!1;return!0}function zk(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>gC(n[t],e[t]))}function _C(n,e,t){return wC(n,e,e.segments,t)}function wC(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!hi(i,t)||e.hasChildren()||!Xl(i,t,r))}else if(n.segments.length===t.length){if(!hi(n.segments,t)||!Xl(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!_C(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),o=t.slice(n.segments.length);return!hi(n.segments,i)||!Xl(n.segments,i,r)||!n.children[ie]?!1:wC(n.children[ie],e,o,r)}}function Xl(n,e,t){return e.every((r,i)=>yC[t](n[i].parameters,r.parameters))}var $n=class{constructor(e=new _e([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Vo(this.queryParams),this._queryParamMap}toString(){return Kk.serialize(this)}},_e=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return ed(this)}},di=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Vo(this.parameters),this._parameterMap}toString(){return EC(this)}};function Gk(n,e){return hi(n,e)&&n.every((t,r)=>_n(t.parameters,e[r].parameters))}function hi(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function Wk(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===ie&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==ie&&(t=t.concat(e(i,r)))}),t}var $a=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=K({token:n,factory:()=>new jo,providedIn:"root"})}}return n})(),jo=class{parse(e){let t=new am(e);return new $n(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${ba(e.root,!0)}`,r=Zk(e.queryParams),i=typeof e.fragment=="string"?`#${Qk(e.fragment)}`:"";return`${t}${r}${i}`}},Kk=new jo;function ed(n){return n.segments.map(e=>EC(e)).join("/")}function ba(n,e){if(!n.hasChildren())return ed(n);if(e){let t=n.children[ie]?ba(n.children[ie],!1):"",r=[];return Object.entries(n.children).forEach(([i,o])=>{i!==ie&&r.push(`${i}:${ba(o,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=Wk(n,(r,i)=>i===ie?[ba(n.children[ie],!1)]:[`${i}:${ba(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[ie]!=null?`${ed(n)}/${t[0]}`:`${ed(n)}/(${t.join("//")})`}}function IC(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Zl(n){return IC(n).replace(/%3B/gi,";")}function Qk(n){return encodeURI(n)}function sm(n){return IC(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function td(n){return decodeURIComponent(n)}function sC(n){return td(n.replace(/\+/g,"%20"))}function EC(n){return`${sm(n.path)}${Yk(n.parameters)}`}function Yk(n){return Object.entries(n).map(([e,t])=>`;${sm(e)}=${sm(t)}`).join("")}function Zk(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${Zl(t)}=${Zl(i)}`).join("&"):`${Zl(t)}=${Zl(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var Jk=/^[^\/()?;#]+/;function em(n){let e=n.match(Jk);return e?e[0]:""}var Xk=/^[^\/()?;=#]+/;function eO(n){let e=n.match(Xk);return e?e[0]:""}var tO=/^[^=?&#]+/;function nO(n){let e=n.match(tO);return e?e[0]:""}var rO=/^[^&#]+/;function iO(n){let e=n.match(rO);return e?e[0]:""}var am=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new _e([],{}):new _e([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[ie]=new _e(e,t)),r}parseSegment(){let e=em(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new Q(4009,!1);return this.capture(e),new di(td(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=eO(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=em(this.remaining);i&&(r=i,this.capture(r))}e[td(t)]=td(r)}parseQueryParam(e){let t=nO(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let s=iO(this.remaining);s&&(r=s,this.capture(r))}let i=sC(t),o=sC(r);if(e.hasOwnProperty(i)){let s=e[i];Array.isArray(s)||(s=[s],e[i]=s),s.push(o)}else e[i]=o}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=em(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new Q(4010,!1);let o;r.indexOf(":")>-1?(o=r.slice(0,r.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=ie);let s=this.parseChildren();t[o]=Object.keys(s).length===1?s[ie]:new _e([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new Q(4011,!1)}};function DC(n){return n.segments.length>0?new _e([],{[ie]:n}):n}function TC(n){let e={};for(let[r,i]of Object.entries(n.children)){let o=TC(i);if(r===ie&&o.segments.length===0&&o.hasChildren())for(let[s,a]of Object.entries(o.children))e[s]=a;else(o.segments.length>0||o.hasChildren())&&(e[r]=o)}let t=new _e(n.segments,e);return oO(t)}function oO(n){if(n.numberOfChildren===1&&n.children[ie]){let e=n.children[ie];return new _e(n.segments.concat(e.segments),e.children)}return n}function Na(n){return n instanceof $n}function sO(n,e,t=null,r=null){let i=CC(n);return bC(i,e,t,r)}function CC(n){let e;function t(o){let s={};for(let u of o.children){let l=t(u);s[u.outlet]=l}let a=new _e(o.url,s);return o===n&&(e=a),a}let r=t(n.root),i=DC(r);return e??i}function bC(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return tm(i,i,i,t,r);let o=aO(e);if(o.toRoot())return tm(i,i,new _e([],{}),t,r);let s=uO(o,i,n),a=s.processChildren?Ra(s.segmentGroup,s.index,o.commands):AC(s.segmentGroup,s.index,o.commands);return tm(i,s.segmentGroup,a,t,r)}function nd(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Pa(n){return typeof n=="object"&&n!=null&&n.outlets}function tm(n,e,t,r,i){let o={};r&&Object.entries(r).forEach(([u,l])=>{o[u]=Array.isArray(l)?l.map(h=>`${h}`):`${l}`});let s;n===e?s=t:s=SC(n,e,t);let a=DC(TC(s));return new $n(a,o,i)}function SC(n,e,t){let r={};return Object.entries(n.children).forEach(([i,o])=>{o===e?r[i]=t:r[i]=SC(o,e,t)}),new _e(n.segments,r)}var rd=class{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&nd(r[0]))throw new Q(4003,!1);let i=r.find(Pa);if(i&&i!==mC(r))throw new Q(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function aO(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new rd(!0,0,n);let e=0,t=!1,r=n.reduce((i,o,s)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let a={};return Object.entries(o.outlets).forEach(([u,l])=>{a[u]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:a}]}if(o.segmentPath)return[...i,o.segmentPath]}return typeof o!="string"?[...i,o]:s===0?(o.split("/").forEach((a,u)=>{u==0&&a==="."||(u==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,o]},[]);return new rd(t,e,r)}var Oo=class{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function uO(n,e,t){if(n.isAbsolute)return new Oo(e,!0,0);if(!t)return new Oo(e,!1,NaN);if(t.parent===null)return new Oo(t,!0,0);let r=nd(n.commands[0])?0:1,i=t.segments.length-1+r;return cO(t,i,n.numberOfDoubleDots)}function cO(n,e,t){let r=n,i=e,o=t;for(;o>i;){if(o-=i,r=r.parent,!r)throw new Q(4005,!1);i=r.segments.length}return new Oo(r,!1,i-o)}function lO(n){return Pa(n[0])?n[0].outlets:{[ie]:n}}function AC(n,e,t){if(n??=new _e([],{}),n.segments.length===0&&n.hasChildren())return Ra(n,e,t);let r=dO(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let o=new _e(n.segments.slice(0,r.pathIndex),{});return o.children[ie]=new _e(n.segments.slice(r.pathIndex),n.children),Ra(o,0,i)}else return r.match&&i.length===0?new _e(n.segments,{}):r.match&&!n.hasChildren()?um(n,e,t):r.match?Ra(n,0,i):um(n,e,t)}function Ra(n,e,t){if(t.length===0)return new _e(n.segments,{});{let r=lO(t),i={};if(Object.keys(r).some(o=>o!==ie)&&n.children[ie]&&n.numberOfChildren===1&&n.children[ie].segments.length===0){let o=Ra(n.children[ie],e,t);return new _e(n.segments,o.children)}return Object.entries(r).forEach(([o,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(i[o]=AC(n.children[o],e,s))}),Object.entries(n.children).forEach(([o,s])=>{r[o]===void 0&&(i[o]=s)}),new _e(n.segments,i)}}function dO(n,e,t){let r=0,i=e,o={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return o;let s=n.segments[i],a=t[r];if(Pa(a))break;let u=`${a}`,l=r<t.length-1?t[r+1]:null;if(i>0&&u===void 0)break;if(u&&l&&typeof l=="object"&&l.outlets===void 0){if(!uC(u,l,s))return o;r+=2}else{if(!uC(u,{},s))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function um(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let o=t[i];if(Pa(o)){let u=hO(o.outlets);return new _e(r,u)}if(i===0&&nd(t[0])){let u=n.segments[e];r.push(new di(u.path,aC(t[0]))),i++;continue}let s=Pa(o)?o.outlets[ie]:`${o}`,a=i<t.length-1?t[i+1]:null;s&&a&&nd(a)?(r.push(new di(s,aC(a))),i+=2):(r.push(new di(s,{})),i++)}return new _e(r,{})}function hO(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=um(new _e([],{}),0,r))}),e}function aC(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function uC(n,e,t){return n==t.path&&_n(e,t.parameters)}var xa="imperative",rt=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(rt||{}),Gt=class{constructor(e,t){this.id=e,this.url=t}},Uo=class extends Gt{constructor(e,t,r="imperative",i=null){super(e,t),this.type=rt.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Hn=class extends Gt{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=rt.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Vt=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(Vt||{}),id=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(id||{}),Bn=class extends Gt{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=rt.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},wr=class extends Gt{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=rt.NavigationSkipped}},ka=class extends Gt{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=rt.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},od=class extends Gt{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=rt.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},cm=class extends Gt{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=rt.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},lm=class extends Gt{constructor(e,t,r,i,o){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=o,this.type=rt.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},dm=class extends Gt{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=rt.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},hm=class extends Gt{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=rt.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},fm=class{constructor(e){this.route=e,this.type=rt.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},pm=class{constructor(e){this.route=e,this.type=rt.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},gm=class{constructor(e){this.snapshot=e,this.type=rt.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},mm=class{constructor(e){this.snapshot=e,this.type=rt.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ym=class{constructor(e){this.snapshot=e,this.type=rt.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},vm=class{constructor(e){this.snapshot=e,this.type=rt.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},sd=class{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r,this.type=rt.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},Oa=class{},Bo=class{constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function fO(n,e){return n.providers&&!n._injector&&(n._injector=$l(n.providers,e,`Route: ${n.path}`)),n._injector??e}function tn(n){return n.outlet||ie}function pO(n,e){let t=n.filter(r=>tn(r)===e);return t.push(...n.filter(r=>tn(r)!==e)),t}function Ha(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var _m=class{get injector(){return Ha(this.route?.snapshot)??this.rootInjector}set injector(e){}constructor(e){this.rootInjector=e,this.outlet=null,this.route=null,this.children=new qa(this.rootInjector),this.attachRef=null}},qa=(()=>{class n{constructor(t){this.rootInjector=t,this.contexts=new Map}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new _m(this.rootInjector),this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static{this.\u0275fac=function(r){return new(r||n)(Z(Ft))}}static{this.\u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),ad=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=wm(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=wm(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=Im(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Im(e,this._root).map(t=>t.value)}};function wm(n,e){if(n===e.value)return e;for(let t of e.children){let r=wm(n,t);if(r)return r}return null}function Im(n,e){if(n===e.value)return[e];for(let t of e.children){let r=Im(n,t);if(r.length)return r.unshift(e),r}return[]}var Lt=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function ko(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var ud=class extends ad{constructor(e,t){super(e),this.snapshot=t,xm(this,e)}toString(){return this.snapshot.toString()}};function RC(n){let e=gO(n),t=new Ze([new di("",{})]),r=new Ze({}),i=new Ze({}),o=new Ze({}),s=new Ze(""),a=new fi(t,r,o,s,i,ie,n,e.root);return a.snapshot=e.root,new ud(new Lt(a,[]),e)}function gO(n){let e={},t={},r={},i="",o=new Fo([],e,r,i,t,ie,n,null,{});return new ld("",new Lt(o,[]))}var fi=class{constructor(e,t,r,i,o,s,a,u){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=u,this.title=this.dataSubject?.pipe(le(l=>l[Ba]))??J(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(le(e=>Vo(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(le(e=>Vo(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function cd(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:$($({},e.params),n.params),data:$($({},e.data),n.data),resolve:$($($($({},n.data),e.data),i?.data),n._resolvedData)}:r={params:$({},n.params),data:$({},n.data),resolve:$($({},n.data),n._resolvedData??{})},i&&MC(i)&&(r.resolve[Ba]=i.title),r}var Fo=class{get title(){return this.data?.[Ba]}constructor(e,t,r,i,o,s,a,u,l){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=s,this.component=a,this.routeConfig=u,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Vo(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Vo(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},ld=class extends ad{constructor(e,t){super(t),this.url=e,xm(this,t)}toString(){return xC(this._root)}};function xm(n,e){e.value._routerState=n,e.children.forEach(t=>xm(n,t))}function xC(n){let e=n.children.length>0?` { ${n.children.map(xC).join(", ")} } `:"";return`${n.value}${e}`}function nm(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,_n(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),_n(e.params,t.params)||n.paramsSubject.next(t.params),$k(e.url,t.url)||n.urlSubject.next(t.url),_n(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function Em(n,e){let t=_n(n.params,e.params)&&Gk(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||Em(n.parent,e.parent))}function MC(n){return typeof n.title=="string"||n.title===null}var mO=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=ie,this.activateEvents=new Et,this.deactivateEvents=new Et,this.attachEvents=new Et,this.detachEvents=new Et,this.parentContexts=L(qa),this.location=L(So),this.changeDetector=L(xo),this.inputBinder=L(pd,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Q(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Q(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Q(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new Q(4013,!1);this._activatedRoute=t;let i=this.location,s=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,u=new Dm(t,a,i.injector);this.activated=i.createComponent(s,{index:i.length,injector:u,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275dir=Do({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Rl]})}}return n})(),Dm=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===fi?this.route:e===qa?this.childContexts:this.parent.get(e,t)}},pd=new Y(""),cC=(()=>{class n{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){let{activatedRoute:r}=t,i=sa([r.queryParams,r.params,r.data]).pipe(wt(([o,s,a],u)=>(a=$($($({},o),s),a),u===0?J(a):Promise.resolve(a)))).subscribe(o=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==r||r.component===null){this.unsubscribeFromRouteData(t);return}let s=VT(r.component);if(!s){this.unsubscribeFromRouteData(t);return}for(let{templateName:a}of s.inputs)t.activatedComponentRef.setInput(a,o[a])});this.outletDataSubscriptions.set(t,i)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=K({token:n,factory:n.\u0275fac})}}return n})();function yO(n,e,t){let r=Fa(n,e._root,t?t._root:void 0);return new ud(r,e)}function Fa(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=vO(n,e,t);return new Lt(r,i)}else{if(n.shouldAttach(e.value)){let o=n.retrieve(e.value);if(o!==null){let s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>Fa(n,a)),s}}let r=_O(e.value),i=e.children.map(o=>Fa(n,o));return new Lt(r,i)}}function vO(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return Fa(n,r,i);return Fa(n,r)})}function _O(n){return new fi(new Ze(n.url),new Ze(n.params),new Ze(n.queryParams),new Ze(n.fragment),new Ze(n.data),n.outlet,n.component,n)}var La=class{constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},NC="ngNavigationCancelingError";function dd(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=Na(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=PC(!1,Vt.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function PC(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[NC]=!0,t.cancellationCode=e,t}function wO(n){return kC(n)&&Na(n.url)}function kC(n){return!!n&&n[NC]}var IO=(n,e,t,r)=>le(i=>(new Tm(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),Tm=class{constructor(e,t,r,i,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=o}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),nm(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=ko(t);e.children.forEach(o=>{let s=o.value.outlet;this.deactivateRoutes(o,i[s],r),delete i[s]}),Object.values(i).forEach(o=>{this.deactivateRouteAndItsChildren(o,r)})}deactivateRoutes(e,t,r){let i=e.value,o=t?t.value:null;if(i===o)if(i.component){let s=r.getContext(i.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,r);else o&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,o=ko(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);if(r&&r.outlet){let s=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,o=ko(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=ko(t);e.children.forEach(o=>{this.activateRoutes(o,i[o.value.outlet],r),this.forwardEvent(new vm(o.value.snapshot))}),e.children.length&&this.forwardEvent(new mm(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,o=t?t.value:null;if(nm(i),i===o)if(i.component){let s=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let s=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),nm(a.route.value),this.activateChildRoutes(e,null,s.children)}else s.attachRef=null,s.route=i,s.outlet&&s.outlet.activateWith(i,s.injector),this.activateChildRoutes(e,null,s.children)}else this.activateChildRoutes(e,null,r)}},hd=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Lo=class{constructor(e,t){this.component=e,this.route=t}};function EO(n,e,t){let r=n._root,i=e?e._root:null;return Sa(r,i,t,[r.value])}function DO(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function Ho(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!vE(n)?n:e.get(n):r}function Sa(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=ko(e);return n.children.forEach(s=>{TO(s,o[s.value.outlet],t,r.concat([s.value]),i),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>Ma(a,t.getContext(s),i)),i}function TO(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=n.value,s=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){let u=CO(s,o,o.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new hd(r)):(o.data=s.data,o._resolvedData=s._resolvedData),o.component?Sa(n,e,a?a.children:null,r,i):Sa(n,e,t,r,i),u&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Lo(a.outlet.component,s))}else s&&Ma(e,a,i),i.canActivateChecks.push(new hd(r)),o.component?Sa(n,null,a?a.children:null,r,i):Sa(n,null,t,r,i);return i}function CO(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!hi(n.url,e.url);case"pathParamsOrQueryParamsChange":return!hi(n.url,e.url)||!_n(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Em(n,e)||!_n(n.queryParams,e.queryParams);case"paramsChange":default:return!Em(n,e)}}function Ma(n,e,t){let r=ko(n),i=n.value;Object.entries(r).forEach(([o,s])=>{i.component?e?Ma(s,e.children.getContext(o),t):Ma(s,null,t):Ma(s,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Lo(e.outlet.component,i)):t.canDeactivateChecks.push(new Lo(null,i)):t.canDeactivateChecks.push(new Lo(null,i))}function za(n){return typeof n=="function"}function bO(n){return typeof n=="boolean"}function SO(n){return n&&za(n.canLoad)}function AO(n){return n&&za(n.canActivate)}function RO(n){return n&&za(n.canActivateChild)}function xO(n){return n&&za(n.canDeactivate)}function MO(n){return n&&za(n.canMatch)}function OC(n){return n instanceof kn||n?.name==="EmptyError"}var Jl=Symbol("INITIAL_VALUE");function $o(){return wt(n=>sa(n.map(e=>e.pipe(On(1),zf(Jl)))).pipe(le(e=>{for(let t of e)if(t!==!0){if(t===Jl)return Jl;if(t===!1||NO(t))return t}return!0}),Bt(e=>e!==Jl),On(1)))}function NO(n){return Na(n)||n instanceof La}function PO(n,e){return qe(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:s}}=t;return s.length===0&&o.length===0?J(De($({},t),{guardsResult:!0})):kO(s,r,i,n).pipe(qe(a=>a&&bO(a)?OO(r,o,n,e):J(a)),le(a=>De($({},t),{guardsResult:a})))})}function kO(n,e,t,r){return Me(n).pipe(qe(i=>UO(i.component,i.route,t,e,r)),un(i=>i!==!0,!0))}function OO(n,e,t,r){return Me(e).pipe(Jr(i=>no(LO(i.route.parent,r),FO(i.route,r),jO(n,i.path,t),VO(n,i.route,t))),un(i=>i!==!0,!0))}function FO(n,e){return n!==null&&e&&e(new ym(n)),J(!0)}function LO(n,e){return n!==null&&e&&e(new gm(n)),J(!0)}function VO(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return J(!0);let i=r.map(o=>Bc(()=>{let s=Ha(e)??t,a=Ho(o,s),u=AO(a)?a.canActivate(e,n):yn(s,()=>a(e,n));return Er(u).pipe(un())}));return J(i).pipe($o())}function jO(n,e,t){let r=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(s=>DO(s)).filter(s=>s!==null).map(s=>Bc(()=>{let a=s.guards.map(u=>{let l=Ha(s.node)??t,h=Ho(u,l),p=RO(h)?h.canActivateChild(r,n):yn(l,()=>h(r,n));return Er(p).pipe(un())});return J(a).pipe($o())}));return J(o).pipe($o())}function UO(n,e,t,r,i){let o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!o||o.length===0)return J(!0);let s=o.map(a=>{let u=Ha(e)??i,l=Ho(a,u),h=xO(l)?l.canDeactivate(n,e,t,r):yn(u,()=>l(n,e,t,r));return Er(h).pipe(un())});return J(s).pipe($o())}function BO(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return J(!0);let o=i.map(s=>{let a=Ho(s,n),u=SO(a)?a.canLoad(e,t):yn(n,()=>a(e,t));return Er(u)});return J(o).pipe($o(),FC(r))}function FC(n){return Pf(Je(e=>{if(typeof e!="boolean")throw dd(n,e)}),le(e=>e===!0))}function $O(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return J(!0);let o=i.map(s=>{let a=Ho(s,n),u=MO(a)?a.canMatch(e,t):yn(n,()=>a(e,t));return Er(u)});return J(o).pipe($o(),FC(r))}var Va=class{constructor(e){this.segmentGroup=e||null}},ja=class extends Error{constructor(e){super(),this.urlTree=e}};function Po(n){return to(new Va(n))}function HO(n){return to(new Q(4e3,!1))}function qO(n){return to(PC(!1,Vt.GuardRejected))}var Cm=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return J(r);if(i.numberOfChildren>1||!i.children[ie])return HO(`${e.redirectTo}`);i=i.children[ie]}}applyRedirectCommands(e,t,r,i,o){if(typeof t!="string"){let a=t,{queryParams:u,fragment:l,routeConfig:h,url:p,outlet:m,params:y,data:D,title:R}=i,S=yn(o,()=>a({params:y,data:D,queryParams:u,fragment:l,routeConfig:h,url:p,outlet:m,title:R}));if(S instanceof $n)throw new ja(S);t=S}let s=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t[0]==="/")throw new ja(s);return s}applyRedirectCreateUrlTree(e,t,r,i){let o=this.createSegmentGroup(e,t.root,r,i);return new $n(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,o])=>{if(typeof o=="string"&&o[0]===":"){let a=o.substring(1);r[i]=t[a]}else r[i]=o}),r}createSegmentGroup(e,t,r,i){let o=this.createSegments(e,t.segments,r,i),s={};return Object.entries(t.children).forEach(([a,u])=>{s[a]=this.createSegmentGroup(e,u,r,i)}),new _e(o,s)}createSegments(e,t,r,i){return t.map(o=>o.path[0]===":"?this.findPosParam(e,o,i):this.findOrReturn(o,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new Q(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},bm={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function zO(n,e,t,r,i){let o=LC(n,e,t);return o.matched?(r=fO(e,r),$O(r,e,t,i).pipe(le(s=>s===!0?o:$({},bm)))):J(o)}function LC(n,e,t){if(e.path==="**")return GO(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?$({},bm):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||Bk)(t,n,e);if(!i)return $({},bm);let o={};Object.entries(i.posParams??{}).forEach(([a,u])=>{o[a]=u.path});let s=i.consumed.length>0?$($({},o),i.consumed[i.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:s,positionalParamSegments:i.posParams??{}}}function GO(n){return{matched:!0,parameters:n.length>0?mC(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function lC(n,e,t,r){return t.length>0&&QO(n,t,r)?{segmentGroup:new _e(e,KO(r,new _e(t,n.children))),slicedSegments:[]}:t.length===0&&YO(n,t,r)?{segmentGroup:new _e(n.segments,WO(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new _e(n.segments,n.children),slicedSegments:t}}function WO(n,e,t,r){let i={};for(let o of t)if(gd(n,e,o)&&!r[tn(o)]){let s=new _e([],{});i[tn(o)]=s}return $($({},r),i)}function KO(n,e){let t={};t[ie]=e;for(let r of n)if(r.path===""&&tn(r)!==ie){let i=new _e([],{});t[tn(r)]=i}return t}function QO(n,e,t){return t.some(r=>gd(n,e,r)&&tn(r)!==ie)}function YO(n,e,t){return t.some(r=>gd(n,e,r))}function gd(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function ZO(n,e,t){return e.length===0&&!n.children[t]}var Sm=class{};function JO(n,e,t,r,i,o,s="emptyOnly"){return new Am(n,e,t,r,i,s,o).recognize()}var XO=31,Am=class{constructor(e,t,r,i,o,s,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.applyRedirects=new Cm(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new Q(4002,`'${e.segmentGroup}'`)}recognize(){let e=lC(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(le(({children:t,rootSnapshot:r})=>{let i=new Lt(r,t),o=new ld("",i),s=sO(r,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),{state:o,tree:s}}))}match(e){let t=new Fo([],Object.freeze({}),Object.freeze($({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),ie,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,ie,t).pipe(le(r=>({children:r,rootSnapshot:t})),ur(r=>{if(r instanceof ja)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Va?this.noMatchError(r):r}))}processSegmentGroup(e,t,r,i,o){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r,o):this.processSegment(e,t,r,r.segments,i,!0,o).pipe(le(s=>s instanceof Lt?[s]:[]))}processChildren(e,t,r,i){let o=[];for(let s of Object.keys(r.children))s==="primary"?o.unshift(s):o.push(s);return Me(o).pipe(Jr(s=>{let a=r.children[s],u=pO(t,s);return this.processSegmentGroup(e,u,a,s,i)}),Hf((s,a)=>(s.push(...a),s)),cr(null),$f(),qe(s=>{if(s===null)return Po(r);let a=VC(s);return eF(a),J(a)}))}processSegment(e,t,r,i,o,s,a){return Me(t).pipe(Jr(u=>this.processSegmentAgainstRoute(u._injector??e,t,u,r,i,o,s,a).pipe(ur(l=>{if(l instanceof Va)return J(null);throw l}))),un(u=>!!u),ur(u=>{if(OC(u))return ZO(r,i,o)?J(new Sm):Po(r);throw u}))}processSegmentAgainstRoute(e,t,r,i,o,s,a,u){return tn(r)!==s&&(s===ie||!gd(i,o,r))?Po(i):r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,o,s,u):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,o,s,u):Po(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,o,s,a){let{matched:u,parameters:l,consumedSegments:h,positionalParamSegments:p,remainingSegments:m}=LC(t,i,o);if(!u)return Po(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>XO&&(this.allowRedirects=!1));let y=new Fo(o,l,Object.freeze($({},this.urlTree.queryParams)),this.urlTree.fragment,dC(i),tn(i),i.component??i._loadedComponent??null,i,hC(i)),D=cd(y,a,this.paramsInheritanceStrategy);y.params=Object.freeze(D.params),y.data=Object.freeze(D.data);let R=this.applyRedirects.applyRedirectCommands(h,i.redirectTo,p,y,e);return this.applyRedirects.lineralizeSegments(i,R).pipe(qe(S=>this.processSegment(e,r,t,S.concat(m),s,!1,a)))}matchSegmentAgainstRoute(e,t,r,i,o,s){let a=zO(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),a.pipe(wt(u=>u.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(wt(({routes:l})=>{let h=r._loadedInjector??e,{parameters:p,consumedSegments:m,remainingSegments:y}=u,D=new Fo(m,p,Object.freeze($({},this.urlTree.queryParams)),this.urlTree.fragment,dC(r),tn(r),r.component??r._loadedComponent??null,r,hC(r)),R=cd(D,s,this.paramsInheritanceStrategy);D.params=Object.freeze(R.params),D.data=Object.freeze(R.data);let{segmentGroup:S,slicedSegments:O}=lC(t,m,y,l);if(O.length===0&&S.hasChildren())return this.processChildren(h,l,S,D).pipe(le(V=>new Lt(D,V)));if(l.length===0&&O.length===0)return J(new Lt(D,[]));let U=tn(r)===o;return this.processSegment(h,l,S,O,U?ie:o,!0,D).pipe(le(V=>new Lt(D,V instanceof Lt?[V]:[])))}))):Po(t)))}getChildConfig(e,t,r){return t.children?J({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?J({routes:t._loadedRoutes,injector:t._loadedInjector}):BO(e,t,r,this.urlSerializer).pipe(qe(i=>i?this.configLoader.loadChildren(e,t).pipe(Je(o=>{t._loadedRoutes=o.routes,t._loadedInjector=o.injector})):qO(t))):J({routes:[],injector:e})}};function eF(n){n.sort((e,t)=>e.value.outlet===ie?-1:t.value.outlet===ie?1:e.value.outlet.localeCompare(t.value.outlet))}function tF(n){let e=n.value.routeConfig;return e&&e.path===""}function VC(n){let e=[],t=new Set;for(let r of n){if(!tF(r)){e.push(r);continue}let i=e.find(o=>r.value.routeConfig===o.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=VC(r.children);e.push(new Lt(r.value,i))}return e.filter(r=>!t.has(r))}function dC(n){return n.data||{}}function hC(n){return n.resolve||{}}function nF(n,e,t,r,i,o){return qe(s=>JO(n,e,t,r,s.extractedUrl,i,o).pipe(le(({state:a,tree:u})=>De($({},s),{targetSnapshot:a,urlAfterRedirects:u}))))}function rF(n,e){return qe(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return J(t);let o=new Set(i.map(u=>u.route)),s=new Set;for(let u of o)if(!s.has(u))for(let l of jC(u))s.add(l);let a=0;return Me(s).pipe(Jr(u=>o.has(u)?iF(u,r,n,e):(u.data=cd(u,u.parent,n).resolve,J(void 0))),Je(()=>a++),ro(1),qe(u=>a===s.size?J(t):_t))})}function jC(n){let e=n.children.map(t=>jC(t)).flat();return[n,...e]}function iF(n,e,t,r){let i=n.routeConfig,o=n._resolve;return i?.title!==void 0&&!MC(i)&&(o[Ba]=i.title),oF(o,n,e,r).pipe(le(s=>(n._resolvedData=s,n.data=cd(n,n.parent,t).resolve,null)))}function oF(n,e,t,r){let i=om(n);if(i.length===0)return J({});let o={};return Me(i).pipe(qe(s=>sF(n[s],e,t,r).pipe(un(),Je(a=>{if(a instanceof La)throw dd(new jo,a);o[s]=a}))),ro(1),Bf(o),ur(s=>OC(s)?_t:to(s)))}function sF(n,e,t,r){let i=Ha(e)??r,o=Ho(n,i),s=o.resolve?o.resolve(e,t):yn(i,()=>o(e,t));return Er(s)}function rm(n){return wt(e=>{let t=n(e);return t?Me(t).pipe(le(()=>e)):J(e)})}var UC=(()=>{class n{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(o=>o.outlet===ie);return r}getResolvedTitleForRoute(t){return t.data[Ba]}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=K({token:n,factory:()=>L(aF),providedIn:"root"})}}return n})(),aF=(()=>{class n extends UC{constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static{this.\u0275fac=function(r){return new(r||n)(Z(iC))}}static{this.\u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Ga=new Y("",{providedIn:"root",factory:()=>({})}),uF=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=xE({type:n,selectors:[["ng-component"]],standalone:!0,features:[RT],decls:1,vars:0,template:function(r,i){r&1&&xg(0,"router-outlet")},dependencies:[mO],encapsulation:2})}}return n})();function Mm(n){let e=n.children&&n.children.map(Mm),t=e?De($({},n),{children:e}):$({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==ie&&(t.component=uF),t}var Ua=new Y(""),Nm=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=L(Gl)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return J(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let r=Er(t.loadComponent()).pipe(le(BC),Je(o=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=o}),aa(()=>{this.componentLoaders.delete(t)})),i=new Zi(r,()=>new Ye).pipe(Yi());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return J({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let o=cF(r,this.compiler,t,this.onLoadEndListener).pipe(aa(()=>{this.childrenLoaders.delete(r)})),s=new Zi(o,()=>new Ye).pipe(Yi());return this.childrenLoaders.set(r,s),s}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function cF(n,e,t,r){return Er(n.loadChildren()).pipe(le(BC),qe(i=>i instanceof pa||Array.isArray(i)?J(i):Me(e.compileModuleAsync(i))),le(i=>{r&&r(n);let o,s,a=!1;return Array.isArray(i)?(s=i,a=!0):(o=i.create(t).injector,s=o.get(Ua,[],{optional:!0,self:!0}).flat()),{routes:s.map(Mm),injector:o}}))}function lF(n){return n&&typeof n=="object"&&"default"in n}function BC(n){return lF(n)?n.default:n}var Pm=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=K({token:n,factory:()=>L(dF),providedIn:"root"})}}return n})(),dF=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),$C=new Y(""),HC=new Y("");function hF(n,e,t){let r=n.get(HC),i=n.get(Pt);return n.get(ve).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(l=>setTimeout(l));let o,s=new Promise(l=>{o=l}),a=i.startViewTransition(()=>(o(),fF(n))),{onViewTransitionCreated:u}=r;return u&&yn(n,()=>u({transition:a,from:e,to:t})),s})}function fF(n){return new Promise(e=>{Rg({read:()=>setTimeout(e)},{injector:n})})}var pF=new Y(""),km=(()=>{class n{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Ye,this.transitionAbortSubject=new Ye,this.configLoader=L(Nm),this.environmentInjector=L(Ft),this.urlSerializer=L($a),this.rootContexts=L(qa),this.location=L(No),this.inputBindingEnabled=L(pd,{optional:!0})!==null,this.titleStrategy=L(UC),this.options=L(Ga,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=L(Pm),this.createViewTransition=L($C,{optional:!0}),this.navigationErrorHandler=L(pF,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>J(void 0),this.rootComponentType=null;let t=i=>this.events.next(new fm(i)),r=i=>this.events.next(new pm(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;this.transitions?.next(De($($({},this.transitions.value),t),{id:r}))}setupNavigations(t,r,i){return this.transitions=new Ze({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:xa,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Bt(o=>o.id!==0),le(o=>De($({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),wt(o=>{let s=!1,a=!1;return J(o).pipe(wt(u=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",Vt.SupersededByNewNavigation),_t;this.currentTransition=o,this.currentNavigation={id:u.id,initialUrl:u.rawUrl,extractedUrl:u.extractedUrl,targetBrowserUrl:typeof u.extras.browserUrl=="string"?this.urlSerializer.parse(u.extras.browserUrl):u.extras.browserUrl,trigger:u.source,extras:u.extras,previousNavigation:this.lastSuccessfulNavigation?De($({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let l=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),h=u.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!l&&h!=="reload"){let p="";return this.events.next(new wr(u.id,this.urlSerializer.serialize(u.rawUrl),p,id.IgnoredSameUrlNavigation)),u.resolve(!1),_t}if(this.urlHandlingStrategy.shouldProcessUrl(u.rawUrl))return J(u).pipe(wt(p=>{let m=this.transitions?.getValue();return this.events.next(new Uo(p.id,this.urlSerializer.serialize(p.extractedUrl),p.source,p.restoredState)),m!==this.transitions?.getValue()?_t:Promise.resolve(p)}),nF(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),Je(p=>{o.targetSnapshot=p.targetSnapshot,o.urlAfterRedirects=p.urlAfterRedirects,this.currentNavigation=De($({},this.currentNavigation),{finalUrl:p.urlAfterRedirects});let m=new od(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(m)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(u.currentRawUrl)){let{id:p,extractedUrl:m,source:y,restoredState:D,extras:R}=u,S=new Uo(p,this.urlSerializer.serialize(m),y,D);this.events.next(S);let O=RC(this.rootComponentType).snapshot;return this.currentTransition=o=De($({},u),{targetSnapshot:O,urlAfterRedirects:m,extras:De($({},R),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=m,J(o)}else{let p="";return this.events.next(new wr(u.id,this.urlSerializer.serialize(u.extractedUrl),p,id.IgnoredByUrlHandlingStrategy)),u.resolve(!1),_t}}),Je(u=>{let l=new cm(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(l)}),le(u=>(this.currentTransition=o=De($({},u),{guards:EO(u.targetSnapshot,u.currentSnapshot,this.rootContexts)}),o)),PO(this.environmentInjector,u=>this.events.next(u)),Je(u=>{if(o.guardsResult=u.guardsResult,u.guardsResult&&typeof u.guardsResult!="boolean")throw dd(this.urlSerializer,u.guardsResult);let l=new lm(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot,!!u.guardsResult);this.events.next(l)}),Bt(u=>u.guardsResult?!0:(this.cancelNavigationTransition(u,"",Vt.GuardRejected),!1)),rm(u=>{if(u.guards.canActivateChecks.length)return J(u).pipe(Je(l=>{let h=new dm(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(h)}),wt(l=>{let h=!1;return J(l).pipe(rF(this.paramsInheritanceStrategy,this.environmentInjector),Je({next:()=>h=!0,complete:()=>{h||this.cancelNavigationTransition(l,"",Vt.NoDataFromResolver)}}))}),Je(l=>{let h=new hm(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(h)}))}),rm(u=>{let l=h=>{let p=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&p.push(this.configLoader.loadComponent(h.routeConfig).pipe(Je(m=>{h.component=m}),le(()=>{})));for(let m of h.children)p.push(...l(m));return p};return sa(l(u.targetSnapshot.root)).pipe(cr(null),On(1))}),rm(()=>this.afterPreactivation()),wt(()=>{let{currentSnapshot:u,targetSnapshot:l}=o,h=this.createViewTransition?.(this.environmentInjector,u.root,l.root);return h?Me(h).pipe(le(()=>o)):J(o)}),le(u=>{let l=yO(t.routeReuseStrategy,u.targetSnapshot,u.currentRouterState);return this.currentTransition=o=De($({},u),{targetRouterState:l}),this.currentNavigation.targetRouterState=l,o}),Je(()=>{this.events.next(new Oa)}),IO(this.rootContexts,t.routeReuseStrategy,u=>this.events.next(u),this.inputBindingEnabled),On(1),Je({next:u=>{s=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Hn(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects))),this.titleStrategy?.updateTitle(u.targetRouterState.snapshot),u.resolve(!0)},complete:()=>{s=!0}}),Gf(this.transitionAbortSubject.pipe(Je(u=>{throw u}))),aa(()=>{!s&&!a&&this.cancelNavigationTransition(o,"",Vt.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),ur(u=>{if(a=!0,kC(u))this.events.next(new Bn(o.id,this.urlSerializer.serialize(o.extractedUrl),u.message,u.cancellationCode)),wO(u)?this.events.next(new Bo(u.url,u.navigationBehaviorOptions)):o.resolve(!1);else{let l=new ka(o.id,this.urlSerializer.serialize(o.extractedUrl),u,o.targetSnapshot??void 0);try{let h=yn(this.environmentInjector,()=>this.navigationErrorHandler?.(l));if(h instanceof La){let{message:p,cancellationCode:m}=dd(this.urlSerializer,h);this.events.next(new Bn(o.id,this.urlSerializer.serialize(o.extractedUrl),p,m)),this.events.next(new Bo(h.redirectTo,h.navigationBehaviorOptions))}else{this.events.next(l);let p=t.errorHandler(u);o.resolve(!!p)}}catch(h){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(h)}}return _t}))}))}cancelNavigationTransition(t,r,i){let o=new Bn(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(o),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==r?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function gF(n){return n!==xa}var mF=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=K({token:n,factory:()=>L(yF),providedIn:"root"})}}return n})(),Rm=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},yF=(()=>{class n extends Rm{static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=hg(n)))(i||n)}})()}static{this.\u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),qC=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=K({token:n,factory:()=>L(vF),providedIn:"root"})}}return n})(),vF=(()=>{class n extends qC{constructor(){super(...arguments),this.location=L(No),this.urlSerializer=L($a),this.options=L(Ga,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=L(Pm),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new $n,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=RC(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&t(r.url,r.state)})}handleRouterEvent(t,r){if(t instanceof Uo)this.stateMemento=this.createStateMemento();else if(t instanceof wr)this.rawUrlTree=r.initialUrl;else if(t instanceof od){if(this.urlUpdateStrategy==="eager"&&!r.extras.skipLocationChange){let i=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(r.targetBrowserUrl??i,r)}}else t instanceof Oa?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(r.targetBrowserUrl??this.rawUrlTree,r)):t instanceof Bn&&(t.code===Vt.GuardRejected||t.code===Vt.NoDataFromResolver)?this.restoreHistory(r):t instanceof ka?this.restoreHistory(r,!0):t instanceof Hn&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,r){let i=t instanceof $n?this.urlSerializer.serialize(t):t;if(this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl){let o=this.browserPageId,s=$($({},r.extras.state),this.generateNgRouterState(r.id,o));this.location.replaceState(i,"",s)}else{let o=$($({},r.extras.state),this.generateNgRouterState(r.id,this.browserPageId+1));this.location.go(i,"",o)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,o=this.currentPageId-i;o!==0?this.location.historyGo(o):this.currentUrlTree===t.finalUrl&&o===0&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=hg(n)))(i||n)}})()}static{this.\u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Aa=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(Aa||{});function zC(n,e){n.events.pipe(Bt(t=>t instanceof Hn||t instanceof Bn||t instanceof ka||t instanceof wr),le(t=>t instanceof Hn||t instanceof wr?Aa.COMPLETE:(t instanceof Bn?t.code===Vt.Redirect||t.code===Vt.SupersededByNewNavigation:!1)?Aa.REDIRECTING:Aa.FAILED),Bt(t=>t!==Aa.REDIRECTING),On(1)).subscribe(()=>{e()})}function _F(n){throw n}var wF={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},IF={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Ir=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=L(Hl),this.stateManager=L(qC),this.options=L(Ga,{optional:!0})||{},this.pendingTasks=L(bo),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=L(km),this.urlSerializer=L($a),this.location=L(No),this.urlHandlingStrategy=L(Pm),this._events=new Ye,this.errorHandler=this.options.errorHandler||_F,this.navigated=!1,this.routeReuseStrategy=L(mF),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=L(Ua,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!L(pd,{optional:!0}),this.eventsSubscription=new ke,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(i!==null&&o!==null){if(this.stateManager.handleRouterEvent(r,o),r instanceof Bn&&r.code!==Vt.Redirect&&r.code!==Vt.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof Hn)this.navigated=!0;else if(r instanceof Bo){let s=r.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),u=$({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||gF(i.source)},s);this.scheduleNavigation(a,xa,null,u,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}DF(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),xa,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",r)},0)})}navigateToSyncWithBrowser(t,r,i){let o={replaceUrl:!0},s=i?.navigationId?i:null;if(i){let u=$({},i);delete u.navigationId,delete u.\u0275routerPageId,Object.keys(u).length!==0&&(o.state=u)}let a=this.parseUrl(t);this.scheduleNavigation(a,r,s,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(Mm),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:o,fragment:s,queryParamsHandling:a,preserveFragment:u}=r,l=u?this.currentUrlTree.fragment:s,h=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":h=$($({},this.currentUrlTree.queryParams),o);break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=o||null}h!==null&&(h=this.removeEmptyProps(h));let p;try{let m=i?i.snapshot:this.routerState.snapshot.root;p=CC(m)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),p=this.currentUrlTree.root}return bC(p,t,h,l??null)}navigateByUrl(t,r={skipLocationChange:!1}){let i=Na(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(o,xa,null,r)}navigate(t,r={skipLocationChange:!1}){return EF(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=$({},wF):r===!1?i=$({},IF):i=r,Na(t))return oC(this.currentUrlTree,t,i);let o=this.parseUrl(t);return oC(this.currentUrlTree,o,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,o])=>(o!=null&&(r[i]=o),r),{})}scheduleNavigation(t,r,i,o,s){if(this.disposed)return Promise.resolve(!1);let a,u,l;s?(a=s.resolve,u=s.reject,l=s.promise):l=new Promise((p,m)=>{a=p,u=m});let h=this.pendingTasks.add();return zC(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(h))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:o,resolve:a,reject:u,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(p=>Promise.reject(p))}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function EF(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new Q(4008,!1)}function DF(n){return!(n instanceof Oa)&&!(n instanceof Bo)}var fd=class{};var TF=(()=>{class n{constructor(t,r,i,o,s){this.router=t,this.injector=i,this.preloadingStrategy=o,this.loader=s}setUpPreloading(){this.subscription=this.router.events.pipe(Bt(t=>t instanceof Hn),Jr(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,r){let i=[];for(let o of r){o.providers&&!o._injector&&(o._injector=$l(o.providers,t,`Route: ${o.path}`));let s=o._injector??t,a=o._loadedInjector??s;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&i.push(this.preloadConfig(s,o)),(o.children||o._loadedRoutes)&&i.push(this.processRoutes(a,o.children??o._loadedRoutes))}return Me(i).pipe(ar())}preloadConfig(t,r){return this.preloadingStrategy.preload(r,()=>{let i;r.loadChildren&&r.canLoad===void 0?i=this.loader.loadChildren(t,r):i=J(null);let o=i.pipe(qe(s=>s===null?J(void 0):(r._loadedRoutes=s.routes,r._loadedInjector=s.injector,this.processRoutes(s.injector??t,s.routes))));if(r.loadComponent&&!r._loadedComponent){let s=this.loader.loadComponent(r);return Me([o,s]).pipe(ar())}else return o})}static{this.\u0275fac=function(r){return new(r||n)(Z(Ir),Z(Gl),Z(Ft),Z(fd),Z(Nm))}}static{this.\u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),GC=new Y(""),CF=(()=>{class n{constructor(t,r,i,o,s={}){this.urlSerializer=t,this.transitions=r,this.viewportScroller=i,this.zone=o,this.options=s,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},s.scrollPositionRestoration||="disabled",s.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Uo?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Hn?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof wr&&t.code===id.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof sd&&(t.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(t.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new sd(t,this.lastSource==="popstate"?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static{this.\u0275fac=function(r){KD()}}static{this.\u0275prov=K({token:n,factory:n.\u0275fac})}}return n})();function _8(n,...e){return mn([{provide:Ua,multi:!0,useValue:n},[],{provide:fi,useFactory:WC,deps:[Ir]},{provide:zl,multi:!0,useFactory:KC},e.map(t=>t.\u0275providers)])}function WC(n){return n.routerState.root}function Wa(n,e){return{\u0275kind:n,\u0275providers:e}}function KC(){let n=L(ht);return e=>{let t=n.get(ci);if(e!==t.components[0])return;let r=n.get(Ir),i=n.get(QC);n.get(Om)===1&&r.initialNavigation(),n.get(YC,null,ae.Optional)?.setUpPreloading(),n.get(GC,null,ae.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var QC=new Y("",{factory:()=>new Ye}),Om=new Y("",{providedIn:"root",factory:()=>1});function bF(){return Wa(2,[{provide:Om,useValue:0},{provide:ql,multi:!0,deps:[ht],useFactory:e=>{let t=e.get(GT,Promise.resolve());return()=>t.then(()=>new Promise(r=>{let i=e.get(Ir),o=e.get(QC);zC(i,()=>{r(!0)}),e.get(km).afterPreactivation=()=>(r(!0),o.closed?J(void 0):o),i.initialNavigation()}))}}])}function SF(){return Wa(3,[{provide:ql,multi:!0,useFactory:()=>{let e=L(Ir);return()=>{e.setUpLocationChangeListener()}}},{provide:Om,useValue:2}])}var YC=new Y("");function AF(n){return Wa(0,[{provide:YC,useExisting:TF},{provide:fd,useExisting:n}])}function RF(){return Wa(8,[cC,{provide:pd,useExisting:cC}])}function xF(n){let e=[{provide:$C,useValue:hF},{provide:HC,useValue:$({skipNextTransition:!!n?.skipInitialTransition},n)}];return Wa(9,e)}var fC=new Y("ROUTER_FORROOT_GUARD"),MF=[No,{provide:$a,useClass:jo},Ir,qa,{provide:fi,useFactory:WC,deps:[Ir]},Nm,[]],w8=(()=>{class n{constructor(t){}static forRoot(t,r){return{ngModule:n,providers:[MF,[],{provide:Ua,multi:!0,useValue:t},{provide:fC,useFactory:OF,deps:[[Ir,new ft,new Jp]]},{provide:Ga,useValue:r||{}},r?.useHash?PF():kF(),NF(),r?.preloadingStrategy?AF(r.preloadingStrategy).\u0275providers:[],r?.initialNavigation?FF(r):[],r?.bindToComponentInputs?RF().\u0275providers:[],r?.enableViewTransitions?xF().\u0275providers:[],LF()]}}static forChild(t){return{ngModule:n,providers:[{provide:Ua,multi:!0,useValue:t}]}}static{this.\u0275fac=function(r){return new(r||n)(Z(fC,8))}}static{this.\u0275mod=_a({type:n})}static{this.\u0275inj=ya({})}}return n})();function NF(){return{provide:GC,useFactory:()=>{let n=L(YT),e=L(ve),t=L(Ga),r=L(km),i=L($a);return t.scrollOffset&&n.setOffset(t.scrollOffset),new CF(i,r,n,e,t)}}}function PF(){return{provide:li,useClass:KT}}function kF(){return{provide:li,useClass:qg}}function OF(n){return"guarded"}function FF(n){return[n.initialNavigation==="disabled"?SF().\u0275providers:[],n.initialNavigation==="enabledBlocking"?bF().\u0275providers:[]]}var pC=new Y("");function LF(){return[{provide:pC,useFactory:KC},{provide:zl,multi:!0,useExisting:pC}]}var VF="firebase",jF="10.14.1";ot(VF,jF,"app");var Dr=new vr("ANGULARFIRE2_VERSION");function Ka(n,e,t){if(e){if(e.length===1)return e[0];let o=e.filter(s=>s.app===t);if(o.length===1)return o[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var zo=(n,e)=>{let t=e?[e]:dc(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(s=>{r.includes(s)||r.push(s)})}),r},gi=class{constructor(){return zo(UF)}},UF="app-check";function qo(){}var md=class{zone;delegate;constructor(e,t=Vf){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,o=function(s){i.runGuarded(()=>{e.apply(this,[s])})};return this.delegate.schedule(o,t,r)}},Fm=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",qo,{},qo,qo)),t.pipe(Je({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},mi=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new md(Zone.current)),this.insideAngular=t.run(()=>new md(Zone.current,Lf)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(Z(ve))};static \u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function yd(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function BF(n){return yd().ngZone.runOutsideAngular(()=>n())}function pi(n){return yd().ngZone.run(()=>n())}function $F(n){return HF(yd())(n)}function HF(n){return function(t){return t=t.lift(new Fm(n.ngZone)),t.pipe(sr(n.outsideAngular),or(n.insideAngular))}}var qF=(n,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),pi(()=>n.apply(void 0,r))},Le=(n,e)=>function(){let t,r=arguments;for(let o=0;o<arguments.length;o++)typeof r[o]=="function"&&(e&&(t||=pi(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",qo,{},qo,qo))),r[o]=qF(r[o],t));let i=BF(()=>n.apply(this,r));if(!e)if(i instanceof he){let o=yd();return i.pipe(sr(o.outsideAngular),or(o.insideAngular))}else return pi(()=>i);return i instanceof he?i.pipe($F):i instanceof Promise?pi(()=>new Promise((o,s)=>i.then(a=>pi(()=>o(a)),a=>pi(()=>s(a))))):typeof i=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),i.apply(this,arguments)}:pi(()=>i)};var qn=class{constructor(e){return e}},yi=class{constructor(){return dc()}};function zF(n){return n&&n.length===1?n[0]:new qn(zi())}var Lm=new Y("angularfire2._apps"),GF={provide:qn,useFactory:zF,deps:[[new ft,Lm]]},WF={provide:yi,deps:[[new ft,Lm]]};function KF(n){return(e,t)=>{let r=t.get(vn);ot("angularfire",Dr.full,"core"),ot("angularfire",Dr.full,"app"),ot("angular",MT.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new qn(i)}}function B8(n,...e){return mn([GF,WF,{provide:Lm,useFactory:KF(n),multi:!0,deps:[ve,ht,mi,...e]}])}var $8=Le(Kw,!0);var ZC="auth",vi=class{constructor(e){return e}},Qa=class{constructor(){return zo(ZC)}};var Vm=new Y("angularfire2.auth-instances");function qL(n,e){let t=Ka(ZC,n,e);return t&&new vi(t)}function zL(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new vi(r)}}var GL={provide:Qa,deps:[[new ft,Vm]]},WL={provide:vi,useFactory:qL,deps:[[new ft,Vm],qn]};function O6(n,...e){return ot("angularfire",Dr.full,"auth"),mn([WL,GL,{provide:Vm,useFactory:zL(n),multi:!0,deps:[ve,ht,mi,yi,[new ft,gi],...e]}])}var JC=Le(mf,!0);var F6=Le(wf,!0);var XC=Le(vf,!0);var eb=Le(yf,!0);var tb=Le(_f,!0);var nb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},rb={};var Tr,jm;(function(){var n;function e(I,v){function w(){}w.prototype=v.prototype,I.D=v.prototype,I.prototype=new w,I.prototype.constructor=I,I.C=function(E,T,b){for(var _=Array(arguments.length-2),Rn=2;Rn<arguments.length;Rn++)_[Rn-2]=arguments[Rn];return v.prototype[T].apply(E,_)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,v,w){w||(w=0);var E=Array(16);if(typeof v=="string")for(var T=0;16>T;++T)E[T]=v.charCodeAt(w++)|v.charCodeAt(w++)<<8|v.charCodeAt(w++)<<16|v.charCodeAt(w++)<<24;else for(T=0;16>T;++T)E[T]=v[w++]|v[w++]<<8|v[w++]<<16|v[w++]<<24;v=I.g[0],w=I.g[1],T=I.g[2];var b=I.g[3],_=v+(b^w&(T^b))+E[0]+3614090360&4294967295;v=w+(_<<7&4294967295|_>>>25),_=b+(T^v&(w^T))+E[1]+3905402710&4294967295,b=v+(_<<12&4294967295|_>>>20),_=T+(w^b&(v^w))+E[2]+606105819&4294967295,T=b+(_<<17&4294967295|_>>>15),_=w+(v^T&(b^v))+E[3]+3250441966&4294967295,w=T+(_<<22&4294967295|_>>>10),_=v+(b^w&(T^b))+E[4]+4118548399&4294967295,v=w+(_<<7&4294967295|_>>>25),_=b+(T^v&(w^T))+E[5]+1200080426&4294967295,b=v+(_<<12&4294967295|_>>>20),_=T+(w^b&(v^w))+E[6]+2821735955&4294967295,T=b+(_<<17&4294967295|_>>>15),_=w+(v^T&(b^v))+E[7]+4249261313&4294967295,w=T+(_<<22&4294967295|_>>>10),_=v+(b^w&(T^b))+E[8]+1770035416&4294967295,v=w+(_<<7&4294967295|_>>>25),_=b+(T^v&(w^T))+E[9]+2336552879&4294967295,b=v+(_<<12&4294967295|_>>>20),_=T+(w^b&(v^w))+E[10]+4294925233&4294967295,T=b+(_<<17&4294967295|_>>>15),_=w+(v^T&(b^v))+E[11]+2304563134&4294967295,w=T+(_<<22&4294967295|_>>>10),_=v+(b^w&(T^b))+E[12]+1804603682&4294967295,v=w+(_<<7&4294967295|_>>>25),_=b+(T^v&(w^T))+E[13]+4254626195&4294967295,b=v+(_<<12&4294967295|_>>>20),_=T+(w^b&(v^w))+E[14]+2792965006&4294967295,T=b+(_<<17&4294967295|_>>>15),_=w+(v^T&(b^v))+E[15]+1236535329&4294967295,w=T+(_<<22&4294967295|_>>>10),_=v+(T^b&(w^T))+E[1]+4129170786&4294967295,v=w+(_<<5&4294967295|_>>>27),_=b+(w^T&(v^w))+E[6]+3225465664&4294967295,b=v+(_<<9&4294967295|_>>>23),_=T+(v^w&(b^v))+E[11]+643717713&4294967295,T=b+(_<<14&4294967295|_>>>18),_=w+(b^v&(T^b))+E[0]+3921069994&4294967295,w=T+(_<<20&4294967295|_>>>12),_=v+(T^b&(w^T))+E[5]+3593408605&4294967295,v=w+(_<<5&4294967295|_>>>27),_=b+(w^T&(v^w))+E[10]+38016083&4294967295,b=v+(_<<9&4294967295|_>>>23),_=T+(v^w&(b^v))+E[15]+3634488961&4294967295,T=b+(_<<14&4294967295|_>>>18),_=w+(b^v&(T^b))+E[4]+3889429448&4294967295,w=T+(_<<20&4294967295|_>>>12),_=v+(T^b&(w^T))+E[9]+568446438&4294967295,v=w+(_<<5&4294967295|_>>>27),_=b+(w^T&(v^w))+E[14]+3275163606&4294967295,b=v+(_<<9&4294967295|_>>>23),_=T+(v^w&(b^v))+E[3]+4107603335&4294967295,T=b+(_<<14&4294967295|_>>>18),_=w+(b^v&(T^b))+E[8]+1163531501&4294967295,w=T+(_<<20&4294967295|_>>>12),_=v+(T^b&(w^T))+E[13]+2850285829&4294967295,v=w+(_<<5&4294967295|_>>>27),_=b+(w^T&(v^w))+E[2]+4243563512&4294967295,b=v+(_<<9&4294967295|_>>>23),_=T+(v^w&(b^v))+E[7]+1735328473&4294967295,T=b+(_<<14&4294967295|_>>>18),_=w+(b^v&(T^b))+E[12]+2368359562&4294967295,w=T+(_<<20&4294967295|_>>>12),_=v+(w^T^b)+E[5]+4294588738&4294967295,v=w+(_<<4&4294967295|_>>>28),_=b+(v^w^T)+E[8]+2272392833&4294967295,b=v+(_<<11&4294967295|_>>>21),_=T+(b^v^w)+E[11]+1839030562&4294967295,T=b+(_<<16&4294967295|_>>>16),_=w+(T^b^v)+E[14]+4259657740&4294967295,w=T+(_<<23&4294967295|_>>>9),_=v+(w^T^b)+E[1]+2763975236&4294967295,v=w+(_<<4&4294967295|_>>>28),_=b+(v^w^T)+E[4]+1272893353&4294967295,b=v+(_<<11&4294967295|_>>>21),_=T+(b^v^w)+E[7]+4139469664&4294967295,T=b+(_<<16&4294967295|_>>>16),_=w+(T^b^v)+E[10]+3200236656&4294967295,w=T+(_<<23&4294967295|_>>>9),_=v+(w^T^b)+E[13]+681279174&4294967295,v=w+(_<<4&4294967295|_>>>28),_=b+(v^w^T)+E[0]+3936430074&4294967295,b=v+(_<<11&4294967295|_>>>21),_=T+(b^v^w)+E[3]+3572445317&4294967295,T=b+(_<<16&4294967295|_>>>16),_=w+(T^b^v)+E[6]+76029189&4294967295,w=T+(_<<23&4294967295|_>>>9),_=v+(w^T^b)+E[9]+3654602809&4294967295,v=w+(_<<4&4294967295|_>>>28),_=b+(v^w^T)+E[12]+3873151461&4294967295,b=v+(_<<11&4294967295|_>>>21),_=T+(b^v^w)+E[15]+530742520&4294967295,T=b+(_<<16&4294967295|_>>>16),_=w+(T^b^v)+E[2]+3299628645&4294967295,w=T+(_<<23&4294967295|_>>>9),_=v+(T^(w|~b))+E[0]+4096336452&4294967295,v=w+(_<<6&4294967295|_>>>26),_=b+(w^(v|~T))+E[7]+1126891415&4294967295,b=v+(_<<10&4294967295|_>>>22),_=T+(v^(b|~w))+E[14]+2878612391&4294967295,T=b+(_<<15&4294967295|_>>>17),_=w+(b^(T|~v))+E[5]+4237533241&4294967295,w=T+(_<<21&4294967295|_>>>11),_=v+(T^(w|~b))+E[12]+1700485571&4294967295,v=w+(_<<6&4294967295|_>>>26),_=b+(w^(v|~T))+E[3]+2399980690&4294967295,b=v+(_<<10&4294967295|_>>>22),_=T+(v^(b|~w))+E[10]+4293915773&4294967295,T=b+(_<<15&4294967295|_>>>17),_=w+(b^(T|~v))+E[1]+2240044497&4294967295,w=T+(_<<21&4294967295|_>>>11),_=v+(T^(w|~b))+E[8]+1873313359&4294967295,v=w+(_<<6&4294967295|_>>>26),_=b+(w^(v|~T))+E[15]+4264355552&4294967295,b=v+(_<<10&4294967295|_>>>22),_=T+(v^(b|~w))+E[6]+2734768916&4294967295,T=b+(_<<15&4294967295|_>>>17),_=w+(b^(T|~v))+E[13]+1309151649&4294967295,w=T+(_<<21&4294967295|_>>>11),_=v+(T^(w|~b))+E[4]+4149444226&4294967295,v=w+(_<<6&4294967295|_>>>26),_=b+(w^(v|~T))+E[11]+3174756917&4294967295,b=v+(_<<10&4294967295|_>>>22),_=T+(v^(b|~w))+E[2]+718787259&4294967295,T=b+(_<<15&4294967295|_>>>17),_=w+(b^(T|~v))+E[9]+3951481745&4294967295,I.g[0]=I.g[0]+v&4294967295,I.g[1]=I.g[1]+(T+(_<<21&4294967295|_>>>11))&4294967295,I.g[2]=I.g[2]+T&4294967295,I.g[3]=I.g[3]+b&4294967295}r.prototype.u=function(I,v){v===void 0&&(v=I.length);for(var w=v-this.blockSize,E=this.B,T=this.h,b=0;b<v;){if(T==0)for(;b<=w;)i(this,I,b),b+=this.blockSize;if(typeof I=="string"){for(;b<v;)if(E[T++]=I.charCodeAt(b++),T==this.blockSize){i(this,E),T=0;break}}else for(;b<v;)if(E[T++]=I[b++],T==this.blockSize){i(this,E),T=0;break}}this.h=T,this.o+=v},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var v=1;v<I.length-8;++v)I[v]=0;var w=8*this.o;for(v=I.length-8;v<I.length;++v)I[v]=w&255,w/=256;for(this.u(I),I=Array(16),v=w=0;4>v;++v)for(var E=0;32>E;E+=8)I[w++]=this.g[v]>>>E&255;return I};function o(I,v){var w=a;return Object.prototype.hasOwnProperty.call(w,I)?w[I]:w[I]=v(I)}function s(I,v){this.h=v;for(var w=[],E=!0,T=I.length-1;0<=T;T--){var b=I[T]|0;E&&b==v||(w[T]=b,E=!1)}this.g=w}var a={};function u(I){return-128<=I&&128>I?o(I,function(v){return new s([v|0],0>v?-1:0)}):new s([I|0],0>I?-1:0)}function l(I){if(isNaN(I)||!isFinite(I))return p;if(0>I)return S(l(-I));for(var v=[],w=1,E=0;I>=w;E++)v[E]=I/w|0,w*=4294967296;return new s(v,0)}function h(I,v){if(I.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(I.charAt(0)=="-")return S(h(I.substring(1),v));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var w=l(Math.pow(v,8)),E=p,T=0;T<I.length;T+=8){var b=Math.min(8,I.length-T),_=parseInt(I.substring(T,T+b),v);8>b?(b=l(Math.pow(v,b)),E=E.j(b).add(l(_))):(E=E.j(w),E=E.add(l(_)))}return E}var p=u(0),m=u(1),y=u(16777216);n=s.prototype,n.m=function(){if(R(this))return-S(this).m();for(var I=0,v=1,w=0;w<this.g.length;w++){var E=this.i(w);I+=(0<=E?E:4294967296+E)*v,v*=4294967296}return I},n.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(D(this))return"0";if(R(this))return"-"+S(this).toString(I);for(var v=l(Math.pow(I,6)),w=this,E="";;){var T=q(w,v).g;w=O(w,T.j(v));var b=((0<w.g.length?w.g[0]:w.h)>>>0).toString(I);if(w=T,D(w))return b+E;for(;6>b.length;)b="0"+b;E=b+E}},n.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function D(I){if(I.h!=0)return!1;for(var v=0;v<I.g.length;v++)if(I.g[v]!=0)return!1;return!0}function R(I){return I.h==-1}n.l=function(I){return I=O(this,I),R(I)?-1:D(I)?0:1};function S(I){for(var v=I.g.length,w=[],E=0;E<v;E++)w[E]=~I.g[E];return new s(w,~I.h).add(m)}n.abs=function(){return R(this)?S(this):this},n.add=function(I){for(var v=Math.max(this.g.length,I.g.length),w=[],E=0,T=0;T<=v;T++){var b=E+(this.i(T)&65535)+(I.i(T)&65535),_=(b>>>16)+(this.i(T)>>>16)+(I.i(T)>>>16);E=_>>>16,b&=65535,_&=65535,w[T]=_<<16|b}return new s(w,w[w.length-1]&-2147483648?-1:0)};function O(I,v){return I.add(S(v))}n.j=function(I){if(D(this)||D(I))return p;if(R(this))return R(I)?S(this).j(S(I)):S(S(this).j(I));if(R(I))return S(this.j(S(I)));if(0>this.l(y)&&0>I.l(y))return l(this.m()*I.m());for(var v=this.g.length+I.g.length,w=[],E=0;E<2*v;E++)w[E]=0;for(E=0;E<this.g.length;E++)for(var T=0;T<I.g.length;T++){var b=this.i(E)>>>16,_=this.i(E)&65535,Rn=I.i(T)>>>16,Os=I.i(T)&65535;w[2*E+2*T]+=_*Os,U(w,2*E+2*T),w[2*E+2*T+1]+=b*Os,U(w,2*E+2*T+1),w[2*E+2*T+1]+=_*Rn,U(w,2*E+2*T+1),w[2*E+2*T+2]+=b*Rn,U(w,2*E+2*T+2)}for(E=0;E<v;E++)w[E]=w[2*E+1]<<16|w[2*E];for(E=v;E<2*v;E++)w[E]=0;return new s(w,0)};function U(I,v){for(;(I[v]&65535)!=I[v];)I[v+1]+=I[v]>>>16,I[v]&=65535,v++}function V(I,v){this.g=I,this.h=v}function q(I,v){if(D(v))throw Error("division by zero");if(D(I))return new V(p,p);if(R(I))return v=q(S(I),v),new V(S(v.g),S(v.h));if(R(v))return v=q(I,S(v)),new V(S(v.g),v.h);if(30<I.g.length){if(R(I)||R(v))throw Error("slowDivide_ only works with positive integers.");for(var w=m,E=v;0>=E.l(I);)w=re(w),E=re(E);var T=G(w,1),b=G(E,1);for(E=G(E,2),w=G(w,2);!D(E);){var _=b.add(E);0>=_.l(I)&&(T=T.add(w),b=_),E=G(E,1),w=G(w,1)}return v=O(I,T.j(v)),new V(T,v)}for(T=p;0<=I.l(v);){for(w=Math.max(1,Math.floor(I.m()/v.m())),E=Math.ceil(Math.log(w)/Math.LN2),E=48>=E?1:Math.pow(2,E-48),b=l(w),_=b.j(v);R(_)||0<_.l(I);)w-=E,b=l(w),_=b.j(v);D(b)&&(b=m),T=T.add(b),I=O(I,_)}return new V(T,I)}n.A=function(I){return q(this,I).h},n.and=function(I){for(var v=Math.max(this.g.length,I.g.length),w=[],E=0;E<v;E++)w[E]=this.i(E)&I.i(E);return new s(w,this.h&I.h)},n.or=function(I){for(var v=Math.max(this.g.length,I.g.length),w=[],E=0;E<v;E++)w[E]=this.i(E)|I.i(E);return new s(w,this.h|I.h)},n.xor=function(I){for(var v=Math.max(this.g.length,I.g.length),w=[],E=0;E<v;E++)w[E]=this.i(E)^I.i(E);return new s(w,this.h^I.h)};function re(I){for(var v=I.g.length+1,w=[],E=0;E<v;E++)w[E]=I.i(E)<<1|I.i(E-1)>>>31;return new s(w,I.h)}function G(I,v){var w=v>>5;v%=32;for(var E=I.g.length-w,T=[],b=0;b<E;b++)T[b]=0<v?I.i(b+w)>>>v|I.i(b+w+1)<<32-v:I.i(b+w);return new s(T,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,jm=rb.Md5=r,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=l,s.fromString=h,Tr=rb.Integer=s}).apply(typeof nb<"u"?nb:typeof self<"u"?self:typeof window<"u"?window:{});var vd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},zn={};var Um,QL,Go,Bm,Ya,_d,$m,Hm,qm;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,d,f){return c==Array.prototype||c==Object.prototype||(c[d]=f.value),c};function t(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof vd=="object"&&vd];for(var d=0;d<c.length;++d){var f=c[d];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=t(this);function i(c,d){if(d)e:{var f=r;c=c.split(".");for(var g=0;g<c.length-1;g++){var C=c[g];if(!(C in f))break e;f=f[C]}c=c[c.length-1],g=f[c],d=d(g),d!=g&&d!=null&&e(f,c,{configurable:!0,writable:!0,value:d})}}function o(c,d){c instanceof String&&(c+="");var f=0,g=!1,C={next:function(){if(!g&&f<c.length){var M=f++;return{value:d(M,c[M]),done:!1}}return g=!0,{done:!0,value:void 0}}};return C[Symbol.iterator]=function(){return C},C}i("Array.prototype.values",function(c){return c||function(){return o(this,function(d,f){return f})}});var s=s||{},a=this||self;function u(c){var d=typeof c;return d=d!="object"?d:c?Array.isArray(c)?"array":d:"null",d=="array"||d=="object"&&typeof c.length=="number"}function l(c){var d=typeof c;return d=="object"&&c!=null||d=="function"}function h(c,d,f){return c.call.apply(c.bind,arguments)}function p(c,d,f){if(!c)throw Error();if(2<arguments.length){var g=Array.prototype.slice.call(arguments,2);return function(){var C=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(C,g),c.apply(d,C)}}return function(){return c.apply(d,arguments)}}function m(c,d,f){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:p,m.apply(null,arguments)}function y(c,d){var f=Array.prototype.slice.call(arguments,1);return function(){var g=f.slice();return g.push.apply(g,arguments),c.apply(this,g)}}function D(c,d){function f(){}f.prototype=d.prototype,c.aa=d.prototype,c.prototype=new f,c.prototype.constructor=c,c.Qb=function(g,C,M){for(var F=Array(arguments.length-2),Ee=2;Ee<arguments.length;Ee++)F[Ee-2]=arguments[Ee];return d.prototype[C].apply(g,F)}}function R(c){let d=c.length;if(0<d){let f=Array(d);for(let g=0;g<d;g++)f[g]=c[g];return f}return[]}function S(c,d){for(let f=1;f<arguments.length;f++){let g=arguments[f];if(u(g)){let C=c.length||0,M=g.length||0;c.length=C+M;for(let F=0;F<M;F++)c[C+F]=g[F]}else c.push(g)}}class O{constructor(d,f){this.i=d,this.j=f,this.h=0,this.g=null}get(){let d;return 0<this.h?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function U(c){return/^[\s\xa0]*$/.test(c)}function V(){var c=a.navigator;return c&&(c=c.userAgent)?c:""}function q(c){return q[" "](c),c}q[" "]=function(){};var re=V().indexOf("Gecko")!=-1&&!(V().toLowerCase().indexOf("webkit")!=-1&&V().indexOf("Edge")==-1)&&!(V().indexOf("Trident")!=-1||V().indexOf("MSIE")!=-1)&&V().indexOf("Edge")==-1;function G(c,d,f){for(let g in c)d.call(f,c[g],g,c)}function I(c,d){for(let f in c)d.call(void 0,c[f],f,c)}function v(c){let d={};for(let f in c)d[f]=c[f];return d}let w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function E(c,d){let f,g;for(let C=1;C<arguments.length;C++){g=arguments[C];for(f in g)c[f]=g[f];for(let M=0;M<w.length;M++)f=w[M],Object.prototype.hasOwnProperty.call(g,f)&&(c[f]=g[f])}}function T(c){var d=1;c=c.split(":");let f=[];for(;0<d&&c.length;)f.push(c.shift()),d--;return c.length&&f.push(c.join(":")),f}function b(c){a.setTimeout(()=>{throw c},0)}function _(){var c=Bh;let d=null;return c.g&&(d=c.g,c.g=c.g.next,c.g||(c.h=null),d.next=null),d}class Rn{constructor(){this.h=this.g=null}add(d,f){let g=Os.get();g.set(d,f),this.h?this.h.next=g:this.g=g,this.h=g}}var Os=new O(()=>new OA,c=>c.reset());class OA{constructor(){this.next=this.g=this.h=null}set(d,f){this.h=d,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let Fs,Ls=!1,Bh=new Rn,$_=()=>{let c=a.Promise.resolve(void 0);Fs=()=>{c.then(FA)}};var FA=()=>{for(var c;c=_();){try{c.h.call(c.g)}catch(f){b(f)}var d=Os;d.j(c),100>d.h&&(d.h++,c.next=d.g,d.g=c)}Ls=!1};function tr(){this.s=this.s,this.C=this.C}tr.prototype.s=!1,tr.prototype.ma=function(){this.s||(this.s=!0,this.N())},tr.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ut(c,d){this.type=c,this.g=this.target=d,this.defaultPrevented=!1}ut.prototype.h=function(){this.defaultPrevented=!0};var LA=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var c=!1,d=Object.defineProperty({},"passive",{get:function(){c=!0}});try{let f=()=>{};a.addEventListener("test",f,d),a.removeEventListener("test",f,d)}catch{}return c}();function Vs(c,d){if(ut.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var f=this.type=c.type,g=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=d,d=c.relatedTarget){if(re){e:{try{q(d.nodeName);var C=!0;break e}catch{}C=!1}C||(d=null)}}else f=="mouseover"?d=c.fromElement:f=="mouseout"&&(d=c.toElement);this.relatedTarget=d,g?(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:VA[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&Vs.aa.h.call(this)}}D(Vs,ut);var VA={2:"touch",3:"pen",4:"mouse"};Vs.prototype.h=function(){Vs.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var js="closure_listenable_"+(1e6*Math.random()|0),jA=0;function UA(c,d,f,g,C){this.listener=c,this.proxy=null,this.src=d,this.type=f,this.capture=!!g,this.ha=C,this.key=++jA,this.da=this.fa=!1}function Uu(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function Bu(c){this.src=c,this.g={},this.h=0}Bu.prototype.add=function(c,d,f,g,C){var M=c.toString();c=this.g[M],c||(c=this.g[M]=[],this.h++);var F=Hh(c,d,g,C);return-1<F?(d=c[F],f||(d.fa=!1)):(d=new UA(d,this.src,M,!!g,C),d.fa=f,c.push(d)),d};function $h(c,d){var f=d.type;if(f in c.g){var g=c.g[f],C=Array.prototype.indexOf.call(g,d,void 0),M;(M=0<=C)&&Array.prototype.splice.call(g,C,1),M&&(Uu(d),c.g[f].length==0&&(delete c.g[f],c.h--))}}function Hh(c,d,f,g){for(var C=0;C<c.length;++C){var M=c[C];if(!M.da&&M.listener==d&&M.capture==!!f&&M.ha==g)return C}return-1}var qh="closure_lm_"+(1e6*Math.random()|0),zh={};function H_(c,d,f,g,C){if(g&&g.once)return z_(c,d,f,g,C);if(Array.isArray(d)){for(var M=0;M<d.length;M++)H_(c,d[M],f,g,C);return null}return f=Qh(f),c&&c[js]?c.K(d,f,l(g)?!!g.capture:!!g,C):q_(c,d,f,!1,g,C)}function q_(c,d,f,g,C,M){if(!d)throw Error("Invalid event type");var F=l(C)?!!C.capture:!!C,Ee=Wh(c);if(Ee||(c[qh]=Ee=new Bu(c)),f=Ee.add(d,f,g,F,M),f.proxy)return f;if(g=BA(),f.proxy=g,g.src=c,g.listener=f,c.addEventListener)LA||(C=F),C===void 0&&(C=!1),c.addEventListener(d.toString(),g,C);else if(c.attachEvent)c.attachEvent(W_(d.toString()),g);else if(c.addListener&&c.removeListener)c.addListener(g);else throw Error("addEventListener and attachEvent are unavailable.");return f}function BA(){function c(f){return d.call(c.src,c.listener,f)}let d=$A;return c}function z_(c,d,f,g,C){if(Array.isArray(d)){for(var M=0;M<d.length;M++)z_(c,d[M],f,g,C);return null}return f=Qh(f),c&&c[js]?c.L(d,f,l(g)?!!g.capture:!!g,C):q_(c,d,f,!0,g,C)}function G_(c,d,f,g,C){if(Array.isArray(d))for(var M=0;M<d.length;M++)G_(c,d[M],f,g,C);else g=l(g)?!!g.capture:!!g,f=Qh(f),c&&c[js]?(c=c.i,d=String(d).toString(),d in c.g&&(M=c.g[d],f=Hh(M,f,g,C),-1<f&&(Uu(M[f]),Array.prototype.splice.call(M,f,1),M.length==0&&(delete c.g[d],c.h--)))):c&&(c=Wh(c))&&(d=c.g[d.toString()],c=-1,d&&(c=Hh(d,f,g,C)),(f=-1<c?d[c]:null)&&Gh(f))}function Gh(c){if(typeof c!="number"&&c&&!c.da){var d=c.src;if(d&&d[js])$h(d.i,c);else{var f=c.type,g=c.proxy;d.removeEventListener?d.removeEventListener(f,g,c.capture):d.detachEvent?d.detachEvent(W_(f),g):d.addListener&&d.removeListener&&d.removeListener(g),(f=Wh(d))?($h(f,c),f.h==0&&(f.src=null,d[qh]=null)):Uu(c)}}}function W_(c){return c in zh?zh[c]:zh[c]="on"+c}function $A(c,d){if(c.da)c=!0;else{d=new Vs(d,this);var f=c.listener,g=c.ha||c.src;c.fa&&Gh(c),c=f.call(g,d)}return c}function Wh(c){return c=c[qh],c instanceof Bu?c:null}var Kh="__closure_events_fn_"+(1e9*Math.random()>>>0);function Qh(c){return typeof c=="function"?c:(c[Kh]||(c[Kh]=function(d){return c.handleEvent(d)}),c[Kh])}function ct(){tr.call(this),this.i=new Bu(this),this.M=this,this.F=null}D(ct,tr),ct.prototype[js]=!0,ct.prototype.removeEventListener=function(c,d,f,g){G_(this,c,d,f,g)};function mt(c,d){var f,g=c.F;if(g)for(f=[];g;g=g.F)f.push(g);if(c=c.M,g=d.type||d,typeof d=="string")d=new ut(d,c);else if(d instanceof ut)d.target=d.target||c;else{var C=d;d=new ut(g,c),E(d,C)}if(C=!0,f)for(var M=f.length-1;0<=M;M--){var F=d.g=f[M];C=$u(F,g,!0,d)&&C}if(F=d.g=c,C=$u(F,g,!0,d)&&C,C=$u(F,g,!1,d)&&C,f)for(M=0;M<f.length;M++)F=d.g=f[M],C=$u(F,g,!1,d)&&C}ct.prototype.N=function(){if(ct.aa.N.call(this),this.i){var c=this.i,d;for(d in c.g){for(var f=c.g[d],g=0;g<f.length;g++)Uu(f[g]);delete c.g[d],c.h--}}this.F=null},ct.prototype.K=function(c,d,f,g){return this.i.add(String(c),d,!1,f,g)},ct.prototype.L=function(c,d,f,g){return this.i.add(String(c),d,!0,f,g)};function $u(c,d,f,g){if(d=c.i.g[String(d)],!d)return!0;d=d.concat();for(var C=!0,M=0;M<d.length;++M){var F=d[M];if(F&&!F.da&&F.capture==f){var Ee=F.listener,it=F.ha||F.src;F.fa&&$h(c.i,F),C=Ee.call(it,g)!==!1&&C}}return C&&!g.defaultPrevented}function K_(c,d,f){if(typeof c=="function")f&&(c=m(c,f));else if(c&&typeof c.handleEvent=="function")c=m(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(d)?-1:a.setTimeout(c,d||0)}function Q_(c){c.g=K_(()=>{c.g=null,c.i&&(c.i=!1,Q_(c))},c.l);let d=c.h;c.h=null,c.m.apply(null,d)}class HA extends tr{constructor(d,f){super(),this.m=d,this.l=f,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:Q_(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Us(c){tr.call(this),this.h=c,this.g={}}D(Us,tr);var Y_=[];function Z_(c){G(c.g,function(d,f){this.g.hasOwnProperty(f)&&Gh(d)},c),c.g={}}Us.prototype.N=function(){Us.aa.N.call(this),Z_(this)},Us.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Yh=a.JSON.stringify,qA=a.JSON.parse,zA=class{stringify(c){return a.JSON.stringify(c,void 0)}parse(c){return a.JSON.parse(c,void 0)}};function Zh(){}Zh.prototype.h=null;function J_(c){return c.h||(c.h=c.i())}function X_(){}var Bs={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Jh(){ut.call(this,"d")}D(Jh,ut);function Xh(){ut.call(this,"c")}D(Xh,ut);var zr={},ew=null;function Hu(){return ew=ew||new ct}zr.La="serverreachability";function tw(c){ut.call(this,zr.La,c)}D(tw,ut);function $s(c){let d=Hu();mt(d,new tw(d))}zr.STAT_EVENT="statevent";function nw(c,d){ut.call(this,zr.STAT_EVENT,c),this.stat=d}D(nw,ut);function yt(c){let d=Hu();mt(d,new nw(d,c))}zr.Ma="timingevent";function rw(c,d){ut.call(this,zr.Ma,c),this.size=d}D(rw,ut);function Hs(c,d){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){c()},d)}function qs(){this.g=!0}qs.prototype.xa=function(){this.g=!1};function GA(c,d,f,g,C,M){c.info(function(){if(c.g)if(M)for(var F="",Ee=M.split("&"),it=0;it<Ee.length;it++){var me=Ee[it].split("=");if(1<me.length){var lt=me[0];me=me[1];var dt=lt.split("_");F=2<=dt.length&&dt[1]=="type"?F+(lt+"="+me+"&"):F+(lt+"=redacted&")}}else F=null;else F=M;return"XMLHTTP REQ ("+g+") [attempt "+C+"]: "+d+`
`+f+`
`+F})}function WA(c,d,f,g,C,M,F){c.info(function(){return"XMLHTTP RESP ("+g+") [ attempt "+C+"]: "+d+`
`+f+`
`+M+" "+F})}function Bi(c,d,f,g){c.info(function(){return"XMLHTTP TEXT ("+d+"): "+QA(c,f)+(g?" "+g:"")})}function KA(c,d){c.info(function(){return"TIMEOUT: "+d})}qs.prototype.info=function(){};function QA(c,d){if(!c.g)return d;if(!d)return null;try{var f=JSON.parse(d);if(f){for(c=0;c<f.length;c++)if(Array.isArray(f[c])){var g=f[c];if(!(2>g.length)){var C=g[1];if(Array.isArray(C)&&!(1>C.length)){var M=C[0];if(M!="noop"&&M!="stop"&&M!="close")for(var F=1;F<C.length;F++)C[F]=""}}}}return Yh(f)}catch{return d}}var qu={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},iw={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ef;function zu(){}D(zu,Zh),zu.prototype.g=function(){return new XMLHttpRequest},zu.prototype.i=function(){return{}},ef=new zu;function nr(c,d,f,g){this.j=c,this.i=d,this.l=f,this.R=g||1,this.U=new Us(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ow}function ow(){this.i=null,this.g="",this.h=!1}var sw={},tf={};function nf(c,d,f){c.L=1,c.v=Qu(xn(d)),c.m=f,c.P=!0,aw(c,null)}function aw(c,d){c.F=Date.now(),Gu(c),c.A=xn(c.v);var f=c.A,g=c.R;Array.isArray(g)||(g=[String(g)]),Iw(f.i,"t",g),c.C=0,f=c.j.J,c.h=new ow,c.g=jw(c.j,f?d:null,!c.m),0<c.O&&(c.M=new HA(m(c.Y,c,c.g),c.O)),d=c.U,f=c.g,g=c.ca;var C="readystatechange";Array.isArray(C)||(C&&(Y_[0]=C.toString()),C=Y_);for(var M=0;M<C.length;M++){var F=H_(f,C[M],g||d.handleEvent,!1,d.h||d);if(!F)break;d.g[F.key]=F}d=c.H?v(c.H):{},c.m?(c.u||(c.u="POST"),d["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,d)):(c.u="GET",c.g.ea(c.A,c.u,null,d)),$s(),GA(c.i,c.u,c.A,c.l,c.R,c.m)}nr.prototype.ca=function(c){c=c.target;let d=this.M;d&&Mn(c)==3?d.j():this.Y(c)},nr.prototype.Y=function(c){try{if(c==this.g)e:{let dt=Mn(this.g);var d=this.g.Ba();let qi=this.g.Z();if(!(3>dt)&&(dt!=3||this.g&&(this.h.h||this.g.oa()||Aw(this.g)))){this.J||dt!=4||d==7||(d==8||0>=qi?$s(3):$s(2)),rf(this);var f=this.g.Z();this.X=f;t:if(uw(this)){var g=Aw(this.g);c="";var C=g.length,M=Mn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Gr(this),zs(this);var F="";break t}this.h.i=new a.TextDecoder}for(d=0;d<C;d++)this.h.h=!0,c+=this.h.i.decode(g[d],{stream:!(M&&d==C-1)});g.length=0,this.h.g+=c,this.C=0,F=this.h.g}else F=this.g.oa();if(this.o=f==200,WA(this.i,this.u,this.A,this.l,this.R,dt,f),this.o){if(this.T&&!this.K){t:{if(this.g){var Ee,it=this.g;if((Ee=it.g?it.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!U(Ee)){var me=Ee;break t}}me=null}if(f=me)Bi(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,of(this,f);else{this.o=!1,this.s=3,yt(12),Gr(this),zs(this);break e}}if(this.P){f=!0;let Qt;for(;!this.J&&this.C<F.length;)if(Qt=YA(this,F),Qt==tf){dt==4&&(this.s=4,yt(14),f=!1),Bi(this.i,this.l,null,"[Incomplete Response]");break}else if(Qt==sw){this.s=4,yt(15),Bi(this.i,this.l,F,"[Invalid Chunk]"),f=!1;break}else Bi(this.i,this.l,Qt,null),of(this,Qt);if(uw(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),dt!=4||F.length!=0||this.h.h||(this.s=1,yt(16),f=!1),this.o=this.o&&f,!f)Bi(this.i,this.l,F,"[Invalid Chunked Response]"),Gr(this),zs(this);else if(0<F.length&&!this.W){this.W=!0;var lt=this.j;lt.g==this&&lt.ba&&!lt.M&&(lt.j.info("Great, no buffering proxy detected. Bytes received: "+F.length),df(lt),lt.M=!0,yt(11))}}else Bi(this.i,this.l,F,null),of(this,F);dt==4&&Gr(this),this.o&&!this.J&&(dt==4?Ow(this.j,this):(this.o=!1,Gu(this)))}else fR(this.g),f==400&&0<F.indexOf("Unknown SID")?(this.s=3,yt(12)):(this.s=0,yt(13)),Gr(this),zs(this)}}}catch{}finally{}};function uw(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function YA(c,d){var f=c.C,g=d.indexOf(`
`,f);return g==-1?tf:(f=Number(d.substring(f,g)),isNaN(f)?sw:(g+=1,g+f>d.length?tf:(d=d.slice(g,g+f),c.C=g+f,d)))}nr.prototype.cancel=function(){this.J=!0,Gr(this)};function Gu(c){c.S=Date.now()+c.I,cw(c,c.I)}function cw(c,d){if(c.B!=null)throw Error("WatchDog timer not null");c.B=Hs(m(c.ba,c),d)}function rf(c){c.B&&(a.clearTimeout(c.B),c.B=null)}nr.prototype.ba=function(){this.B=null;let c=Date.now();0<=c-this.S?(KA(this.i,this.A),this.L!=2&&($s(),yt(17)),Gr(this),this.s=2,zs(this)):cw(this,this.S-c)};function zs(c){c.j.G==0||c.J||Ow(c.j,c)}function Gr(c){rf(c);var d=c.M;d&&typeof d.ma=="function"&&d.ma(),c.M=null,Z_(c.U),c.g&&(d=c.g,c.g=null,d.abort(),d.ma())}function of(c,d){try{var f=c.j;if(f.G!=0&&(f.g==c||sf(f.h,c))){if(!c.K&&sf(f.h,c)&&f.G==3){try{var g=f.Da.g.parse(d)}catch{g=null}if(Array.isArray(g)&&g.length==3){var C=g;if(C[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<c.F)ec(f),Ju(f);else break e;lf(f),yt(18)}}else f.za=C[1],0<f.za-f.T&&37500>C[2]&&f.F&&f.v==0&&!f.C&&(f.C=Hs(m(f.Za,f),6e3));if(1>=hw(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else Kr(f,11)}else if((c.K||f.g==c)&&ec(f),!U(d))for(C=f.Da.g.parse(d),d=0;d<C.length;d++){let me=C[d];if(f.T=me[0],me=me[1],f.G==2)if(me[0]=="c"){f.K=me[1],f.ia=me[2];let lt=me[3];lt!=null&&(f.la=lt,f.j.info("VER="+f.la));let dt=me[4];dt!=null&&(f.Aa=dt,f.j.info("SVER="+f.Aa));let qi=me[5];qi!=null&&typeof qi=="number"&&0<qi&&(g=1.5*qi,f.L=g,f.j.info("backChannelRequestTimeoutMs_="+g)),g=f;let Qt=c.g;if(Qt){let nc=Qt.g?Qt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(nc){var M=g.h;M.g||nc.indexOf("spdy")==-1&&nc.indexOf("quic")==-1&&nc.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(af(M,M.h),M.h=null))}if(g.D){let hf=Qt.g?Qt.g.getResponseHeader("X-HTTP-Session-Id"):null;hf&&(g.ya=hf,be(g.I,g.D,hf))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-c.F,f.j.info("Handshake RTT: "+f.R+"ms")),g=f;var F=c;if(g.qa=Vw(g,g.J?g.ia:null,g.W),F.K){fw(g.h,F);var Ee=F,it=g.L;it&&(Ee.I=it),Ee.B&&(rf(Ee),Gu(Ee)),g.g=F}else Pw(g);0<f.i.length&&Xu(f)}else me[0]!="stop"&&me[0]!="close"||Kr(f,7);else f.G==3&&(me[0]=="stop"||me[0]=="close"?me[0]=="stop"?Kr(f,7):cf(f):me[0]!="noop"&&f.l&&f.l.ta(me),f.v=0)}}$s(4)}catch{}}var ZA=class{constructor(c,d){this.g=c,this.map=d}};function lw(c){this.l=c||10,a.PerformanceNavigationTiming?(c=a.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function dw(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function hw(c){return c.h?1:c.g?c.g.size:0}function sf(c,d){return c.h?c.h==d:c.g?c.g.has(d):!1}function af(c,d){c.g?c.g.add(d):c.h=d}function fw(c,d){c.h&&c.h==d?c.h=null:c.g&&c.g.has(d)&&c.g.delete(d)}lw.prototype.cancel=function(){if(this.i=pw(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let c of this.g.values())c.cancel();this.g.clear()}};function pw(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let d=c.i;for(let f of c.g.values())d=d.concat(f.D);return d}return R(c.i)}function JA(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(u(c)){for(var d=[],f=c.length,g=0;g<f;g++)d.push(c[g]);return d}d=[],f=0;for(g in c)d[f++]=c[g];return d}function XA(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(u(c)||typeof c=="string"){var d=[];c=c.length;for(var f=0;f<c;f++)d.push(f);return d}d=[],f=0;for(let g in c)d[f++]=g;return d}}}function gw(c,d){if(c.forEach&&typeof c.forEach=="function")c.forEach(d,void 0);else if(u(c)||typeof c=="string")Array.prototype.forEach.call(c,d,void 0);else for(var f=XA(c),g=JA(c),C=g.length,M=0;M<C;M++)d.call(void 0,g[M],f&&f[M],c)}var mw=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function eR(c,d){if(c){c=c.split("&");for(var f=0;f<c.length;f++){var g=c[f].indexOf("="),C=null;if(0<=g){var M=c[f].substring(0,g);C=c[f].substring(g+1)}else M=c[f];d(M,C?decodeURIComponent(C.replace(/\+/g," ")):"")}}}function Wr(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof Wr){this.h=c.h,Wu(this,c.j),this.o=c.o,this.g=c.g,Ku(this,c.s),this.l=c.l;var d=c.i,f=new Ks;f.i=d.i,d.g&&(f.g=new Map(d.g),f.h=d.h),yw(this,f),this.m=c.m}else c&&(d=String(c).match(mw))?(this.h=!1,Wu(this,d[1]||"",!0),this.o=Gs(d[2]||""),this.g=Gs(d[3]||"",!0),Ku(this,d[4]),this.l=Gs(d[5]||"",!0),yw(this,d[6]||"",!0),this.m=Gs(d[7]||"")):(this.h=!1,this.i=new Ks(null,this.h))}Wr.prototype.toString=function(){var c=[],d=this.j;d&&c.push(Ws(d,vw,!0),":");var f=this.g;return(f||d=="file")&&(c.push("//"),(d=this.o)&&c.push(Ws(d,vw,!0),"@"),c.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&c.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&c.push("/"),c.push(Ws(f,f.charAt(0)=="/"?rR:nR,!0))),(f=this.i.toString())&&c.push("?",f),(f=this.m)&&c.push("#",Ws(f,oR)),c.join("")};function xn(c){return new Wr(c)}function Wu(c,d,f){c.j=f?Gs(d,!0):d,c.j&&(c.j=c.j.replace(/:$/,""))}function Ku(c,d){if(d){if(d=Number(d),isNaN(d)||0>d)throw Error("Bad port number "+d);c.s=d}else c.s=null}function yw(c,d,f){d instanceof Ks?(c.i=d,sR(c.i,c.h)):(f||(d=Ws(d,iR)),c.i=new Ks(d,c.h))}function be(c,d,f){c.i.set(d,f)}function Qu(c){return be(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function Gs(c,d){return c?d?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function Ws(c,d,f){return typeof c=="string"?(c=encodeURI(c).replace(d,tR),f&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function tR(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var vw=/[#\/\?@]/g,nR=/[#\?:]/g,rR=/[#\?]/g,iR=/[#\?@]/g,oR=/#/g;function Ks(c,d){this.h=this.g=null,this.i=c||null,this.j=!!d}function rr(c){c.g||(c.g=new Map,c.h=0,c.i&&eR(c.i,function(d,f){c.add(decodeURIComponent(d.replace(/\+/g," ")),f)}))}n=Ks.prototype,n.add=function(c,d){rr(this),this.i=null,c=$i(this,c);var f=this.g.get(c);return f||this.g.set(c,f=[]),f.push(d),this.h+=1,this};function _w(c,d){rr(c),d=$i(c,d),c.g.has(d)&&(c.i=null,c.h-=c.g.get(d).length,c.g.delete(d))}function ww(c,d){return rr(c),d=$i(c,d),c.g.has(d)}n.forEach=function(c,d){rr(this),this.g.forEach(function(f,g){f.forEach(function(C){c.call(d,C,g,this)},this)},this)},n.na=function(){rr(this);let c=Array.from(this.g.values()),d=Array.from(this.g.keys()),f=[];for(let g=0;g<d.length;g++){let C=c[g];for(let M=0;M<C.length;M++)f.push(d[g])}return f},n.V=function(c){rr(this);let d=[];if(typeof c=="string")ww(this,c)&&(d=d.concat(this.g.get($i(this,c))));else{c=Array.from(this.g.values());for(let f=0;f<c.length;f++)d=d.concat(c[f])}return d},n.set=function(c,d){return rr(this),this.i=null,c=$i(this,c),ww(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[d]),this.h+=1,this},n.get=function(c,d){return c?(c=this.V(c),0<c.length?String(c[0]):d):d};function Iw(c,d,f){_w(c,d),0<f.length&&(c.i=null,c.g.set($i(c,d),R(f)),c.h+=f.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let c=[],d=Array.from(this.g.keys());for(var f=0;f<d.length;f++){var g=d[f];let M=encodeURIComponent(String(g)),F=this.V(g);for(g=0;g<F.length;g++){var C=M;F[g]!==""&&(C+="="+encodeURIComponent(String(F[g]))),c.push(C)}}return this.i=c.join("&")};function $i(c,d){return d=String(d),c.j&&(d=d.toLowerCase()),d}function sR(c,d){d&&!c.j&&(rr(c),c.i=null,c.g.forEach(function(f,g){var C=g.toLowerCase();g!=C&&(_w(this,g),Iw(this,C,f))},c)),c.j=d}function aR(c,d){let f=new qs;if(a.Image){let g=new Image;g.onload=y(ir,f,"TestLoadImage: loaded",!0,d,g),g.onerror=y(ir,f,"TestLoadImage: error",!1,d,g),g.onabort=y(ir,f,"TestLoadImage: abort",!1,d,g),g.ontimeout=y(ir,f,"TestLoadImage: timeout",!1,d,g),a.setTimeout(function(){g.ontimeout&&g.ontimeout()},1e4),g.src=c}else d(!1)}function uR(c,d){let f=new qs,g=new AbortController,C=setTimeout(()=>{g.abort(),ir(f,"TestPingServer: timeout",!1,d)},1e4);fetch(c,{signal:g.signal}).then(M=>{clearTimeout(C),M.ok?ir(f,"TestPingServer: ok",!0,d):ir(f,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(C),ir(f,"TestPingServer: error",!1,d)})}function ir(c,d,f,g,C){try{C&&(C.onload=null,C.onerror=null,C.onabort=null,C.ontimeout=null),g(f)}catch{}}function cR(){this.g=new zA}function lR(c,d,f){let g=f||"";try{gw(c,function(C,M){let F=C;l(C)&&(F=Yh(C)),d.push(g+M+"="+encodeURIComponent(F))})}catch(C){throw d.push(g+"type="+encodeURIComponent("_badmap")),C}}function Qs(c){this.l=c.Ub||null,this.j=c.eb||!1}D(Qs,Zh),Qs.prototype.g=function(){return new Yu(this.l,this.j)},Qs.prototype.i=function(c){return function(){return c}}({});function Yu(c,d){ct.call(this),this.D=c,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}D(Yu,ct),n=Yu.prototype,n.open=function(c,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=d,this.readyState=1,Zs(this)},n.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let d={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(d.body=c),(this.D||a).fetch(new Request(this.A,d)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ys(this)),this.readyState=0},n.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,Zs(this)),this.g&&(this.readyState=3,Zs(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ew(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ew(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}n.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var d=c.value?c.value:new Uint8Array(0);(d=this.v.decode(d,{stream:!c.done}))&&(this.response=this.responseText+=d)}c.done?Ys(this):Zs(this),this.readyState==3&&Ew(this)}},n.Ra=function(c){this.g&&(this.response=this.responseText=c,Ys(this))},n.Qa=function(c){this.g&&(this.response=c,Ys(this))},n.ga=function(){this.g&&Ys(this)};function Ys(c){c.readyState=4,c.l=null,c.j=null,c.v=null,Zs(c)}n.setRequestHeader=function(c,d){this.u.append(c,d)},n.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let c=[],d=this.h.entries();for(var f=d.next();!f.done;)f=f.value,c.push(f[0]+": "+f[1]),f=d.next();return c.join(`\r
`)};function Zs(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Yu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function Dw(c){let d="";return G(c,function(f,g){d+=g,d+=":",d+=f,d+=`\r
`}),d}function uf(c,d,f){e:{for(g in f){var g=!1;break e}g=!0}g||(f=Dw(f),typeof c=="string"?f!=null&&encodeURIComponent(String(f)):be(c,d,f))}function Pe(c){ct.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}D(Pe,ct);var dR=/^https?$/i,hR=["POST","PUT"];n=Pe.prototype,n.Ha=function(c){this.J=c},n.ea=function(c,d,f,g){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);d=d?d.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ef.g(),this.v=this.o?J_(this.o):J_(ef),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(d,String(c),!0),this.B=!1}catch(M){Tw(this,M);return}if(c=f||"",f=new Map(this.headers),g)if(Object.getPrototypeOf(g)===Object.prototype)for(var C in g)f.set(C,g[C]);else if(typeof g.keys=="function"&&typeof g.get=="function")for(let M of g.keys())f.set(M,g.get(M));else throw Error("Unknown input type for opt_headers: "+String(g));g=Array.from(f.keys()).find(M=>M.toLowerCase()=="content-type"),C=a.FormData&&c instanceof a.FormData,!(0<=Array.prototype.indexOf.call(hR,d,void 0))||g||C||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[M,F]of f)this.g.setRequestHeader(M,F);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Sw(this),this.u=!0,this.g.send(c),this.u=!1}catch(M){Tw(this,M)}};function Tw(c,d){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=d,c.m=5,Cw(c),Zu(c)}function Cw(c){c.A||(c.A=!0,mt(c,"complete"),mt(c,"error"))}n.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,mt(this,"complete"),mt(this,"abort"),Zu(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Zu(this,!0)),Pe.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?bw(this):this.bb())},n.bb=function(){bw(this)};function bw(c){if(c.h&&typeof s<"u"&&(!c.v[1]||Mn(c)!=4||c.Z()!=2)){if(c.u&&Mn(c)==4)K_(c.Ea,0,c);else if(mt(c,"readystatechange"),Mn(c)==4){c.h=!1;try{let F=c.Z();e:switch(F){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var f;if(!(f=d)){var g;if(g=F===0){var C=String(c.D).match(mw)[1]||null;!C&&a.self&&a.self.location&&(C=a.self.location.protocol.slice(0,-1)),g=!dR.test(C?C.toLowerCase():"")}f=g}if(f)mt(c,"complete"),mt(c,"success");else{c.m=6;try{var M=2<Mn(c)?c.g.statusText:""}catch{M=""}c.l=M+" ["+c.Z()+"]",Cw(c)}}finally{Zu(c)}}}}function Zu(c,d){if(c.g){Sw(c);let f=c.g,g=c.v[0]?()=>{}:null;c.g=null,c.v=null,d||mt(c,"ready");try{f.onreadystatechange=g}catch{}}}function Sw(c){c.I&&(a.clearTimeout(c.I),c.I=null)}n.isActive=function(){return!!this.g};function Mn(c){return c.g?c.g.readyState:0}n.Z=function(){try{return 2<Mn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(c){if(this.g){var d=this.g.responseText;return c&&d.indexOf(c)==0&&(d=d.substring(c.length)),qA(d)}};function Aw(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function fR(c){let d={};c=(c.g&&2<=Mn(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let g=0;g<c.length;g++){if(U(c[g]))continue;var f=T(c[g]);let C=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();let M=d[C]||[];d[C]=M,M.push(f)}I(d,function(g){return g.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Js(c,d,f){return f&&f.internalChannelParams&&f.internalChannelParams[c]||d}function Rw(c){this.Aa=0,this.i=[],this.j=new qs,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Js("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Js("baseRetryDelayMs",5e3,c),this.cb=Js("retryDelaySeedMs",1e4,c),this.Wa=Js("forwardChannelMaxRetries",2,c),this.wa=Js("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new lw(c&&c.concurrentRequestLimit),this.Da=new cR,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Rw.prototype,n.la=8,n.G=1,n.connect=function(c,d,f,g){yt(0),this.W=c,this.H=d||{},f&&g!==void 0&&(this.H.OSID=f,this.H.OAID=g),this.F=this.X,this.I=Vw(this,null,this.W),Xu(this)};function cf(c){if(xw(c),c.G==3){var d=c.U++,f=xn(c.I);if(be(f,"SID",c.K),be(f,"RID",d),be(f,"TYPE","terminate"),Xs(c,f),d=new nr(c,c.j,d),d.L=2,d.v=Qu(xn(f)),f=!1,a.navigator&&a.navigator.sendBeacon)try{f=a.navigator.sendBeacon(d.v.toString(),"")}catch{}!f&&a.Image&&(new Image().src=d.v,f=!0),f||(d.g=jw(d.j,null),d.g.ea(d.v)),d.F=Date.now(),Gu(d)}Lw(c)}function Ju(c){c.g&&(df(c),c.g.cancel(),c.g=null)}function xw(c){Ju(c),c.u&&(a.clearTimeout(c.u),c.u=null),ec(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&a.clearTimeout(c.s),c.s=null)}function Xu(c){if(!dw(c.h)&&!c.s){c.s=!0;var d=c.Ga;Fs||$_(),Ls||(Fs(),Ls=!0),Bh.add(d,c),c.B=0}}function pR(c,d){return hw(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=d.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=Hs(m(c.Ga,c,d),Fw(c,c.B)),c.B++,!0)}n.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;let C=new nr(this,this.j,c),M=this.o;if(this.S&&(M?(M=v(M),E(M,this.S)):M=this.S),this.m!==null||this.O||(C.H=M,M=null),this.P)e:{for(var d=0,f=0;f<this.i.length;f++){t:{var g=this.i[f];if("__data__"in g.map&&(g=g.map.__data__,typeof g=="string")){g=g.length;break t}g=void 0}if(g===void 0)break;if(d+=g,4096<d){d=f;break e}if(d===4096||f===this.i.length-1){d=f+1;break e}}d=1e3}else d=1e3;d=Nw(this,C,d),f=xn(this.I),be(f,"RID",c),be(f,"CVER",22),this.D&&be(f,"X-HTTP-Session-Id",this.D),Xs(this,f),M&&(this.O?d="headers="+encodeURIComponent(String(Dw(M)))+"&"+d:this.m&&uf(f,this.m,M)),af(this.h,C),this.Ua&&be(f,"TYPE","init"),this.P?(be(f,"$req",d),be(f,"SID","null"),C.T=!0,nf(C,f,null)):nf(C,f,d),this.G=2}}else this.G==3&&(c?Mw(this,c):this.i.length==0||dw(this.h)||Mw(this))};function Mw(c,d){var f;d?f=d.l:f=c.U++;let g=xn(c.I);be(g,"SID",c.K),be(g,"RID",f),be(g,"AID",c.T),Xs(c,g),c.m&&c.o&&uf(g,c.m,c.o),f=new nr(c,c.j,f,c.B+1),c.m===null&&(f.H=c.o),d&&(c.i=d.D.concat(c.i)),d=Nw(c,f,1e3),f.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),af(c.h,f),nf(f,g,d)}function Xs(c,d){c.H&&G(c.H,function(f,g){be(d,g,f)}),c.l&&gw({},function(f,g){be(d,g,f)})}function Nw(c,d,f){f=Math.min(c.i.length,f);var g=c.l?m(c.l.Na,c.l,c):null;e:{var C=c.i;let M=-1;for(;;){let F=["count="+f];M==-1?0<f?(M=C[0].g,F.push("ofs="+M)):M=0:F.push("ofs="+M);let Ee=!0;for(let it=0;it<f;it++){let me=C[it].g,lt=C[it].map;if(me-=M,0>me)M=Math.max(0,C[it].g-100),Ee=!1;else try{lR(lt,F,"req"+me+"_")}catch{g&&g(lt)}}if(Ee){g=F.join("&");break e}}}return c=c.i.splice(0,f),d.D=c,g}function Pw(c){if(!c.g&&!c.u){c.Y=1;var d=c.Fa;Fs||$_(),Ls||(Fs(),Ls=!0),Bh.add(d,c),c.v=0}}function lf(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=Hs(m(c.Fa,c),Fw(c,c.v)),c.v++,!0)}n.Fa=function(){if(this.u=null,kw(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=Hs(m(this.ab,this),c)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,yt(10),Ju(this),kw(this))};function df(c){c.A!=null&&(a.clearTimeout(c.A),c.A=null)}function kw(c){c.g=new nr(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var d=xn(c.qa);be(d,"RID","rpc"),be(d,"SID",c.K),be(d,"AID",c.T),be(d,"CI",c.F?"0":"1"),!c.F&&c.ja&&be(d,"TO",c.ja),be(d,"TYPE","xmlhttp"),Xs(c,d),c.m&&c.o&&uf(d,c.m,c.o),c.L&&(c.g.I=c.L);var f=c.g;c=c.ia,f.L=1,f.v=Qu(xn(d)),f.m=null,f.P=!0,aw(f,c)}n.Za=function(){this.C!=null&&(this.C=null,Ju(this),lf(this),yt(19))};function ec(c){c.C!=null&&(a.clearTimeout(c.C),c.C=null)}function Ow(c,d){var f=null;if(c.g==d){ec(c),df(c),c.g=null;var g=2}else if(sf(c.h,d))f=d.D,fw(c.h,d),g=1;else return;if(c.G!=0){if(d.o)if(g==1){f=d.m?d.m.length:0,d=Date.now()-d.F;var C=c.B;g=Hu(),mt(g,new rw(g,f)),Xu(c)}else Pw(c);else if(C=d.s,C==3||C==0&&0<d.X||!(g==1&&pR(c,d)||g==2&&lf(c)))switch(f&&0<f.length&&(d=c.h,d.i=d.i.concat(f)),C){case 1:Kr(c,5);break;case 4:Kr(c,10);break;case 3:Kr(c,6);break;default:Kr(c,2)}}}function Fw(c,d){let f=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(f*=2),f*d}function Kr(c,d){if(c.j.info("Error code "+d),d==2){var f=m(c.fb,c),g=c.Xa;let C=!g;g=new Wr(g||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Wu(g,"https"),Qu(g),C?aR(g.toString(),f):uR(g.toString(),f)}else yt(2);c.G=0,c.l&&c.l.sa(d),Lw(c),xw(c)}n.fb=function(c){c?(this.j.info("Successfully pinged google.com"),yt(2)):(this.j.info("Failed to ping google.com"),yt(1))};function Lw(c){if(c.G=0,c.ka=[],c.l){let d=pw(c.h);(d.length!=0||c.i.length!=0)&&(S(c.ka,d),S(c.ka,c.i),c.h.i.length=0,R(c.i),c.i.length=0),c.l.ra()}}function Vw(c,d,f){var g=f instanceof Wr?xn(f):new Wr(f);if(g.g!="")d&&(g.g=d+"."+g.g),Ku(g,g.s);else{var C=a.location;g=C.protocol,d=d?d+"."+C.hostname:C.hostname,C=+C.port;var M=new Wr(null);g&&Wu(M,g),d&&(M.g=d),C&&Ku(M,C),f&&(M.l=f),g=M}return f=c.D,d=c.ya,f&&d&&be(g,f,d),be(g,"VER",c.la),Xs(c,g),g}function jw(c,d,f){if(d&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return d=c.Ca&&!c.pa?new Pe(new Qs({eb:f})):new Pe(c.pa),d.Ha(c.J),d}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Uw(){}n=Uw.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function tc(){}tc.prototype.g=function(c,d){return new Ot(c,d)};function Ot(c,d){ct.call(this),this.g=new Rw(d),this.l=c,this.h=d&&d.messageUrlParams||null,c=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(c?c["X-WebChannel-Content-Type"]=d.messageContentType:c={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.va&&(c?c["X-WebChannel-Client-Profile"]=d.va:c={"X-WebChannel-Client-Profile":d.va}),this.g.S=c,(c=d&&d.Sb)&&!U(c)&&(this.g.m=c),this.v=d&&d.supportsCrossDomainXhr||!1,this.u=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!U(d)&&(this.g.D=d,c=this.h,c!==null&&d in c&&(c=this.h,d in c&&delete c[d])),this.j=new Hi(this)}D(Ot,ct),Ot.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ot.prototype.close=function(){cf(this.g)},Ot.prototype.o=function(c){var d=this.g;if(typeof c=="string"){var f={};f.__data__=c,c=f}else this.u&&(f={},f.__data__=Yh(c),c=f);d.i.push(new ZA(d.Ya++,c)),d.G==3&&Xu(d)},Ot.prototype.N=function(){this.g.l=null,delete this.j,cf(this.g),delete this.g,Ot.aa.N.call(this)};function Bw(c){Jh.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var d=c.__sm__;if(d){e:{for(let f in d){c=f;break e}c=void 0}(this.i=c)&&(c=this.i,d=d!==null&&c in d?d[c]:void 0),this.data=d}else this.data=c}D(Bw,Jh);function $w(){Xh.call(this),this.status=1}D($w,Xh);function Hi(c){this.g=c}D(Hi,Uw),Hi.prototype.ua=function(){mt(this.g,"a")},Hi.prototype.ta=function(c){mt(this.g,new Bw(c))},Hi.prototype.sa=function(c){mt(this.g,new $w)},Hi.prototype.ra=function(){mt(this.g,"b")},tc.prototype.createWebChannel=tc.prototype.g,Ot.prototype.send=Ot.prototype.o,Ot.prototype.open=Ot.prototype.m,Ot.prototype.close=Ot.prototype.close,qm=zn.createWebChannelTransport=function(){return new tc},Hm=zn.getStatEventTarget=function(){return Hu()},$m=zn.Event=zr,_d=zn.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},qu.NO_ERROR=0,qu.TIMEOUT=8,qu.HTTP_ERROR=6,Ya=zn.ErrorCode=qu,iw.COMPLETE="complete",Bm=zn.EventType=iw,X_.EventType=Bs,Bs.OPEN="a",Bs.CLOSE="b",Bs.ERROR="c",Bs.MESSAGE="d",ct.prototype.listen=ct.prototype.K,Go=zn.WebChannel=X_,QL=zn.FetchXmlHttpFactory=Qs,Pe.prototype.listenOnce=Pe.prototype.L,Pe.prototype.getLastError=Pe.prototype.Ka,Pe.prototype.getLastErrorCode=Pe.prototype.Ba,Pe.prototype.getStatus=Pe.prototype.Z,Pe.prototype.getResponseJson=Pe.prototype.Oa,Pe.prototype.getResponseText=Pe.prototype.oa,Pe.prototype.send=Pe.prototype.ea,Pe.prototype.setWithCredentials=Pe.prototype.Ha,Um=zn.XhrIo=Pe}).apply(typeof vd<"u"?vd:typeof self<"u"?self:typeof window<"u"?window:{});var ib="@firebase/firestore";var We=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};We.UNAUTHENTICATED=new We(null),We.GOOGLE_CREDENTIALS=new We("google-credentials-uid"),We.FIRST_PARTY=new We("first-party-uid"),We.MOCK_USER=new We("mock-user");var Cs="10.14.0";var xr=new Ww("@firebase/firestore");function Zo(){return xr.logLevel}function YL(n){xr.setLogLevel(n)}function P(n,...e){if(xr.logLevel<=sn.DEBUG){let t=e.map(Qv);xr.debug(`Firestore (${Cs}): ${n}`,...t)}}function Ve(n,...e){if(xr.logLevel<=sn.ERROR){let t=e.map(Qv);xr.error(`Firestore (${Cs}): ${n}`,...t)}}function Kn(n,...e){if(xr.logLevel<=sn.WARN){let t=e.map(Qv);xr.warn(`Firestore (${Cs}): ${n}`,...t)}}function Qv(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function H(n="Unexpected state"){let e=`FIRESTORE (${Cs}) INTERNAL ASSERTION FAILED: `+n;throw Ve(e),new Error(e)}function z(n,e){n||H()}function Q6(n,e){n||H()}function j(n,e){return n}var N={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},k=class extends sc{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var et=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Rd=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Ym=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(We.UNAUTHENTICATED))}shutdown(){}},Zm=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Jm=class{constructor(e){this.t=e,this.currentUser=We.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){z(this.o===void 0);let r=this.i,i=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve(),o=new et;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new et,e.enqueueRetryable(()=>i(this.currentUser))};let s=()=>{let u=o;e.enqueueRetryable(()=>x(this,null,function*(){yield u.promise,yield i(this.currentUser)}))},a=u=>{P("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(u=>a(u)),setTimeout(()=>{if(!this.auth){let u=this.t.getImmediate({optional:!0});u?a(u):(P("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new et)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(P("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(z(typeof r.accessToken=="string"),new Rd(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return z(e===null||typeof e=="string"),new We(e)}},Xm=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=We.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},ey=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new Xm(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(We.FIRST_PARTY))}shutdown(){}invalidateToken(){}},ty=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},ny=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){z(this.o===void 0);let r=o=>{o.error!=null&&P("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let s=o.token!==this.R;return this.R=o.token,P("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{P("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.A.getImmediate({optional:!0});o?i(o):P("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(z(typeof t.token=="string"),this.R=t.token,new ty(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function ZL(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var xd=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=ZL(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%e.length))}return r}};function te(n,e){return n<e?-1:n>e?1:0}function as(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function uS(n){return n+"\0"}var je=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new k(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new k(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new k(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new k(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?te(this.nanoseconds,e.nanoseconds):te(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var W=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new je(0,0))}static max(){return new n(new je(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Md=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&H(),r===void 0?r=e.length-t:r>e.length-t&&H(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=e.get(i),s=t.get(i);if(o<s)return-1;if(o>s)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},pe=class n extends Md{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new k(N.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},JL=/^[_a-zA-Z][_a-zA-Z0-9]*$/,tt=class n extends Md{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return JL.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,o=()=>{if(r.length===0)throw new k(N.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},s=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new k(N.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new k(N.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else a==="`"?(s=!s,i++):a!=="."||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new k(N.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var B=class n{constructor(e){this.path=e}static fromPath(e){return new n(pe.fromString(e))}static fromName(e){return new n(pe.fromString(e).popFirst(5))}static empty(){return new n(pe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&pe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return pe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new pe(e.slice()))}};var us=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};function ry(n){return n.fields.find(e=>e.kind===2)}function wi(n){return n.fields.filter(e=>e.kind!==2)}us.UNKNOWN_ID=-1;var rs=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var uu=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,Kt.min())}};function cS(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=W.fromTimestamp(r===1e9?new je(t+1,0):new je(t,r));return new Kt(i,B.empty(),e)}function lS(n){return new Kt(n.readTime,n.key,-1)}var Kt=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(W.min(),B.empty(),-1)}static max(){return new n(W.max(),B.empty(),-1)}};function Yv(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=B.comparator(n.documentKey,e.documentKey),t!==0?t:te(n.largestBatchId,e.largestBatchId))}var dS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Nd=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function $r(n){return x(this,null,function*(){if(n.code!==N.FAILED_PRECONDITION||n.message!==dS)throw n;P("LocalStore","Unexpectedly lost primary lease")})}var A=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&H(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,o=0,s=!1;e.forEach(a=>{++i,a.next(()=>{++o,s&&o===i&&t()},u=>r(u))}),s=!0,o===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let o=e.length,s=new Array(o),a=0;for(let u=0;u<o;u++){let l=u;t(e[l]).next(h=>{s[l]=h,++a,a===o&&r(s)},h=>i(h))}})}static doWhile(e,t){return new n((r,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}};var Pd=class n{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new et,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new bi(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=Zv(r.target.error);this.V.reject(new bi(e,i))}}static open(e,t,r,i){try{return new n(t,e.transaction(i,r))}catch(o){throw new bi(t,o)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(P("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new oy(t)}},Mr=class n{constructor(e,t,r){this.name=e,this.version=t,this.p=r,n.S(ea())===12.2&&Ve("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return P("SimpleDb","Removing database:",e),Ii(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Gw())return!1;if(n.v())return!0;let e=ea(),t=n.S(e),r=0<t&&t<10,i=hS(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}M(e){return x(this,null,function*(){return this.db||(P("SimpleDb","Opening database:",this.name),this.db=yield new Promise((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=o=>{let s=o.target.result;t(s)},i.onblocked=()=>{r(new bi(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=o=>{let s=o.target.error;s.name==="VersionError"?r(new k(N.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):s.name==="InvalidStateError"?r(new k(N.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+s)):r(new bi(e,s))},i.onupgradeneeded=o=>{P("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);let s=o.target.result;this.p.O(s,i.transaction,o.oldVersion,this.version).next(()=>{P("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db})}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){return x(this,null,function*(){let o=t==="readonly",s=0;for(;;){++s;try{this.db=yield this.M(e);let a=Pd.open(this.db,e,o?"readonly":"readwrite",r),u=i(a).next(l=>(a.g(),l)).catch(l=>(a.abort(l),A.reject(l))).toPromise();return u.catch(()=>{}),yield a.m,u}catch(a){let u=a,l=u.name!=="FirebaseError"&&s<3;if(P("SimpleDb","Transaction failed with error:",u.message,"Retrying:",l),this.close(),!l)return Promise.reject(u)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function hS(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var iy=class{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Ii(this.B.delete())}},bi=class extends k{constructor(e,t){super(N.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function Hr(n){return n.name==="IndexedDbTransactionError"}var oy=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(P("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(P("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Ii(r)}add(e){return P("SimpleDb","ADD",this.store.name,e,e),Ii(this.store.add(e))}get(e){return Ii(this.store.get(e)).next(t=>(t===void 0&&(t=null),P("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return P("SimpleDb","DELETE",this.store.name,e),Ii(this.store.delete(e))}count(){return P("SimpleDb","COUNT",this.store.name),Ii(this.store.count())}U(e,t){let r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let o=i.getAll(r.range);return new A((s,a)=>{o.onerror=u=>{a(u.target.error)},o.onsuccess=u=>{s(u.target.result)}})}{let o=this.cursor(r),s=[];return this.W(o,(a,u)=>{s.push(u)}).next(()=>s)}}G(e,t){let r=this.store.getAll(e,t===null?void 0:t);return new A((i,o)=>{r.onerror=s=>{o(s.target.error)},r.onsuccess=s=>{i(s.target.result)}})}j(e,t){P("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,t);r.H=!1;let i=this.cursor(r);return this.W(i,(o,s,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.W(i,t)}Y(e){let t=this.cursor({});return new A((r,i)=>{t.onerror=o=>{let s=Zv(o.target.error);i(s)},t.onsuccess=o=>{let s=o.target.result;s?e(s.primaryKey,s.value).next(a=>{a?s.continue():r()}):r()}})}W(e,t){let r=[];return new A((i,o)=>{e.onerror=s=>{o(s.target.error)},e.onsuccess=s=>{let a=s.target.result;if(!a)return void i();let u=new iy(a),l=t(a.primaryKey,a.value,u);if(l instanceof A){let h=l.catch(p=>(u.done(),A.reject(p)));r.push(h)}u.isDone?i():u.K===null?a.continue():a.continue(u.K)}}).next(()=>A.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function Ii(n){return new A((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=Zv(r.target.error);t(i)}})}var ob=!1;function Zv(n){let e=Mr.S(ea());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new k("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return ob||(ob=!0,setTimeout(()=>{throw r},0)),r}}return n}var sy=class{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){P("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>x(this,null,function*(){this.task=null;try{P("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(t){Hr(t)?P("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):yield $r(t)}yield this.X(6e4)}))}},ay=class{constructor(e,t){this.localStore=e,this.persistence=t}ee(e=50){return x(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))})}te(e,t){let r=new Set,i=t,o=!0;return A.doWhile(()=>o===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(s=>{if(s!==null&&!r.has(s))return P("IndexBackfiller",`Processing collection: ${s}`),this.ne(e,s,i).next(a=>{i-=a,r.add(s)});o=!1})).next(()=>t-i)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(o=>{let s=o.changes;return this.localStore.indexManager.updateIndexEntries(e,s).next(()=>this.re(i,o)).next(a=>(P("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>s.size)}))}re(e,t){let r=e;return t.changes.forEach((i,o)=>{let s=lS(o);Yv(s,r)>0&&(r=s)}),new Kt(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}};var jt=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function xu(n){return n==null}function cu(n){return n===0&&1/n==-1/0}function fS(n){return typeof n=="number"&&Number.isInteger(n)&&!cu(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function Ct(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=sb(e)),e=XL(n.get(t),e);return sb(e)}function XL(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let o=n.charAt(i);switch(o){case"\0":t+="";break;case"":t+="";break;default:t+=o}}return t}function sb(n){return n+""}function wn(n){let e=n.length;if(z(e>=2),e===2)return z(n.charAt(0)===""&&n.charAt(1)===""),pe.emptyPath();let t=e-2,r=[],i="";for(let o=0;o<e;){let s=n.indexOf("",o);switch((s<0||s>t)&&H(),n.charAt(s+1)){case"":let a=n.substring(o,s),u;i.length===0?u=a:(i+=a,u=i,i=""),r.push(u);break;case"":i+=n.substring(o,s),i+="\0";break;case"":i+=n.substring(o,s+1);break;default:H()}o=s+2}return new pe(r)}var ab=["userId","batchId"];function Td(n,e){return[n,Ct(e)]}function pS(n,e,t){return[n,Ct(e),t]}var eV={},tV=["prefixPath","collectionGroup","readTime","documentId"],nV=["prefixPath","collectionGroup","documentId"],rV=["collectionGroup","readTime","prefixPath","documentId"],iV=["canonicalId","targetId"],oV=["targetId","path"],sV=["path","targetId"],aV=["collectionId","parent"],uV=["indexId","uid"],cV=["uid","sequenceNumber"],lV=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],dV=["indexId","uid","orderedDocumentKey"],hV=["userId","collectionPath","documentId"],fV=["userId","collectionPath","largestBatchId"],pV=["userId","collectionGroup","largestBatchId"],gS=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],gV=[...gS,"documentOverlays"],mS=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],yS=mS,Jv=[...yS,"indexConfiguration","indexState","indexEntries"],mV=Jv,yV=[...Jv,"globals"];var lu=class extends Nd{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}};function nt(n,e){let t=j(n);return Mr.F(t._e,e)}function ub(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Li(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function vS(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Ae=class n{constructor(e,t){this.comparator=e,this.root=t||En.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,En.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,En.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ns(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ns(this.root,e,this.comparator,!1)}getReverseIterator(){return new ns(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ns(this.root,e,this.comparator,!0)}},ns=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},En=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw H();let e=this.left.check();if(e!==this.right.check())throw H();return e+(this.isRed()?0:1)}};En.EMPTY=null,En.RED=!0,En.BLACK=!1;En.EMPTY=new class{constructor(){this.size=0}get key(){throw H()}get value(){throw H()}get color(){throw H()}get left(){throw H()}get right(){throw H()}copy(e,t,r,i,o){return this}insert(e,t,r){return new En(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Ce=class n{constructor(e){this.comparator=e,this.data=new Ae(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new kd(this.data.getIterator())}getIteratorFrom(e){return new kd(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},kd=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function Wo(n){return n.hasNext()?n.getNext():void 0}var Ut=class n{constructor(e){this.fields=e,e.sort(tt.comparator)}static empty(){return new n([])}unionWith(e){let t=new Ce(tt.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return as(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Od=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function Z6(){return typeof atob<"u"}var $e=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new Od("Invalid base64 string: "+o):o}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return te(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};$e.EMPTY_BYTE_STRING=new $e("");var vV=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Qn(n){if(z(!!n),typeof n=="string"){let e=0,t=vV.exec(n);if(z(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:xe(n.seconds),nanos:xe(n.nanos)}}function xe(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Nr(n){return typeof n=="string"?$e.fromBase64String(n):$e.fromUint8Array(n)}function bh(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Xv(n){let e=n.mapValue.fields.__previous_value__;return bh(e)?Xv(e):e}function du(n){let e=Qn(n.mapValue.fields.__local_write_time__.timestampValue);return new je(e.seconds,e.nanos)}var uy=class{constructor(e,t,r,i,o,s,a,u,l){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=l}},cs=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Rr={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Cd={nullValue:"NULL_VALUE"};function Si(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?bh(n)?4:_S(n)?9007199254740991:Sh(n)?10:11:H()}function Cn(n,e){if(n===e)return!0;let t=Si(n);if(t!==Si(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return du(n).isEqual(du(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let s=Qn(i.timestampValue),a=Qn(o.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,o){return Nr(i.bytesValue).isEqual(Nr(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,o){return xe(i.geoPointValue.latitude)===xe(o.geoPointValue.latitude)&&xe(i.geoPointValue.longitude)===xe(o.geoPointValue.longitude)}(n,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return xe(i.integerValue)===xe(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let s=xe(i.doubleValue),a=xe(o.doubleValue);return s===a?cu(s)===cu(a):isNaN(s)&&isNaN(a)}return!1}(n,e);case 9:return as(n.arrayValue.values||[],e.arrayValue.values||[],Cn);case 10:case 11:return function(i,o){let s=i.mapValue.fields||{},a=o.mapValue.fields||{};if(ub(s)!==ub(a))return!1;for(let u in s)if(s.hasOwnProperty(u)&&(a[u]===void 0||!Cn(s[u],a[u])))return!1;return!0}(n,e);default:return H()}}function hu(n,e){return(n.values||[]).find(t=>Cn(t,e))!==void 0}function Pr(n,e){if(n===e)return 0;let t=Si(n),r=Si(e);if(t!==r)return te(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return te(n.booleanValue,e.booleanValue);case 2:return function(o,s){let a=xe(o.integerValue||o.doubleValue),u=xe(s.integerValue||s.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(n,e);case 3:return cb(n.timestampValue,e.timestampValue);case 4:return cb(du(n),du(e));case 5:return te(n.stringValue,e.stringValue);case 6:return function(o,s){let a=Nr(o),u=Nr(s);return a.compareTo(u)}(n.bytesValue,e.bytesValue);case 7:return function(o,s){let a=o.split("/"),u=s.split("/");for(let l=0;l<a.length&&l<u.length;l++){let h=te(a[l],u[l]);if(h!==0)return h}return te(a.length,u.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,s){let a=te(xe(o.latitude),xe(s.latitude));return a!==0?a:te(xe(o.longitude),xe(s.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return lb(n.arrayValue,e.arrayValue);case 10:return function(o,s){var a,u,l,h;let p=o.fields||{},m=s.fields||{},y=(a=p.value)===null||a===void 0?void 0:a.arrayValue,D=(u=m.value)===null||u===void 0?void 0:u.arrayValue,R=te(((l=y?.values)===null||l===void 0?void 0:l.length)||0,((h=D?.values)===null||h===void 0?void 0:h.length)||0);return R!==0?R:lb(y,D)}(n.mapValue,e.mapValue);case 11:return function(o,s){if(o===Rr.mapValue&&s===Rr.mapValue)return 0;if(o===Rr.mapValue)return 1;if(s===Rr.mapValue)return-1;let a=o.fields||{},u=Object.keys(a),l=s.fields||{},h=Object.keys(l);u.sort(),h.sort();for(let p=0;p<u.length&&p<h.length;++p){let m=te(u[p],h[p]);if(m!==0)return m;let y=Pr(a[u[p]],l[h[p]]);if(y!==0)return y}return te(u.length,h.length)}(n.mapValue,e.mapValue);default:throw H()}}function cb(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return te(n,e);let t=Qn(n),r=Qn(e),i=te(t.seconds,r.seconds);return i!==0?i:te(t.nanos,r.nanos)}function lb(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let o=Pr(t[i],r[i]);if(o)return o}return te(t.length,r.length)}function ls(n){return cy(n)}function cy(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=Qn(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Nr(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return B.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let o of t.values||[])i?i=!1:r+=",",r+=cy(o);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let s of r)o?o=!1:i+=",",i+=`${s}:${cy(t.fields[s])}`;return i+"}"}(n.mapValue):H()}function Ai(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function ly(n){return!!n&&"integerValue"in n}function fu(n){return!!n&&"arrayValue"in n}function db(n){return!!n&&"nullValue"in n}function hb(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function bd(n){return!!n&&"mapValue"in n}function Sh(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function ru(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Li(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=ru(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ru(n.arrayValue.values[t]);return e}return Object.assign({},n)}function _S(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var wS={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function _V(n){return"nullValue"in n?Cd:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Ai(cs.empty(),B.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Sh(n)?wS:{mapValue:{}}:H()}function wV(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Ai(cs.empty(),B.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?wS:"mapValue"in n?Sh(n)?{mapValue:{}}:Rr:H()}function fb(n,e){let t=Pr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function pb(n,e){let t=Pr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var gt=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!bd(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ru(t)}setAll(e){let t=tt.emptyPath(),r={},i=[];e.forEach((s,a)=>{if(!t.isImmediateParentOf(a)){let u=this.getFieldsMap(t);this.applyChanges(u,r,i),r={},i=[],t=a.popLast()}s?r[a.lastSegment()]=ru(s):i.push(a.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){let t=this.field(e.popLast());bd(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Cn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];bd(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Li(t,(i,o)=>e[i]=o);for(let i of r)delete e[i]}clone(){return new n(ru(this.value))}};function IS(n){let e=[];return Li(n.fields,(t,r)=>{let i=new tt([t]);if(bd(r)){let o=IS(r.mapValue).fields;if(o.length===0)e.push(i);else for(let s of o)e.push(i.child(s))}else e.push(i)}),new Ut(e)}var Ke=class n{constructor(e,t,r,i,o,s,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(e){return new n(e,0,W.min(),W.min(),W.min(),gt.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,W.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,W.min(),W.min(),gt.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,W.min(),W.min(),gt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(W.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=gt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=gt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=W.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var bn=class{constructor(e,t){this.position=e,this.inclusive=t}};function gb(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let o=e[i],s=n.position[i];if(o.field.isKeyField()?r=B.comparator(B.fromName(s.referenceValue),t.key):r=Pr(s,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function mb(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Cn(n.position[t],e.position[t]))return!1;return!0}var Ri=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function IV(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Fd=class{},de=class n extends Fd{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new fy(e,t,r):t==="array-contains"?new my(e,r):t==="in"?new Ld(e,r):t==="not-in"?new yy(e,r):t==="array-contains-any"?new vy(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new py(e,r):new gy(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Pr(t,this.value)):t!==null&&Si(this.value)===Si(t)&&this.matchesComparison(Pr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return H()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},we=class n extends Fd{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return ds(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function ds(n){return n.op==="and"}function dy(n){return n.op==="or"}function e_(n){return ES(n)&&ds(n)}function ES(n){for(let e of n.filters)if(e instanceof we)return!1;return!0}function hy(n){if(n instanceof de)return n.field.canonicalString()+n.op.toString()+ls(n.value);if(e_(n))return n.filters.map(e=>hy(e)).join(",");{let e=n.filters.map(t=>hy(t)).join(",");return`${n.op}(${e})`}}function DS(n,e){return n instanceof de?function(r,i){return i instanceof de&&r.op===i.op&&r.field.isEqual(i.field)&&Cn(r.value,i.value)}(n,e):n instanceof we?function(r,i){return i instanceof we&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,s,a)=>o&&DS(s,i.filters[a]),!0):!1}(n,e):void H()}function TS(n,e){let t=n.filters.concat(e);return we.create(t,n.op)}function CS(n){return n instanceof de?function(t){return`${t.field.canonicalString()} ${t.op} ${ls(t.value)}`}(n):n instanceof we?function(t){return t.op.toString()+" {"+t.getFilters().map(CS).join(" ,")+"}"}(n):"Filter"}var fy=class extends de{constructor(e,t,r){super(e,t,r),this.key=B.fromName(r.referenceValue)}matches(e){let t=B.comparator(e.key,this.key);return this.matchesComparison(t)}},py=class extends de{constructor(e,t){super(e,"in",t),this.keys=bS("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},gy=class extends de{constructor(e,t){super(e,"not-in",t),this.keys=bS("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function bS(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>B.fromName(r.referenceValue))}var my=class extends de{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return fu(t)&&hu(t.arrayValue,this.value)}},Ld=class extends de{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&hu(this.value.arrayValue,t)}},yy=class extends de{constructor(e,t){super(e,"not-in",t)}matches(e){if(hu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!hu(this.value.arrayValue,t)}},vy=class extends de{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!fu(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>hu(this.value.arrayValue,r))}};var _y=class{constructor(e,t=null,r=[],i=[],o=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=s,this.endAt=a,this.ue=null}};function wy(n,e=null,t=[],r=[],i=null,o=null,s=null){return new _y(n,e,t,r,i,o,s)}function xi(n){let e=j(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>hy(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),xu(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>ls(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>ls(r)).join(",")),e.ue=t}return e.ue}function Mu(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!IV(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!DS(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!mb(n.startAt,e.startAt)&&mb(n.endAt,e.endAt)}function Vd(n){return B.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function jd(n,e){return n.filters.filter(t=>t instanceof de&&t.field.isEqual(e))}function yb(n,e,t){let r=Cd,i=!0;for(let o of jd(n,e)){let s=Cd,a=!0;switch(o.op){case"<":case"<=":s=_V(o.value);break;case"==":case"in":case">=":s=o.value;break;case">":s=o.value,a=!1;break;case"!=":case"not-in":s=Cd}fb({value:r,inclusive:i},{value:s,inclusive:a})<0&&(r=s,i=a)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){let s=t.position[o];fb({value:r,inclusive:i},{value:s,inclusive:t.inclusive})<0&&(r=s,i=t.inclusive);break}}return{value:r,inclusive:i}}function vb(n,e,t){let r=Rr,i=!0;for(let o of jd(n,e)){let s=Rr,a=!0;switch(o.op){case">=":case">":s=wV(o.value),a=!1;break;case"==":case"in":case"<=":s=o.value;break;case"<":s=o.value,a=!1;break;case"!=":case"not-in":s=Rr}pb({value:r,inclusive:i},{value:s,inclusive:a})>0&&(r=s,i=a)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){let s=t.position[o];pb({value:r,inclusive:i},{value:s,inclusive:t.inclusive})>0&&(r=s,i=t.inclusive);break}}return{value:r,inclusive:i}}var nn=class{constructor(e,t=null,r=[],i=[],o=null,s="F",a=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function SS(n,e,t,r,i,o,s,a){return new nn(n,e,t,r,i,o,s,a)}function bs(n){return new nn(n)}function _b(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function t_(n){return n.collectionGroup!==null}function is(n){let e=j(n);if(e.ce===null){e.ce=[];let t=new Set;for(let o of e.explicitOrderBy)e.ce.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let a=new Ce(tt.comparator);return s.filters.forEach(u=>{u.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.ce.push(new Ri(o,r))}),t.has(tt.keyField().canonicalString())||e.ce.push(new Ri(tt.keyField(),r))}return e.ce}function bt(n){let e=j(n);return e.le||(e.le=EV(e,is(n))),e.le}function EV(n,e){if(n.limitType==="F")return wy(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new Ri(i.field,o)});let t=n.endAt?new bn(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new bn(n.startAt.position,n.startAt.inclusive):null;return wy(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Iy(n,e){let t=n.filters.concat([e]);return new nn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Ud(n,e,t){return new nn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Nu(n,e){return Mu(bt(n),bt(e))&&n.limitType===e.limitType}function AS(n){return`${xi(bt(n))}|lt:${n.limitType}`}function Jo(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>CS(i)).join(", ")}]`),xu(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>ls(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>ls(i)).join(",")),`Target(${r})`}(bt(n))}; limitType=${n.limitType})`}function Pu(n,e){return e.isFoundDocument()&&function(r,i){let o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):B.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(n,e)&&function(r,i){for(let o of is(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let o of r.filters)if(!o.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(s,a,u){let l=gb(s,a,u);return s.inclusive?l<=0:l<0}(r.startAt,is(r),i)||r.endAt&&!function(s,a,u){let l=gb(s,a,u);return s.inclusive?l>=0:l>0}(r.endAt,is(r),i))}(n,e)}function RS(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function xS(n){return(e,t)=>{let r=!1;for(let i of is(n)){let o=DV(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function DV(n,e,t){let r=n.field.isKeyField()?B.comparator(e.key,t.key):function(o,s,a){let u=s.data.field(o),l=a.data.field(o);return u!==null&&l!==null?Pr(u,l):H()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return H()}}var Sn=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Li(this.inner,(t,r)=>{for(let[i,o]of r)e(i,o)})}isEmpty(){return vS(this.inner)}size(){return this.innerSize}};var TV=new Ae(B.comparator);function kt(){return TV}var MS=new Ae(B.comparator);function tu(...n){let e=MS;for(let t of n)e=e.insert(t.key,t);return e}function NS(n){let e=MS;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function In(){return iu()}function PS(){return iu()}function iu(){return new Sn(n=>n.toString(),(n,e)=>n.isEqual(e))}var CV=new Ae(B.comparator),bV=new Ce(B.comparator);function ne(...n){let e=bV;for(let t of n)e=e.add(t);return e}var SV=new Ce(te);function n_(){return SV}function r_(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:cu(e)?"-0":e}}function kS(n){return{integerValue:""+n}}function OS(n,e){return fS(e)?kS(e):r_(n,e)}var hs=class{constructor(){this._=void 0}};function AV(n,e,t){return n instanceof kr?function(i,o){let s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&bh(o)&&(o=Xv(o)),o&&(s.fields.__previous_value__=o),{mapValue:s}}(t,e):n instanceof Yn?LS(n,e):n instanceof Zn?VS(n,e):function(i,o){let s=FS(i,o),a=wb(s)+wb(i.Pe);return ly(s)&&ly(i.Pe)?kS(a):r_(i.serializer,a)}(n,e)}function RV(n,e,t){return n instanceof Yn?LS(n,e):n instanceof Zn?VS(n,e):t}function FS(n,e){return n instanceof Or?function(r){return ly(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}var kr=class extends hs{},Yn=class extends hs{constructor(e){super(),this.elements=e}};function LS(n,e){let t=jS(e);for(let r of n.elements)t.some(i=>Cn(i,r))||t.push(r);return{arrayValue:{values:t}}}var Zn=class extends hs{constructor(e){super(),this.elements=e}};function VS(n,e){let t=jS(e);for(let r of n.elements)t=t.filter(i=>!Cn(i,r));return{arrayValue:{values:t}}}var Or=class extends hs{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function wb(n){return xe(n.integerValue||n.doubleValue)}function jS(n){return fu(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var Mi=class{constructor(e,t){this.field=e,this.transform=t}};function xV(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Yn&&i instanceof Yn||r instanceof Zn&&i instanceof Zn?as(r.elements,i.elements,Cn):r instanceof Or&&i instanceof Or?Cn(r.Pe,i.Pe):r instanceof kr&&i instanceof kr}(n.transform,e.transform)}var Ey=class{constructor(e,t){this.version=e,this.transformResults=t}},Oe=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Sd(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var fs=class{};function US(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Lr(n.key,Oe.none()):new Fr(n.key,n.data,Oe.none());{let t=n.data,r=gt.empty(),i=new Ce(tt.comparator);for(let o of e.fields)if(!i.has(o)){let s=t.field(o);s===null&&o.length>1&&(o=o.popLast(),s=t.field(o)),s===null?r.delete(o):r.set(o,s),i=i.add(o)}return new rn(n.key,r,new Ut(i.toArray()),Oe.none())}}function MV(n,e,t){n instanceof Fr?function(i,o,s){let a=i.value.clone(),u=Eb(i.fieldTransforms,o,s.transformResults);a.setAll(u),o.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(n,e,t):n instanceof rn?function(i,o,s){if(!Sd(i.precondition,o))return void o.convertToUnknownDocument(s.version);let a=Eb(i.fieldTransforms,o,s.transformResults),u=o.data;u.setAll(BS(i)),u.setAll(a),o.convertToFoundDocument(s.version,u).setHasCommittedMutations()}(n,e,t):function(i,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,t)}function ou(n,e,t,r){return n instanceof Fr?function(o,s,a,u){if(!Sd(o.precondition,s))return a;let l=o.value.clone(),h=Db(o.fieldTransforms,u,s);return l.setAll(h),s.convertToFoundDocument(s.version,l).setHasLocalMutations(),null}(n,e,t,r):n instanceof rn?function(o,s,a,u){if(!Sd(o.precondition,s))return a;let l=Db(o.fieldTransforms,u,s),h=s.data;return h.setAll(BS(o)),h.setAll(l),s.convertToFoundDocument(s.version,h).setHasLocalMutations(),a===null?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(p=>p.field))}(n,e,t,r):function(o,s,a){return Sd(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a}(n,e,t)}function NV(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),o=FS(r.transform,i||null);o!=null&&(t===null&&(t=gt.empty()),t.set(r.field,o))}return t||null}function Ib(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&as(r,i,(o,s)=>xV(o,s))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Fr=class extends fs{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},rn=class extends fs{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function BS(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function Eb(n,e,t){let r=new Map;z(n.length===t.length);for(let i=0;i<t.length;i++){let o=n[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,RV(s,a,t[i]))}return r}function Db(n,e,t){let r=new Map;for(let i of n){let o=i.transform,s=t.data.field(i.field);r.set(i.field,AV(o,s,e))}return r}var Lr=class extends fs{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},pu=class extends fs{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var gu=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&MV(o,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=ou(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=ou(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=PS();return this.mutations.forEach(i=>{let o=e.get(i.key),s=o.overlayedDocument,a=this.applyToLocalView(s,o.mutatedFields);a=t.has(i.key)?null:a;let u=US(s,a);u!==null&&r.set(i.key,u),s.isValidDocument()||s.convertToNoDocument(W.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ne())}isEqual(e){return this.batchId===e.batchId&&as(this.mutations,e.mutations,(t,r)=>Ib(t,r))&&as(this.baseMutations,e.baseMutations,(t,r)=>Ib(t,r))}},Dy=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){z(e.mutations.length===r.length);let i=function(){return CV}(),o=e.mutations;for(let s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new n(e,t,r,i)}};var mu=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Ty=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var ze,fe;function $S(n){switch(n){default:return H();case N.CANCELLED:case N.UNKNOWN:case N.DEADLINE_EXCEEDED:case N.RESOURCE_EXHAUSTED:case N.INTERNAL:case N.UNAVAILABLE:case N.UNAUTHENTICATED:return!1;case N.INVALID_ARGUMENT:case N.NOT_FOUND:case N.ALREADY_EXISTS:case N.PERMISSION_DENIED:case N.FAILED_PRECONDITION:case N.ABORTED:case N.OUT_OF_RANGE:case N.UNIMPLEMENTED:case N.DATA_LOSS:return!0}}function HS(n){if(n===void 0)return Ve("GRPC error has no .code"),N.UNKNOWN;switch(n){case ze.OK:return N.OK;case ze.CANCELLED:return N.CANCELLED;case ze.UNKNOWN:return N.UNKNOWN;case ze.DEADLINE_EXCEEDED:return N.DEADLINE_EXCEEDED;case ze.RESOURCE_EXHAUSTED:return N.RESOURCE_EXHAUSTED;case ze.INTERNAL:return N.INTERNAL;case ze.UNAVAILABLE:return N.UNAVAILABLE;case ze.UNAUTHENTICATED:return N.UNAUTHENTICATED;case ze.INVALID_ARGUMENT:return N.INVALID_ARGUMENT;case ze.NOT_FOUND:return N.NOT_FOUND;case ze.ALREADY_EXISTS:return N.ALREADY_EXISTS;case ze.PERMISSION_DENIED:return N.PERMISSION_DENIED;case ze.FAILED_PRECONDITION:return N.FAILED_PRECONDITION;case ze.ABORTED:return N.ABORTED;case ze.OUT_OF_RANGE:return N.OUT_OF_RANGE;case ze.UNIMPLEMENTED:return N.UNIMPLEMENTED;case ze.DATA_LOSS:return N.DATA_LOSS;default:return H()}}(fe=ze||(ze={}))[fe.OK=0]="OK",fe[fe.CANCELLED=1]="CANCELLED",fe[fe.UNKNOWN=2]="UNKNOWN",fe[fe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",fe[fe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",fe[fe.NOT_FOUND=5]="NOT_FOUND",fe[fe.ALREADY_EXISTS=6]="ALREADY_EXISTS",fe[fe.PERMISSION_DENIED=7]="PERMISSION_DENIED",fe[fe.UNAUTHENTICATED=16]="UNAUTHENTICATED",fe[fe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",fe[fe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",fe[fe.ABORTED=10]="ABORTED",fe[fe.OUT_OF_RANGE=11]="OUT_OF_RANGE",fe[fe.UNIMPLEMENTED=12]="UNIMPLEMENTED",fe[fe.INTERNAL=13]="INTERNAL",fe[fe.UNAVAILABLE=14]="UNAVAILABLE",fe[fe.DATA_LOSS=15]="DATA_LOSS";var Tb=null;function qS(){return new TextEncoder}var PV=new Tr([4294967295,4294967295],0);function Cb(n){let e=qS().encode(n),t=new jm;return t.update(e),new Uint8Array(t.digest())}function bb(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Tr([t,r],0),new Tr([i,o],0)]}var Cy=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Ci(`Invalid padding: ${t}`);if(r<0)throw new Ci(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ci(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Ci(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Tr.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(Tr.fromNumber(r)));return i.compare(PV)===1&&(i=new Tr([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=Cb(e),[r,i]=bb(t);for(let o=0;o<this.hashCount;o++){let s=this.Ee(r,i,o);if(!this.de(s))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new n(o,i,t);return r.forEach(a=>s.insert(a)),s}insert(e){if(this.Ie===0)return;let t=Cb(e),[r,i]=bb(t);for(let o=0;o<this.hashCount;o++){let s=this.Ee(r,i,o);this.Ae(s)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Ci=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var yu=class n{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,vu.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(W.min(),i,new Ae(te),kt(),ne())}},vu=class n{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,ne(),ne(),ne())}};var os=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},Bd=class{constructor(e,t){this.targetId=e,this.me=t}},$d=class{constructor(e,t,r=$e.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Hd=class{constructor(){this.fe=0,this.ge=Ab(),this.pe=$e.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ne(),t=ne(),r=ne();return this.ge.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:H()}}),new vu(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=Ab()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,z(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},by=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=kt(),this.qe=Sb(),this.Qe=new Ae(te)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:H()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let o=i.target;if(Vd(o))if(r===0){let s=new B(o.path);this.Ue(t,s,Ke.newNoDocument(s,W.min()))}else z(r===1);else{let s=this.Ye(t);if(s!==r){let a=this.Ze(e),u=a?this.Xe(a,e,s):1;if(u!==0){this.je(t);let l=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,l)}Tb?.et(function(h,p,m,y,D){var R,S,O,U,V,q;let re={localCacheCount:h,existenceFilterCount:p.count,databaseId:m.database,projectId:m.projectId},G=p.unchangedNames;return G&&(re.bloomFilter={applied:D===0,hashCount:(R=G?.hashCount)!==null&&R!==void 0?R:0,bitmapLength:(U=(O=(S=G?.bits)===null||S===void 0?void 0:S.bitmap)===null||O===void 0?void 0:O.length)!==null&&U!==void 0?U:0,padding:(q=(V=G?.bits)===null||V===void 0?void 0:V.padding)!==null&&q!==void 0?q:0,mightContain:I=>{var v;return(v=y?.mightContain(I))!==null&&v!==void 0&&v}}),re}(s,e.me,this.Le.tt(),a,u))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t,s,a;try{s=Nr(r).toUint8Array()}catch(u){if(u instanceof Od)return Kn("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new Cy(s,i,o)}catch(u){return Kn(u instanceof Ci?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(o=>{let s=this.Le.tt(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,o,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((o,s)=>{let a=this.Je(s);if(a){if(o.current&&Vd(a.target)){let u=new B(a.target.path);this.ke.get(u)!==null||this.it(s,u)||this.Ue(s,u,Ke.newNoDocument(u,e))}o.be&&(t.set(s,o.ve()),o.Ce())}});let r=ne();this.qe.forEach((o,s)=>{let a=!0;s.forEachWhile(u=>{let l=this.Je(u);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(o))}),this.ke.forEach((o,s)=>s.setReadTime(e));let i=new yu(e,t,this.Qe,this.ke,r);return this.ke=kt(),this.qe=Sb(),this.Qe=new Ae(te),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Hd,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Ce(te),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||P("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Hd),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function Sb(){return new Ae(B.comparator)}function Ab(){return new Ae(B.comparator)}var kV={asc:"ASCENDING",desc:"DESCENDING"},OV={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},FV={and:"AND",or:"OR"},Sy=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Ay(n,e){return n.useProto3Json||xu(e)?e:{value:e}}function ps(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function zS(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function LV(n,e){return ps(n,e.toTimestamp())}function Ue(n){return z(!!n),W.fromTimestamp(function(t){let r=Qn(t);return new je(r.seconds,r.nanos)}(n))}function i_(n,e){return Ry(n,e).canonicalString()}function Ry(n,e){let t=function(i){return new pe(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function GS(n){let e=pe.fromString(n);return z(n0(e)),e}function _u(n,e){return i_(n.databaseId,e.path)}function Dn(n,e){let t=GS(e);if(t.get(1)!==n.databaseId.projectId)throw new k(N.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new k(N.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new B(QS(t))}function WS(n,e){return i_(n.databaseId,e)}function KS(n){let e=GS(n);return e.length===4?pe.emptyPath():QS(e)}function xy(n){return new pe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function QS(n){return z(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Rb(n,e,t){return{name:_u(n,e),fields:t.value.mapValue.fields}}function YS(n,e,t){let r=Dn(n,e.name),i=Ue(e.updateTime),o=e.createTime?Ue(e.createTime):W.min(),s=new gt({mapValue:{fields:e.fields}}),a=Ke.newFoundDocument(r,i,o,s);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function VV(n,e){return"found"in e?function(r,i){z(!!i.found),i.found.name,i.found.updateTime;let o=Dn(r,i.found.name),s=Ue(i.found.updateTime),a=i.found.createTime?Ue(i.found.createTime):W.min(),u=new gt({mapValue:{fields:i.found.fields}});return Ke.newFoundDocument(o,s,a,u)}(n,e):"missing"in e?function(r,i){z(!!i.missing),z(!!i.readTime);let o=Dn(r,i.missing),s=Ue(i.readTime);return Ke.newNoDocument(o,s)}(n,e):H()}function jV(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:H()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(l,h){return l.useProto3Json?(z(h===void 0||typeof h=="string"),$e.fromBase64String(h||"")):(z(h===void 0||h instanceof Buffer||h instanceof Uint8Array),$e.fromUint8Array(h||new Uint8Array))}(n,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&function(l){let h=l.code===void 0?N.UNKNOWN:HS(l.code);return new k(h,l.message||"")}(s);t=new $d(r,i,o,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Dn(n,r.document.name),o=Ue(r.document.updateTime),s=r.document.createTime?Ue(r.document.createTime):W.min(),a=new gt({mapValue:{fields:r.document.fields}}),u=Ke.newFoundDocument(i,o,s,a),l=r.targetIds||[],h=r.removedTargetIds||[];t=new os(l,h,u.key,u)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Dn(n,r.document),o=r.readTime?Ue(r.readTime):W.min(),s=Ke.newNoDocument(i,o),a=r.removedTargetIds||[];t=new os([],a,s.key,s)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Dn(n,r.document),o=r.removedTargetIds||[];t=new os([],o,i,null)}else{if(!("filter"in e))return H();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:o}=r,s=new Ty(i,o),a=r.targetId;t=new Bd(a,s)}}return t}function wu(n,e){let t;if(e instanceof Fr)t={update:Rb(n,e.key,e.value)};else if(e instanceof Lr)t={delete:_u(n,e.key)};else if(e instanceof rn)t={update:Rb(n,e.key,e.data),updateMask:zV(e.fieldMask)};else{if(!(e instanceof pu))return H();t={verify:_u(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(o,s){let a=s.transform;if(a instanceof kr)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Yn)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Zn)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Or)return{fieldPath:s.field.canonicalString(),increment:a.Pe};throw H()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:LV(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:H()}(n,e.precondition)),t}function My(n,e){let t=e.currentDocument?function(o){return o.updateTime!==void 0?Oe.updateTime(Ue(o.updateTime)):o.exists!==void 0?Oe.exists(o.exists):Oe.none()}(e.currentDocument):Oe.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(s,a){let u=null;if("setToServerValue"in a)z(a.setToServerValue==="REQUEST_TIME"),u=new kr;else if("appendMissingElements"in a){let h=a.appendMissingElements.values||[];u=new Yn(h)}else if("removeAllFromArray"in a){let h=a.removeAllFromArray.values||[];u=new Zn(h)}else"increment"in a?u=new Or(s,a.increment):H();let l=tt.fromServerFormat(a.fieldPath);return new Mi(l,u)}(n,i)):[];if(e.update){e.update.name;let i=Dn(n,e.update.name),o=new gt({mapValue:{fields:e.update.fields}});if(e.updateMask){let s=function(u){let l=u.fieldPaths||[];return new Ut(l.map(h=>tt.fromServerFormat(h)))}(e.updateMask);return new rn(i,o,s,t,r)}return new Fr(i,o,t,r)}if(e.delete){let i=Dn(n,e.delete);return new Lr(i,t)}if(e.verify){let i=Dn(n,e.verify);return new pu(i,t)}return H()}function UV(n,e){return n&&n.length>0?(z(e!==void 0),n.map(t=>function(i,o){let s=i.updateTime?Ue(i.updateTime):Ue(o);return s.isEqual(W.min())&&(s=Ue(o)),new Ey(s,i.transformResults||[])}(t,e))):[]}function ZS(n,e){return{documents:[WS(n,e.path)]}}function JS(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=WS(n,i);let o=function(l){if(l.length!==0)return t0(we.create(l,"and"))}(e.filters);o&&(t.structuredQuery.where=o);let s=function(l){if(l.length!==0)return l.map(h=>function(m){return{field:Xo(m.field),direction:$V(m.dir)}}(h))}(e.orderBy);s&&(t.structuredQuery.orderBy=s);let a=Ay(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{_t:t,parent:i}}function XS(n){let e=KS(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){z(r===1);let h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let o=[];t.where&&(o=function(p){let m=e0(p);return m instanceof we&&e_(m)?m.getFilters():[m]}(t.where));let s=[];t.orderBy&&(s=function(p){return p.map(m=>function(D){return new Ri(es(D.field),function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(D.direction))}(m))}(t.orderBy));let a=null;t.limit&&(a=function(p){let m;return m=typeof p=="object"?p.value:p,xu(m)?null:m}(t.limit));let u=null;t.startAt&&(u=function(p){let m=!!p.before,y=p.values||[];return new bn(y,m)}(t.startAt));let l=null;return t.endAt&&(l=function(p){let m=!p.before,y=p.values||[];return new bn(y,m)}(t.endAt)),SS(e,i,s,o,a,"F",u,l)}function BV(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return H()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function e0(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=es(t.unaryFilter.field);return de.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=es(t.unaryFilter.field);return de.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=es(t.unaryFilter.field);return de.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let s=es(t.unaryFilter.field);return de.create(s,"!=",{nullValue:"NULL_VALUE"});default:return H()}}(n):n.fieldFilter!==void 0?function(t){return de.create(es(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return H()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return we.create(t.compositeFilter.filters.map(r=>e0(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return H()}}(t.compositeFilter.op))}(n):H()}function $V(n){return kV[n]}function HV(n){return OV[n]}function qV(n){return FV[n]}function Xo(n){return{fieldPath:n.canonicalString()}}function es(n){return tt.fromServerFormat(n.fieldPath)}function t0(n){return n instanceof de?function(t){if(t.op==="=="){if(hb(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NAN"}};if(db(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(hb(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NOT_NAN"}};if(db(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Xo(t.field),op:HV(t.op),value:t.value}}}(n):n instanceof we?function(t){let r=t.getFilters().map(i=>t0(i));return r.length===1?r[0]:{compositeFilter:{op:qV(t.op),filters:r}}}(n):H()}function zV(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function n0(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var gs=class n{constructor(e,t,r,i,o=W.min(),s=W.min(),a=$e.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var qd=class{constructor(e){this.ct=e}};function GV(n,e){let t;if(e.document)t=YS(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=B.fromSegments(e.noDocument.path),i=Pi(e.noDocument.readTime);t=Ke.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return H();{let r=B.fromSegments(e.unknownDocument.path),i=Pi(e.unknownDocument.version);t=Ke.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){let o=new je(i[0],i[1]);return W.fromTimestamp(o)}(e.readTime)),t}function xb(n,e){let t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:zd(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(o,s){return{name:_u(o,s.key),fields:s.data.value.mapValue.fields,updateTime:ps(o,s.version.toTimestamp()),createTime:ps(o,s.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Ni(e.version)};else{if(!e.isUnknownDocument())return H();r.unknownDocument={path:t.path.toArray(),version:Ni(e.version)}}return r}function zd(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Ni(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Pi(n){let e=new je(n.seconds,n.nanoseconds);return W.fromTimestamp(e)}function Ei(n,e){let t=(e.baseMutations||[]).map(o=>My(n.ct,o));for(let o=0;o<e.mutations.length-1;++o){let s=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){let a=e.mutations[o+1];s.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}let r=e.mutations.map(o=>My(n.ct,o)),i=je.fromMillis(e.localWriteTimeMs);return new gu(e.batchId,i,t,r)}function nu(n){let e=Pi(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Pi(n.lastLimboFreeSnapshotVersion):W.min(),r;return r=function(o){return o.documents!==void 0}(n.query)?function(o){return z(o.documents.length===1),bt(bs(KS(o.documents[0])))}(n.query):function(o){return bt(XS(o))}(n.query),new gs(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,$e.fromBase64String(n.resumeToken))}function r0(n,e){let t=Ni(e.snapshotVersion),r=Ni(e.lastLimboFreeSnapshotVersion),i;i=Vd(e.target)?ZS(n.ct,e.target):JS(n.ct,e.target)._t;let o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:xi(e.target),readTime:t,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function o_(n){let e=XS({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Ud(e,e.limit,"L"):e}function zm(n,e){return new mu(e.largestBatchId,My(n.ct,e.overlayMutation))}function Mb(n,e){let t=e.path.lastSegment();return[n,Ct(e.path.popLast()),t]}function Nb(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Ni(r.readTime),documentKey:Ct(r.documentKey.path),largestBatchId:r.largestBatchId}}var Ny=class{getBundleMetadata(e,t){return Pb(e).get(t).next(r=>{if(r)return function(o){return{id:o.bundleId,createTime:Pi(o.createTime),version:o.version}}(r)})}saveBundleMetadata(e,t){return Pb(e).put(function(i){return{bundleId:i.id,createTime:Ni(Ue(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return kb(e).get(t).next(r=>{if(r)return function(o){return{name:o.name,query:o_(o.bundledQuery),readTime:Pi(o.readTime)}}(r)})}saveNamedQuery(e,t){return kb(e).put(function(i){return{name:i.name,readTime:Ni(Ue(i.readTime)),bundledQuery:i.bundledQuery}}(t))}};function Pb(n){return nt(n,"bundles")}function kb(n){return nt(n,"namedQueries")}var Gd=class n{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){let r=t.uid||"";return new n(e,r)}getOverlay(e,t){return Za(e).get(Mb(this.userId,t)).next(r=>r?zm(this.serializer,r):null)}getOverlays(e,t){let r=In();return A.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){let i=[];return r.forEach((o,s)=>{let a=new mu(t,s);i.push(this.ht(e,a))}),A.waitFor(i)}removeOverlaysForBatchId(e,t,r){let i=new Set;t.forEach(s=>i.add(Ct(s.getCollectionPath())));let o=[];return i.forEach(s=>{let a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,r+1],!1,!0);o.push(Za(e).j("collectionPathOverlayIndex",a))}),A.waitFor(o)}getOverlaysForCollection(e,t,r){let i=In(),o=Ct(t),s=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,Number.POSITIVE_INFINITY],!0);return Za(e).U("collectionPathOverlayIndex",s).next(a=>{for(let u of a){let l=zm(this.serializer,u);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,t,r,i){let o=In(),s,a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Za(e).J({index:"collectionGroupOverlayIndex",range:a},(u,l,h)=>{let p=zm(this.serializer,l);o.size()<i||p.largestBatchId===s?(o.set(p.getKey(),p),s=p.largestBatchId):h.done()}).next(()=>o)}ht(e,t){return Za(e).put(function(i,o,s){let[a,u,l]=Mb(o,s.mutation.key);return{userId:o,collectionPath:u,documentId:l,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:wu(i.ct,s.mutation)}}(this.serializer,this.userId,t))}};function Za(n){return nt(n,"documentOverlays")}var Py=class{Pt(e){return nt(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{let r=t?.value;return r?$e.fromUint8Array(r):$e.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}};var Gn=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(xe(e.integerValue));else if("doubleValue"in e){let r=xe(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),cu(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=Qn(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Nr(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?_S(e)?this.dt(t,Number.MAX_SAFE_INTEGER):Sh(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):H()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let r=e.fields||{};this.dt(t,55);for(let i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;let o=e.fields||{};this.dt(t,53);let s="value",a=((i=(r=o[s].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(xe(a)),this.Vt(s,t),this.Tt(o[s],t)}bt(e,t){let r=e.values||[];this.dt(t,50);for(let i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),B.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};Gn.vt=new Gn;function WV(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function Ob(n){let e=64-function(r){let i=0;for(let o=0;o<8;++o){let s=WV(255&r[o]);if(i+=s,s!==8)break}return i}(n);return Math.ceil(e/8)}var ky=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ot(r.value),r=t.next();this.Nt()}Lt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{let i=t.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{let i=t.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){let t=this.qt(e),r=Ob(t);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Kt(e){let t=this.qt(e),r=Ob(t);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){let t=function(o){let s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,o,!1),new Uint8Array(s.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ft(e){let t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){let t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},Oy=class{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}},Fy=class{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}},Di=class{constructor(){this.jt=new ky,this.Ht=new Oy(this.jt),this.Jt=new Fy(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}};var Ti=class n{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Zt(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new n(this.indexId,this.documentKey,this.arrayValue,r)}};function Cr(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=Fb(n.arrayValue,e.arrayValue),t!==0?t:(t=Fb(n.directionalValue,e.directionalValue),t!==0?t:B.comparator(n.documentKey,e.documentKey)))}function Fb(n,e){for(let t=0;t<n.length&&t<e.length;++t){let r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}var Wd=class{constructor(e){this.Xt=new Ce((t,r)=>tt.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(let t of e.filters){let r=t;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(z(e.collectionGroup===this.collectionId),this.nn)return!1;let t=ry(e);if(t!==void 0&&!this.sn(t))return!1;let r=wi(e),i=new Set,o=0,s=0;for(;o<r.length&&this.sn(r[o]);++o)i=i.add(r[o].fieldPath.canonicalString());if(o===r.length)return!0;if(this.Xt.size>0){let a=this.Xt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let u=r[o];if(!this.on(a,u)||!this._n(this.en[s++],u))return!1}++o}for(;o<r.length;++o){let a=r[o];if(s>=this.en.length||!this._n(this.en[s++],a))return!1}return!0}an(){if(this.nn)return null;let e=new Ce(tt.comparator),t=[];for(let r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new rs(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new rs(r.field,0))}for(let r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new rs(r.field,r.dir==="asc"?0:1)));return new us(us.UNKNOWN_ID,this.collectionId,t,uu.empty())}sn(e){for(let t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function i0(n){var e,t;if(z(n instanceof de||n instanceof we),n instanceof de){if(n instanceof Ld){let i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(o=>de.create(n.field,"==",o)))||[];return we.create(i,"or")}return n}let r=n.filters.map(i=>i0(i));return we.create(r,n.op)}function KV(n){if(n.getFilters().length===0)return[];let e=jy(i0(n));return z(o0(e)),Ly(e)||Vy(e)?[e]:e.getFilters()}function Ly(n){return n instanceof de}function Vy(n){return n instanceof we&&e_(n)}function o0(n){return Ly(n)||Vy(n)||function(t){if(t instanceof we&&dy(t)){for(let r of t.getFilters())if(!Ly(r)&&!Vy(r))return!1;return!0}return!1}(n)}function jy(n){if(z(n instanceof de||n instanceof we),n instanceof de)return n;if(n.filters.length===1)return jy(n.filters[0]);let e=n.filters.map(r=>jy(r)),t=we.create(e,n.op);return t=Kd(t),o0(t)?t:(z(t instanceof we),z(ds(t)),z(t.filters.length>1),t.filters.reduce((r,i)=>s_(r,i)))}function s_(n,e){let t;return z(n instanceof de||n instanceof we),z(e instanceof de||e instanceof we),t=n instanceof de?e instanceof de?function(i,o){return we.create([i,o],"and")}(n,e):Lb(n,e):e instanceof de?Lb(e,n):function(i,o){if(z(i.filters.length>0&&o.filters.length>0),ds(i)&&ds(o))return TS(i,o.getFilters());let s=dy(i)?i:o,a=dy(i)?o:i,u=s.filters.map(l=>s_(l,a));return we.create(u,"or")}(n,e),Kd(t)}function Lb(n,e){if(ds(e))return TS(e,n.getFilters());{let t=e.filters.map(r=>s_(n,r));return we.create(t,"or")}}function Kd(n){if(z(n instanceof de||n instanceof we),n instanceof de)return n;let e=n.getFilters();if(e.length===1)return Kd(e[0]);if(ES(n))return n;let t=e.map(i=>Kd(i)),r=[];return t.forEach(i=>{i instanceof de?r.push(i):i instanceof we&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:we.create(r,n.op)}var Uy=class{constructor(){this.un=new Iu}addToCollectionParentIndex(e,t){return this.un.add(t),A.resolve()}getCollectionParents(e,t){return A.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return A.resolve()}deleteFieldIndex(e,t){return A.resolve()}deleteAllFieldIndexes(e){return A.resolve()}createTargetIndexes(e,t){return A.resolve()}getDocumentsMatchingTarget(e,t){return A.resolve(null)}getIndexType(e,t){return A.resolve(0)}getFieldIndexes(e,t){return A.resolve([])}getNextCollectionGroupToUpdate(e){return A.resolve(null)}getMinOffset(e,t){return A.resolve(Kt.min())}getMinOffsetFromCollectionGroup(e,t){return A.resolve(Kt.min())}updateCollectionGroup(e,t,r){return A.resolve()}updateIndexEntries(e,t){return A.resolve()}},Iu=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Ce(pe.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ce(pe.comparator)).toArray()}};var wd=new Uint8Array(0),By=class{constructor(e,t){this.databaseId=t,this.cn=new Iu,this.ln=new Sn(r=>xi(r),(r,i)=>Mu(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});let o={collectionId:r,parent:Ct(i)};return Vb(e).put(o)}return A.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[uS(t),""],!1,!0);return Vb(e).U(i).next(o=>{for(let s of o){if(s.collectionId!==t)break;r.push(wn(s.parent))}return r})}addFieldIndex(e,t){let r=Ja(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])}}(t);delete i.indexId;let o=r.add(i);if(t.indexState){let s=Qo(e);return o.next(a=>{s.put(Nb(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return o.next()}deleteFieldIndex(e,t){let r=Ja(e),i=Qo(e),o=Ko(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=Ja(e),r=Ko(e),i=Qo(e);return t.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,t){return A.forEach(this.hn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let o=new Wd(r).an();if(o!=null)return this.addFieldIndex(e,o)}}))}getDocumentsMatchingTarget(e,t){let r=Ko(e),i=!0,o=new Map;return A.forEach(this.hn(t),s=>this.Pn(e,s).next(a=>{i&&(i=!!a),o.set(s,a)})).next(()=>{if(i){let s=ne(),a=[];return A.forEach(o,(u,l)=>{P("IndexedDbIndexManager",`Using index ${function(V){return`id=${V.indexId}|cg=${V.collectionGroup}|f=${V.fields.map(q=>`${q.fieldPath}:${q.kind}`).join(",")}`}(u)} to execute ${xi(t)}`);let h=function(V,q){let re=ry(q);if(re===void 0)return null;for(let G of jd(V,re.fieldPath))switch(G.op){case"array-contains-any":return G.value.arrayValue.values||[];case"array-contains":return[G.value]}return null}(l,u),p=function(V,q){let re=new Map;for(let G of wi(q))for(let I of jd(V,G.fieldPath))switch(I.op){case"==":case"in":re.set(G.fieldPath.canonicalString(),I.value);break;case"not-in":case"!=":return re.set(G.fieldPath.canonicalString(),I.value),Array.from(re.values())}return null}(l,u),m=function(V,q){let re=[],G=!0;for(let I of wi(q)){let v=I.kind===0?yb(V,I.fieldPath,V.startAt):vb(V,I.fieldPath,V.startAt);re.push(v.value),G&&(G=v.inclusive)}return new bn(re,G)}(l,u),y=function(V,q){let re=[],G=!0;for(let I of wi(q)){let v=I.kind===0?vb(V,I.fieldPath,V.endAt):yb(V,I.fieldPath,V.endAt);re.push(v.value),G&&(G=v.inclusive)}return new bn(re,G)}(l,u),D=this.In(u,l,m),R=this.In(u,l,y),S=this.Tn(u,l,p),O=this.En(u.indexId,h,D,m.inclusive,R,y.inclusive,S);return A.forEach(O,U=>r.G(U,t.limit).next(V=>{V.forEach(q=>{let re=B.fromSegments(q.documentKey);s.has(re)||(s=s.add(re),a.push(re))})}))}).next(()=>a)}return A.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=KV(we.create(e.filters,"and")).map(r=>wy(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,r,i,o,s,a){let u=(t!=null?t.length:1)*Math.max(r.length,o.length),l=u/(t!=null?t.length:1),h=[];for(let p=0;p<u;++p){let m=t?this.dn(t[p/l]):wd,y=this.An(e,m,r[p%l],i),D=this.Rn(e,m,o[p%l],s),R=a.map(S=>this.An(e,m,S,!0));h.push(...this.createRange(y,D,R))}return h}An(e,t,r,i){let o=new Ti(e,B.empty(),t,r);return i?o:o.Zt()}Rn(e,t,r,i){let o=new Ti(e,B.empty(),t,r);return i?o.Zt():o}Pn(e,t){let r=new Wd(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(o=>{let s=null;for(let a of o)r.rn(a)&&(!s||a.fields.length>s.fields.length)&&(s=a);return s})}getIndexType(e,t){let r=2,i=this.hn(t);return A.forEach(i,o=>this.Pn(e,o).next(s=>{s?r!==0&&s.fields.length<function(u){let l=new Ce(tt.comparator),h=!1;for(let p of u.filters)for(let m of p.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:l=l.add(m.field));for(let p of u.orderBy)p.field.isKeyField()||(l=l.add(p.field));return l.size+(h?1:0)}(o)&&(r=1):r=0})).next(()=>function(s){return s.limit!==null}(t)&&i.length>1&&r===2?1:r)}Vn(e,t){let r=new Di;for(let i of wi(e)){let o=t.data.field(i.fieldPath);if(o==null)return null;let s=r.Yt(i.kind);Gn.vt.It(o,s)}return r.zt()}dn(e){let t=new Di;return Gn.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){let r=new Di;return Gn.vt.It(Ai(this.databaseId,t),r.Yt(function(o){let s=wi(o);return s.length===0?0:s[s.length-1].kind}(e))),r.zt()}Tn(e,t,r){if(r===null)return[];let i=[];i.push(new Di);let o=0;for(let s of wi(e)){let a=r[o++];for(let u of i)if(this.fn(t,s.fieldPath)&&fu(a))i=this.gn(i,s,a);else{let l=u.Yt(s.kind);Gn.vt.It(a,l)}}return this.pn(i)}In(e,t,r){return this.Tn(e,t,r.position)}pn(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].zt();return t}gn(e,t,r){let i=[...e],o=[];for(let s of r.arrayValue.values||[])for(let a of i){let u=new Di;u.seed(a.zt()),Gn.vt.It(s,u.Yt(t.kind)),o.push(u)}return o}fn(e,t){return!!e.filters.find(r=>r instanceof de&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){let r=Ja(e),i=Qo(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(o=>{let s=[];return A.forEach(o,a=>i.get([a.indexId,this.uid]).next(u=>{s.push(function(h,p){let m=p?new uu(p.sequenceNumber,new Kt(Pi(p.readTime),new B(wn(p.documentKey)),p.largestBatchId)):uu.empty(),y=h.fields.map(([D,R])=>new rs(tt.fromServerFormat(D),R));return new us(h.indexId,h.collectionGroup,y,m)}(a,u))})).next(()=>s)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{let o=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return o!==0?o:te(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){let i=Ja(e),o=Qo(e);return this.yn(e).next(s=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>A.forEach(a,u=>o.put(Nb(u.indexId,this.uid,s,r)))))}updateIndexEntries(e,t){let r=new Map;return A.forEach(t,(i,o)=>{let s=r.get(i.collectionGroup);return(s?A.resolve(s):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),A.forEach(a,u=>this.wn(e,i,u).next(l=>{let h=this.Sn(o,u);return l.isEqual(h)?A.resolve():this.bn(e,o,u,l,h)}))))})}Dn(e,t,r,i){return Ko(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,t.key),documentKey:t.key.path.toArray()})}vn(e,t,r,i){return Ko(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,t.key),t.key.path.toArray()])}wn(e,t,r){let i=Ko(e),o=new Ce(Cr);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,t)])},(s,a)=>{o=o.add(new Ti(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>o)}Sn(e,t){let r=new Ce(Cr),i=this.Vn(t,e);if(i==null)return r;let o=ry(t);if(o!=null){let s=e.data.field(o.fieldPath);if(fu(s))for(let a of s.arrayValue.values||[])r=r.add(new Ti(t.indexId,e.key,this.dn(a),i))}else r=r.add(new Ti(t.indexId,e.key,wd,i));return r}bn(e,t,r,i,o){P("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);let s=[];return function(u,l,h,p,m){let y=u.getIterator(),D=l.getIterator(),R=Wo(y),S=Wo(D);for(;R||S;){let O=!1,U=!1;if(R&&S){let V=h(R,S);V<0?U=!0:V>0&&(O=!0)}else R!=null?U=!0:O=!0;O?(p(S),S=Wo(D)):U?(m(R),R=Wo(y)):(R=Wo(y),S=Wo(D))}}(i,o,Cr,a=>{s.push(this.Dn(e,t,r,a))},a=>{s.push(this.vn(e,t,r,a))}),A.waitFor(s)}yn(e){let t=1;return Qo(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,o)=>{o.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((s,a)=>Cr(s,a)).filter((s,a,u)=>!a||Cr(s,u[a-1])!==0);let i=[];i.push(e);for(let s of r){let a=Cr(s,e),u=Cr(s,t);if(a===0)i[0]=e.Zt();else if(a>0&&u<0)i.push(s),i.push(s.Zt());else if(u>0)break}i.push(t);let o=[];for(let s=0;s<i.length;s+=2){if(this.Cn(i[s],i[s+1]))return[];let a=[i[s].indexId,this.uid,i[s].arrayValue,i[s].directionalValue,wd,[]],u=[i[s+1].indexId,this.uid,i[s+1].arrayValue,i[s+1].directionalValue,wd,[]];o.push(IDBKeyRange.bound(a,u))}return o}Cn(e,t){return Cr(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(jb)}getMinOffset(e,t){return A.mapArray(this.hn(t),r=>this.Pn(e,r).next(i=>i||H())).next(jb)}};function Vb(n){return nt(n,"collectionParents")}function Ko(n){return nt(n,"indexEntries")}function Ja(n){return nt(n,"indexConfiguration")}function Qo(n){return nt(n,"indexState")}function jb(n){z(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){let i=n[r].indexState.offset;Yv(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Kt(e.readTime,e.documentKey,t)}var Ub={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Wt=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function s0(n,e,t){let r=n.store("mutations"),i=n.store("documentMutations"),o=[],s=IDBKeyRange.only(t.batchId),a=0,u=r.J({range:s},(h,p,m)=>(a++,m.delete()));o.push(u.next(()=>{z(a===1)}));let l=[];for(let h of t.mutations){let p=pS(e,h.key.path,t.batchId);o.push(i.delete(p)),l.push(h.key)}return A.waitFor(o).next(()=>l)}function Qd(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw H();e=n.noDocument}return JSON.stringify(e).length}Wt.DEFAULT_COLLECTION_PERCENTILE=10,Wt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Wt.DEFAULT=new Wt(41943040,Wt.DEFAULT_COLLECTION_PERCENTILE,Wt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Wt.DISABLED=new Wt(-1,0,0);var Yd=class n{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,t,r,i){z(e.uid!=="");let o=e.isAuthenticated()?e.uid:"";return new n(o,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return br(e).J({index:"userMutationsIndex",range:r},(i,o,s)=>{t=!1,s.done()}).next(()=>t)}addMutationBatch(e,t,r,i){let o=ts(e),s=br(e);return s.add({}).next(a=>{z(typeof a=="number");let u=new gu(a,t,r,i),l=function(y,D,R){let S=R.baseMutations.map(U=>wu(y.ct,U)),O=R.mutations.map(U=>wu(y.ct,U));return{userId:D,batchId:R.batchId,localWriteTimeMs:R.localWriteTime.toMillis(),baseMutations:S,mutations:O}}(this.serializer,this.userId,u),h=[],p=new Ce((m,y)=>te(m.canonicalString(),y.canonicalString()));for(let m of i){let y=pS(this.userId,m.key.path,a);p=p.add(m.key.path.popLast()),h.push(s.put(l)),h.push(o.put(y,eV))}return p.forEach(m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Fn[a]=u.keys()}),A.waitFor(h).next(()=>u)})}lookupMutationBatch(e,t){return br(e).get(t).next(r=>r?(z(r.userId===this.userId),Ei(this.serializer,r)):null)}Mn(e,t){return this.Fn[t]?A.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){let i=r.keys();return this.Fn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return br(e).J({index:"userMutationsIndex",range:i},(s,a,u)=>{a.userId===this.userId&&(z(a.batchId>=r),o=Ei(this.serializer,a)),u.done()}).next(()=>o)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return br(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,o,s)=>{r=o.batchId,s.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return br(e).U("userMutationsIndex",t).next(r=>r.map(i=>Ei(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=Td(this.userId,t.path),i=IDBKeyRange.lowerBound(r),o=[];return ts(e).J({range:i},(s,a,u)=>{let[l,h,p]=s,m=wn(h);if(l===this.userId&&t.path.isEqual(m))return br(e).get(p).next(y=>{if(!y)throw H();z(y.userId===this.userId),o.push(Ei(this.serializer,y))});u.done()}).next(()=>o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ce(te),i=[];return t.forEach(o=>{let s=Td(this.userId,o.path),a=IDBKeyRange.lowerBound(s),u=ts(e).J({range:a},(l,h,p)=>{let[m,y,D]=l,R=wn(y);m===this.userId&&o.path.isEqual(R)?r=r.add(D):p.done()});i.push(u)}),A.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=Td(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new Ce(te);return ts(e).J({range:s},(u,l,h)=>{let[p,m,y]=u,D=wn(m);p===this.userId&&r.isPrefixOf(D)?D.length===i&&(a=a.add(y)):h.done()}).next(()=>this.xn(e,a))}xn(e,t){let r=[],i=[];return t.forEach(o=>{i.push(br(e).get(o).next(s=>{if(s===null)throw H();z(s.userId===this.userId),r.push(Ei(this.serializer,s))}))}),A.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return s0(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),A.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return A.resolve();let r=IDBKeyRange.lowerBound(function(s){return[s]}(this.userId)),i=[];return ts(e).J({range:r},(o,s,a)=>{if(o[0]===this.userId){let u=wn(o[1]);i.push(u)}else a.done()}).next(()=>{z(i.length===0)})})}containsKey(e,t){return a0(e,this.userId,t)}Nn(e){return u0(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function a0(n,e,t){let r=Td(e,t.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return ts(n).J({range:o,H:!0},(a,u,l)=>{let[h,p,m]=a;h===e&&p===i&&(s=!0),l.done()}).next(()=>s)}function br(n){return nt(n,"mutations")}function ts(n){return nt(n,"documentMutations")}function u0(n){return nt(n,"mutationQueues")}var ms=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var $y=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{let r=new ms(t.highestTargetId);return t.highestTargetId=r.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>W.fromTimestamp(new je(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Qn(e,i)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(t,r),this.Qn(e,r))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Yo(e).delete(t.targetId)).next(()=>this.qn(e)).next(r=>(z(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,t,r){let i=0,o=[];return Yo(e).J((s,a)=>{let u=nu(a);u.sequenceNumber<=t&&r.get(u.targetId)===null&&(i++,o.push(this.removeTargetData(e,u)))}).next(()=>A.waitFor(o)).next(()=>i)}forEachTarget(e,t){return Yo(e).J((r,i)=>{let o=nu(i);t(o)})}qn(e){return Bb(e).get("targetGlobalKey").next(t=>(z(t!==null),t))}Qn(e,t){return Bb(e).put("targetGlobalKey",t)}Kn(e,t){return Yo(e).put(r0(this.serializer,t))}$n(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){let r=xi(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return Yo(e).J({range:i,index:"queryTargetsIndex"},(s,a,u)=>{let l=nu(a);Mu(t,l.target)&&(o=l,u.done())}).next(()=>o)}addMatchingKeys(e,t,r){let i=[],o=Sr(e);return t.forEach(s=>{let a=Ct(s.path);i.push(o.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,s))}),A.waitFor(i)}removeMatchingKeys(e,t,r){let i=Sr(e);return A.forEach(t,o=>{let s=Ct(o.path);return A.waitFor([i.delete([r,s]),this.referenceDelegate.removeReference(e,r,o)])})}removeMatchingKeysForTargetId(e,t){let r=Sr(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Sr(e),o=ne();return i.J({range:r,H:!0},(s,a,u)=>{let l=wn(s[1]),h=new B(l);o=o.add(h)}).next(()=>o)}containsKey(e,t){let r=Ct(t.path),i=IDBKeyRange.bound([r],[uS(r)],!1,!0),o=0;return Sr(e).J({index:"documentTargetsIndex",H:!0,range:i},([s,a],u,l)=>{s!==0&&(o++,l.done())}).next(()=>o>0)}ot(e,t){return Yo(e).get(t).next(r=>r?nu(r):null)}};function Yo(n){return nt(n,"targets")}function Bb(n){return nt(n,"targetGlobal")}function Sr(n){return nt(n,"targetDocuments")}function $b([n,e],[t,r]){let i=te(n,t);return i===0?te(e,r):i}var Hy=class{constructor(e){this.Un=e,this.buffer=new Ce($b),this.Wn=0}Gn(){return++this.Wn}zn(e){let t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();$b(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},qy=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){P("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>x(this,null,function*(){this.jn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){Hr(t)?P("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield $r(t)}yield this.Hn(3e5)}))}},zy=class{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return A.resolve(jt.oe);let r=new Hy(t);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(P("LruGarbageCollector","Garbage collection skipped; disabled"),A.resolve(Ub)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(P("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ub):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let r,i,o,s,a,u,l,h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(P("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,s=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(r=p,a=Date.now(),this.removeTargets(e,r,t))).next(p=>(o=p,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(l=Date.now(),Zo()<=sn.DEBUG&&P("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-h}ms
	Determined least recently used ${i} in `+(a-s)+`ms
	Removed ${o} targets in `+(u-a)+`ms
	Removed ${p} documents in `+(l-u)+`ms
Total Duration: ${l-h}ms`),A.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:p})))}};function QV(n,e){return new zy(n,e)}var Gy=class{constructor(e,t){this.db=e,this.garbageCollector=QV(this,t)}Yn(e){let t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(r,i)=>t(i))}addReference(e,t,r){return Id(e,r)}removeReference(e,t,r){return Id(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Id(e,t)}nr(e,t){return function(i,o){let s=!1;return u0(i).Y(a=>a0(i,a,o).next(u=>(u&&(s=!0),A.resolve(!u)))).next(()=>s)}(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.tr(e,(s,a)=>{if(a<=t){let u=this.nr(e,s).next(l=>{if(!l)return o++,r.getEntry(e,s).next(()=>(r.removeEntry(s,W.min()),Sr(e).delete(function(p){return[0,Ct(p.path)]}(s))))});i.push(u)}}).next(()=>A.waitFor(i)).next(()=>r.apply(e)).next(()=>o)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Id(e,t)}tr(e,t){let r=Sr(e),i,o=jt.oe;return r.J({index:"documentTargetsIndex"},([s,a],{path:u,sequenceNumber:l})=>{s===0?(o!==jt.oe&&t(new B(wn(i)),o),o=l,i=u):o=jt.oe}).next(()=>{o!==jt.oe&&t(new B(wn(i)),o)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function Id(n,e){return Sr(n).put(function(r,i){return{targetId:0,path:Ct(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}var Zd=class{constructor(){this.changes=new Sn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ke.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?A.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Wy=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return _i(e).put(r)}removeEntry(e,t,r){return _i(e).delete(function(o,s){let a=o.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],zd(s),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.rr(e,r)))}getEntry(e,t){let r=Ke.newInvalidDocument(t);return _i(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Xa(t))},(i,o)=>{r=this.ir(t,o)}).next(()=>r)}sr(e,t){let r={size:0,document:Ke.newInvalidDocument(t)};return _i(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Xa(t))},(i,o)=>{r={document:this.ir(t,o),size:Qd(o)}}).next(()=>r)}getEntries(e,t){let r=kt();return this._r(e,t,(i,o)=>{let s=this.ir(i,o);r=r.insert(i,s)}).next(()=>r)}ar(e,t){let r=kt(),i=new Ae(B.comparator);return this._r(e,t,(o,s)=>{let a=this.ir(o,s);r=r.insert(o,a),i=i.insert(o,Qd(s))}).next(()=>({documents:r,ur:i}))}_r(e,t,r){if(t.isEmpty())return A.resolve();let i=new Ce(zb);t.forEach(u=>i=i.add(u));let o=IDBKeyRange.bound(Xa(i.first()),Xa(i.last())),s=i.getIterator(),a=s.getNext();return _i(e).J({index:"documentKeyIndex",range:o},(u,l,h)=>{let p=B.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&zb(a,p)<0;)r(a,null),a=s.getNext();a&&a.isEqual(p)&&(r(a,l),a=s.hasNext()?s.getNext():null),a?h.$(Xa(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,o){let s=t.path,a=[s.popLast().toArray(),s.lastSegment(),zd(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return _i(e).U(IDBKeyRange.bound(a,u,!0)).next(l=>{o?.incrementDocumentReadCount(l.length);let h=kt();for(let p of l){let m=this.ir(B.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(Pu(t,m)||i.has(m.key))&&(h=h.insert(m.key,m))}return h})}getAllFromCollectionGroup(e,t,r,i){let o=kt(),s=qb(t,r),a=qb(t,Kt.max());return _i(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(s,a,!0)},(u,l,h)=>{let p=this.ir(B.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);o=o.insert(p.key,p),o.size===i&&h.done()}).next(()=>o)}newChangeBuffer(e){return new Ky(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return Hb(e).get("remoteDocumentGlobalKey").next(t=>(z(!!t),t))}rr(e,t){return Hb(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){let r=GV(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(W.min())))return r}return Ke.newInvalidDocument(e)}};function c0(n){return new Wy(n)}var Ky=class extends Zd{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new Sn(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let t=[],r=0,i=new Ce((o,s)=>te(o.canonicalString(),s.canonicalString()));return this.changes.forEach((o,s)=>{let a=this.lr.get(o);if(t.push(this.cr.removeEntry(e,o,a.readTime)),s.isValidDocument()){let u=xb(this.cr.serializer,s);i=i.add(o.path.popLast());let l=Qd(u);r+=l-a.size,t.push(this.cr.addEntry(e,o,u))}else if(r-=a.size,this.trackRemovals){let u=xb(this.cr.serializer,s.convertToNoDocument(W.min()));t.push(this.cr.addEntry(e,o,u))}}),i.forEach(o=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,o))}),t.push(this.cr.updateMetadata(e,r)),A.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(r=>(this.lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:r,ur:i})=>(i.forEach((o,s)=>{this.lr.set(o,{size:s,readTime:r.get(o).readTime})}),r))}};function Hb(n){return nt(n,"remoteDocumentGlobal")}function _i(n){return nt(n,"remoteDocumentsV14")}function Xa(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function qb(n,e){let t=e.documentKey.path.toArray();return[n,zd(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function zb(n,e){let t=n.path.toArray(),r=e.path.toArray(),i=0;for(let o=0;o<t.length-2&&o<r.length-2;++o)if(i=te(t[o],r[o]),i)return i;return i=te(t.length,r.length),i||(i=te(t[t.length-2],r[r.length-2]),i||te(t[t.length-1],r[r.length-1]))}var Qy=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Jd=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&ou(r.mutation,i,Ut.empty(),je.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,ne()).next(()=>r))}getLocalViewOfDocuments(e,t,r=ne()){let i=In();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let s=tu();return o.forEach((a,u)=>{s=s.insert(a,u.overlayedDocument)}),s}))}getOverlayedDocuments(e,t){let r=In();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,ne()))}populateOverlays(e,t,r){let i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((s,a)=>{t.set(s,a)})})}computeViews(e,t,r,i){let o=kt(),s=iu(),a=function(){return iu()}();return t.forEach((u,l)=>{let h=r.get(l.key);i.has(l.key)&&(h===void 0||h.mutation instanceof rn)?o=o.insert(l.key,l):h!==void 0?(s.set(l.key,h.mutation.getFieldMask()),ou(h.mutation,l,h.mutation.getFieldMask(),je.now())):s.set(l.key,Ut.empty())}),this.recalculateAndSaveOverlays(e,o).next(u=>(u.forEach((l,h)=>s.set(l,h)),t.forEach((l,h)=>{var p;return a.set(l,new Qy(h,(p=s.get(l))!==null&&p!==void 0?p:null))}),a))}recalculateAndSaveOverlays(e,t){let r=iu(),i=new Ae((s,a)=>s-a),o=ne();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(s=>{for(let a of s)a.keys().forEach(u=>{let l=t.get(u);if(l===null)return;let h=r.get(u)||Ut.empty();h=a.applyToLocalView(l,h),r.set(u,h);let p=(i.get(a.batchId)||ne()).add(u);i=i.insert(a.batchId,p)})}).next(()=>{let s=[],a=i.getReverseIterator();for(;a.hasNext();){let u=a.getNext(),l=u.key,h=u.value,p=PS();h.forEach(m=>{if(!o.has(m)){let y=US(t.get(m),r.get(m));y!==null&&p.set(m,y),o=o.add(m)}}),s.push(this.documentOverlayCache.saveOverlays(e,l,p))}return A.waitFor(s)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(s){return B.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):t_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{let s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):A.resolve(In()),a=-1,u=o;return s.next(l=>A.forEach(l,(h,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),o.get(h)?A.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{u=u.insert(h,m)}))).next(()=>this.populateOverlays(e,l,o)).next(()=>this.computeViews(e,u,l,ne())).next(h=>({batchId:a,changes:NS(h)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new B(t)).next(r=>{let i=tu();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let o=t.collectionGroup,s=tu();return this.indexManager.getCollectionParents(e,o).next(a=>A.forEach(a,u=>{let l=function(p,m){return new nn(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(t,u.child(o));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(h=>{h.forEach((p,m)=>{s=s.insert(p,m)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(s=>{o.forEach((u,l)=>{let h=l.getKey();s.get(h)===null&&(s=s.insert(h,Ke.newInvalidDocument(h)))});let a=tu();return s.forEach((u,l)=>{let h=o.get(u);h!==void 0&&ou(h.mutation,l,Ut.empty(),je.now()),Pu(t,l)&&(a=a.insert(u,l))}),a})}};var Yy=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return A.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Ue(i.createTime)}}(t)),A.resolve()}getNamedQuery(e,t){return A.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:o_(i.bundledQuery),readTime:Ue(i.readTime)}}(t)),A.resolve()}};var Zy=class{constructor(){this.overlays=new Ae(B.comparator),this.Ir=new Map}getOverlay(e,t){return A.resolve(this.overlays.get(t))}getOverlays(e,t){let r=In();return A.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.ht(e,t,o)}),A.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Ir.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.Ir.delete(r)),A.resolve()}getOverlaysForCollection(e,t,r){let i=In(),o=t.length+1,s=new B(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){let u=a.getNext().value,l=u.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===o&&u.largestBatchId>r&&i.set(u.getKey(),u)}return A.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new Ae((l,h)=>l-h),s=this.overlays.getIterator();for(;s.hasNext();){let l=s.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let h=o.get(l.largestBatchId);h===null&&(h=In(),o=o.insert(l.largestBatchId,h)),h.set(l.getKey(),l)}}let a=In(),u=o.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((l,h)=>a.set(l,h)),!(a.size()>=i)););return A.resolve(a)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let s=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(r.key,new mu(t,r));let o=this.Ir.get(t);o===void 0&&(o=ne(),this.Ir.set(t,o)),this.Ir.set(t,o.add(r.key))}};var Jy=class{constructor(){this.sessionToken=$e.EMPTY_BYTE_STRING}getSessionToken(e){return A.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,A.resolve()}};var Eu=class{constructor(){this.Tr=new Ce(Ge.Er),this.dr=new Ce(Ge.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let r=new Ge(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new Ge(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){let t=new B(new pe([])),r=new Ge(t,e),i=new Ge(t,e+1),o=[];return this.dr.forEachInRange([r,i],s=>{this.Vr(s),o.push(s.key)}),o}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new B(new pe([])),r=new Ge(t,e),i=new Ge(t,e+1),o=ne();return this.dr.forEachInRange([r,i],s=>{o=o.add(s.key)}),o}containsKey(e){let t=new Ge(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},Ge=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return B.comparator(e.key,t.key)||te(e.wr,t.wr)}static Ar(e,t){return te(e.wr,t.wr)||B.comparator(e.key,t.key)}};var Xy=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Ce(Ge.Er)}checkEmpty(e){return A.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let o=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new gu(o,t,r,i);this.mutationQueue.push(s);for(let a of i)this.br=this.br.add(new Ge(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return A.resolve(s)}lookupMutationBatch(e,t){return A.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.vr(r),o=i<0?0:i;return A.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return A.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return A.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new Ge(t,0),i=new Ge(t,Number.POSITIVE_INFINITY),o=[];return this.br.forEachInRange([r,i],s=>{let a=this.Dr(s.wr);o.push(a)}),A.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ce(te);return t.forEach(i=>{let o=new Ge(i,0),s=new Ge(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([o,s],a=>{r=r.add(a.wr)})}),A.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=r;B.isDocumentKey(o)||(o=o.child(""));let s=new Ge(new B(o),0),a=new Ce(te);return this.br.forEachWhile(u=>{let l=u.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(u.wr)),!0)},s),A.resolve(this.Cr(a))}Cr(e){let t=[];return e.forEach(r=>{let i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){z(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return A.forEach(t.mutations,i=>{let o=new Ge(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){let r=new Ge(t,0),i=this.br.firstAfterOrEqual(r);return A.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,A.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var ev=class{constructor(e){this.Mr=e,this.docs=function(){return new Ae(B.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),o=i?i.size:0,s=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return A.resolve(r?r.document.mutableCopy():Ke.newInvalidDocument(t))}getEntries(e,t){let r=kt();return t.forEach(i=>{let o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():Ke.newInvalidDocument(i))}),A.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=kt(),s=t.path,a=new B(s.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){let{key:l,value:{document:h}}=u.getNext();if(!s.isPrefixOf(l.path))break;l.path.length>s.length+1||Yv(lS(h),r)<=0||(i.has(h.key)||Pu(t,h))&&(o=o.insert(h.key,h.mutableCopy()))}return A.resolve(o)}getAllFromCollectionGroup(e,t,r,i){H()}Or(e,t){return A.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new tv(this)}getSize(e){return A.resolve(this.size)}},tv=class extends Zd{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),A.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var nv=class{constructor(e){this.persistence=e,this.Nr=new Sn(t=>xi(t),Mu),this.lastRemoteSnapshotVersion=W.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Eu,this.targetCount=0,this.kr=ms.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),A.resolve()}getLastRemoteSnapshotVersion(e){return A.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return A.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),A.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),A.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new ms(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,A.resolve()}updateTargetData(e,t){return this.Kn(t),A.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,A.resolve()}removeTargets(e,t,r){let i=0,o=[];return this.Nr.forEach((s,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Nr.delete(s),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),A.waitFor(o).next(()=>i)}getTargetCount(e){return A.resolve(this.targetCount)}getTargetData(e,t){let r=this.Nr.get(t)||null;return A.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),A.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(s=>{o.push(i.markPotentiallyOrphaned(e,s))}),A.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),A.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Br.yr(t);return A.resolve(r)}containsKey(e,t){return A.resolve(this.Br.containsKey(t))}};var Xd=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new jt(0),this.Kr=!1,this.Kr=!0,this.$r=new Jy,this.referenceDelegate=e(this),this.Ur=new nv(this),this.indexManager=new Uy,this.remoteDocumentCache=function(i){return new ev(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new qd(t),this.Gr=new Yy(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Zy,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new Xy(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){P("MemoryPersistence","Starting transaction:",e);let i=new rv(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(o=>this.referenceDelegate.jr(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Hr(e,t){return A.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}},rv=class extends Nd{constructor(e){super(),this.currentSequenceNumber=e}},eh=class n{constructor(e){this.persistence=e,this.Jr=new Eu,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw H()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),A.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),A.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),A.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.Xr.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return A.forEach(this.Xr,r=>{let i=B.fromPath(r);return this.ei(e,i).next(o=>{o||t.removeEntry(i,W.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return A.or([()=>A.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var iv=class{constructor(e){this.serializer=e}O(e,t,r,i){let o=new Pd("createOrUpgrade",t);r<1&&i>=1&&(function(u){u.createObjectStore("owner")}(e),function(u){u.createObjectStore("mutationQueues",{keyPath:"userId"}),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",ab,{unique:!0}),u.createObjectStore("documentMutations")}(e),Gb(e),function(u){u.createObjectStore("remoteDocuments")}(e));let s=A.resolve();return r<3&&i>=3&&(r!==0&&(function(u){u.deleteObjectStore("targetDocuments"),u.deleteObjectStore("targets"),u.deleteObjectStore("targetGlobal")}(e),Gb(e)),s=s.next(()=>function(u){let l=u.store("targetGlobal"),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:W.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",h)}(o))),r<4&&i>=4&&(r!==0&&(s=s.next(()=>function(u,l){return l.store("mutations").U().next(h=>{u.deleteObjectStore("mutations"),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",ab,{unique:!0});let p=l.store("mutations"),m=h.map(y=>p.put(y));return A.waitFor(m)})}(e,o))),s=s.next(()=>{(function(u){u.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(s=s.next(()=>this.ni(o))),r<6&&i>=6&&(s=s.next(()=>(function(u){u.createObjectStore("remoteDocumentGlobal")}(e),this.ri(o)))),r<7&&i>=7&&(s=s.next(()=>this.ii(o))),r<8&&i>=8&&(s=s.next(()=>this.si(e,o))),r<9&&i>=9&&(s=s.next(()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(s=s.next(()=>this.oi(o))),r<11&&i>=11&&(s=s.next(()=>{(function(u){u.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(u){u.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(s=s.next(()=>{(function(u){let l=u.createObjectStore("documentOverlays",{keyPath:hV});l.createIndex("collectionPathOverlayIndex",fV,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",pV,{unique:!1})})(e)})),r<13&&i>=13&&(s=s.next(()=>function(u){let l=u.createObjectStore("remoteDocumentsV14",{keyPath:tV});l.createIndex("documentKeyIndex",nV),l.createIndex("collectionGroupIndex",rV)}(e)).next(()=>this._i(e,o)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(s=s.next(()=>this.ai(e,o))),r<15&&i>=15&&(s=s.next(()=>function(u){u.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),u.createObjectStore("indexState",{keyPath:uV}).createIndex("sequenceNumberIndex",cV,{unique:!1}),u.createObjectStore("indexEntries",{keyPath:lV}).createIndex("documentKeyIndex",dV,{unique:!1})}(e))),r<16&&i>=16&&(s=s.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),r<17&&i>=17&&(s=s.next(()=>{(function(u){u.createObjectStore("globals",{keyPath:"name"})})(e)})),s}ri(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=Qd(i)}).next(()=>{let r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){let t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(i=>A.forEach(i,o=>{let s=IDBKeyRange.bound([o.userId,-1],[o.userId,o.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",s).next(a=>A.forEach(a,u=>{z(u.userId===o.userId);let l=Ei(this.serializer,u);return s0(e,o.userId,l).next(()=>{})}))}))}ii(e){let t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let o=[];return r.J((s,a)=>{let u=new pe(s),l=function(p){return[0,Ct(p)]}(u);o.push(t.get(l).next(h=>h?A.resolve():(p=>t.put({targetId:0,path:Ct(p),sequenceNumber:i.highestListenSequenceNumber}))(u)))}).next(()=>A.waitFor(o))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:aV});let r=t.store("collectionParents"),i=new Iu,o=s=>{if(i.add(s)){let a=s.lastSegment(),u=s.popLast();return r.put({collectionId:a,parent:Ct(u)})}};return t.store("remoteDocuments").J({H:!0},(s,a)=>{let u=new pe(s);return o(u.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([s,a,u],l)=>{let h=wn(a);return o(h.popLast())}))}oi(e){let t=e.store("targets");return t.J((r,i)=>{let o=nu(i),s=r0(this.serializer,o);return t.put(s)})}_i(e,t){let r=t.store("remoteDocuments"),i=[];return r.J((o,s)=>{let a=t.store("remoteDocumentsV14"),u=function(p){return p.document?new B(pe.fromString(p.document.name).popFirst(5)):p.noDocument?B.fromSegments(p.noDocument.path):p.unknownDocument?B.fromSegments(p.unknownDocument.path):H()}(s).path.toArray(),l={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:s.readTime||[0,0],unknownDocument:s.unknownDocument,noDocument:s.noDocument,document:s.document,hasCommittedMutations:!!s.hasCommittedMutations};i.push(a.put(l))}).next(()=>A.waitFor(i))}ai(e,t){let r=t.store("mutations"),i=c0(this.serializer),o=new Xd(eh.Zr,this.serializer.ct);return r.U().next(s=>{let a=new Map;return s.forEach(u=>{var l;let h=(l=a.get(u.userId))!==null&&l!==void 0?l:ne();Ei(this.serializer,u).keys().forEach(p=>h=h.add(p)),a.set(u.userId,h)}),A.forEach(a,(u,l)=>{let h=new We(l),p=Gd.lt(this.serializer,h),m=o.getIndexManager(h),y=Yd.lt(h,this.serializer,m,o.referenceDelegate);return new Jd(i,y,p,m).recalculateAndSaveOverlaysForDocumentKeys(new lu(t,jt.oe),u).next()})})}};function Gb(n){n.createObjectStore("targetDocuments",{keyPath:oV}).createIndex("documentTargetsIndex",sV,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",iV,{unique:!0}),n.createObjectStore("targetGlobal")}var Gm="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",ov=class n{constructor(e,t,r,i,o,s,a,u,l,h,p=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ui=o,this.window=s,this.document=a,this.ci=l,this.li=h,this.hi=p,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=m=>Promise.resolve(),!n.D())throw new k(N.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Gy(this,i),this.Ai=t+"main",this.serializer=new qd(u),this.Ri=new Mr(this.Ai,this.hi,new iv(this.serializer)),this.$r=new Py,this.Ur=new $y(this.referenceDelegate,this.serializer),this.remoteDocumentCache=c0(this.serializer),this.Gr=new Ny,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,h===!1&&Ve("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new k(N.FAILED_PRECONDITION,Gm);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new jt(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=t=>x(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(t=>x(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(()=>x(this,null,function*(){this.started&&(yield this.mi())})))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Ed(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(Hr(e))return P("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return P("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return eu(e).get("owner").next(t=>A.resolve(this.vi(t)))}Ci(e){return Ed(e).delete(this.clientId)}Fi(){return x(this,null,function*(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let r=nt(t,"clientMetadata");return r.U().next(i=>{let o=this.xi(i,18e5),s=i.filter(a=>o.indexOf(a)===-1);return A.forEach(s,a=>r.delete(a.clientId)).next(()=>s)})}).catch(()=>[]);if(this.Vi)for(let t of e)this.Vi.removeItem(this.Oi(t.clientId))}})}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?A.resolve(!0):eu(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new k(N.FAILED_PRECONDITION,Gm);return!1}}return!(!this.networkEnabled||!this.inForeground)||Ed(e).U().next(r=>this.xi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let o=!this.networkEnabled&&i.networkEnabled,s=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(o||s&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&P("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return x(this,null,function*(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),yield this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let t=new lu(e,jt.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()})}xi(e,t){return e.filter(r=>this.Mi(r.updateTimeMs,t)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>Ed(e).U().next(t=>this.xi(t,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return Yd.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new By(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Gd.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,r){P("IndexedDbPersistence","Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",o=function(u){return u===17?yV:u===16?mV:u===15?Jv:u===14?yS:u===13?mS:u===12?gV:u===11?gS:void H()}(this.hi),s;return this.Ri.runTransaction(e,i,o,a=>(s=new lu(a,this.Qr?this.Qr.next():jt.oe),t==="readwrite-primary"?this.wi(s).next(u=>!!u||this.Si(s)).next(u=>{if(!u)throw Ve(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new k(N.FAILED_PRECONDITION,dS);return r(s)}).next(u=>this.Di(s).next(()=>u)):this.Ki(s).next(()=>r(s)))).then(a=>(s.raiseOnCommittedEvent(),a))}Ki(e){return eu(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new k(N.FAILED_PRECONDITION,Gm)})}Di(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return eu(e).put("owner",t)}static D(){return Mr.D()}bi(e){let t=eu(e);return t.get("owner").next(r=>this.vi(r)?(P("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):A.resolve())}Mi(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(Ve(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();let t=/(?:Version|Mobile)\/1[456]/;pf()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{let r=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return P("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Ve("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){Ve("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function eu(n){return nt(n,"owner")}function Ed(n){return nt(n,"clientMetadata")}function a_(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var sv=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=ne(),i=ne();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new n(e,t.fromCache,r,i)}};var av=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var th=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return pf()?8:hS(ea())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){let o={result:null};return this.Yi(e,t).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.Zi(e,t,i,r).next(s=>{o.result=s})}).next(()=>{if(o.result)return;let s=new av;return this.Xi(e,t,s).next(a=>{if(o.result=a,this.zi)return this.es(e,t,s,a.size)})}).next(()=>o.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(Zo()<=sn.DEBUG&&P("QueryEngine","SDK will not create cache indexes for query:",Jo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),A.resolve()):(Zo()<=sn.DEBUG&&P("QueryEngine","Query:",Jo(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Zo()<=sn.DEBUG&&P("QueryEngine","The SDK decides to create cache indexes for query:",Jo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,bt(t))):A.resolve())}Yi(e,t){if(_b(t))return A.resolve(null);let r=bt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Ud(t,null,"F"),r=bt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let s=ne(...o);return this.Ji.getDocuments(e,s).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{let l=this.ts(t,a);return this.ns(t,l,s,u.readTime)?this.Yi(e,Ud(t,null,"F")):this.rs(e,l,t,u)}))})))}Zi(e,t,r,i){return _b(t)||i.isEqual(W.min())?A.resolve(null):this.Ji.getDocuments(e,r).next(o=>{let s=this.ts(t,o);return this.ns(t,s,r,i)?A.resolve(null):(Zo()<=sn.DEBUG&&P("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Jo(t)),this.rs(e,s,t,cS(i,-1)).next(a=>a))})}ts(e,t){let r=new Ce(xS(e));return t.forEach((i,o)=>{Pu(e,o)&&(r=r.add(o))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Xi(e,t,r){return Zo()<=sn.DEBUG&&P("QueryEngine","Using full collection scan to execute query:",Jo(t)),this.Ji.getDocumentsMatchingQuery(e,t,Kt.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(s=>{o=o.insert(s.key,s)}),o))}};var uv=class{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new Ae(te),this._s=new Sn(o=>xi(o),Mu),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Jd(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function l0(n,e,t,r){return new uv(n,e,t,r)}function d0(n,e){return x(this,null,function*(){let t=j(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let s=[],a=[],u=ne();for(let l of i){s.push(l.batchId);for(let h of l.mutations)u=u.add(h.key)}for(let l of o){a.push(l.batchId);for(let h of l.mutations)u=u.add(h.key)}return t.localDocuments.getDocuments(r,u).next(l=>({hs:l,removedBatchIds:s,addedBatchIds:a}))})})})}function YV(n,e){let t=j(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),o=t.cs.newChangeBuffer({trackRemovals:!0});return function(a,u,l,h){let p=l.batch,m=p.keys(),y=A.resolve();return m.forEach(D=>{y=y.next(()=>h.getEntry(u,D)).next(R=>{let S=l.docVersions.get(D);z(S!==null),R.version.compareTo(S)<0&&(p.applyToRemoteDocument(R,l),R.isValidDocument()&&(R.setReadTime(l.commitVersion),h.addEntry(R)))})}),y.next(()=>a.mutationQueue.removeMutationBatch(u,p))}(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=ne();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(u=u.add(a.batch.mutations[l].key));return u}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function h0(n){let e=j(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function ZV(n,e){let t=j(n),r=e.snapshotVersion,i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let s=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;let a=[];e.targetChanges.forEach((h,p)=>{let m=i.get(p);if(!m)return;a.push(t.Ur.removeMatchingKeys(o,h.removedDocuments,p).next(()=>t.Ur.addMatchingKeys(o,h.addedDocuments,p)));let y=m.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(p)!==null?y=y.withResumeToken($e.EMPTY_BYTE_STRING,W.min()).withLastLimboFreeSnapshotVersion(W.min()):h.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(h.resumeToken,r)),i=i.insert(p,y),function(R,S,O){return R.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-R.snapshotVersion.toMicroseconds()>=3e8?!0:O.addedDocuments.size+O.modifiedDocuments.size+O.removedDocuments.size>0}(m,y,h)&&a.push(t.Ur.updateTargetData(o,y))});let u=kt(),l=ne();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(o,h))}),a.push(f0(o,s,e.documentUpdates).next(h=>{u=h.Ps,l=h.Is})),!r.isEqual(W.min())){let h=t.Ur.getLastRemoteSnapshotVersion(o).next(p=>t.Ur.setTargetsMetadata(o,o.currentSequenceNumber,r));a.push(h)}return A.waitFor(a).next(()=>s.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,u,l)).next(()=>u)}).then(o=>(t.os=i,o))}function f0(n,e,t){let r=ne(),i=ne();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let s=kt();return t.forEach((a,u)=>{let l=o.get(a);u.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),u.isNoDocument()&&u.version.isEqual(W.min())?(e.removeEntry(a,u.readTime),s=s.insert(a,u)):!l.isValidDocument()||u.version.compareTo(l.version)>0||u.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(u),s=s.insert(a,u)):P("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",u.version)}),{Ps:s,Is:i}})}function JV(n,e){let t=j(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function ys(n,e){let t=j(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(o=>o?(i=o,A.resolve(i)):t.Ur.allocateTargetId(r).next(s=>(i=new gs(e,s,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}function vs(n,e,t){return x(this,null,function*(){let r=j(n),i=r.os.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",o,s=>r.persistence.referenceDelegate.removeTarget(s,i)))}catch(s){if(!Hr(s))throw s;P("LocalStore",`Failed to update sequence numbers for target ${e}: ${s}`)}r.os=r.os.remove(e),r._s.delete(i.target)})}function nh(n,e,t){let r=j(n),i=W.min(),o=ne();return r.persistence.runTransaction("Execute query","readwrite",s=>function(u,l,h){let p=j(u),m=p._s.get(h);return m!==void 0?A.resolve(p.os.get(m)):p.Ur.getTargetData(l,h)}(r,s,bt(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(s,a.targetId).next(u=>{o=u})}).next(()=>r.ss.getDocumentsMatchingQuery(s,e,t?i:W.min(),t?o:ne())).next(a=>(m0(r,RS(e),a),{documents:a,Ts:o})))}function p0(n,e){let t=j(n),r=j(t.Ur),i=t.os.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",o=>r.ot(o,e).next(s=>s?s.target:null))}function g0(n,e){let t=j(n),r=t.us.get(e)||W.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.cs.getAllFromCollectionGroup(i,e,cS(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(m0(t,e,i),i))}function m0(n,e,t){let r=n.us.get(e)||W.min();t.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n.us.set(e,r)}function XV(n,e,t,r){return x(this,null,function*(){let i=j(n),o=ne(),s=kt();for(let l of t){let h=e.Es(l.metadata.name);l.document&&(o=o.add(h));let p=e.ds(l);p.setReadTime(e.As(l.metadata.readTime)),s=s.insert(h,p)}let a=i.cs.newChangeBuffer({trackRemovals:!0}),u=yield ys(i,function(h){return bt(bs(pe.fromString(`__bundle__/docs/${h}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>f0(l,a,s).next(h=>(a.apply(l),h)).next(h=>i.Ur.removeMatchingKeysForTargetId(l,u.targetId).next(()=>i.Ur.addMatchingKeys(l,o,u.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,h.Ps,h.Is)).next(()=>h.Ps)))})}function e2(r,i){return x(this,arguments,function*(n,e,t=ne()){let o=yield ys(n,bt(o_(e.bundledQuery))),s=j(n);return s.persistence.runTransaction("Save named query","readwrite",a=>{let u=Ue(e.readTime);if(o.snapshotVersion.compareTo(u)>=0)return s.Gr.saveNamedQuery(a,e);let l=o.withResumeToken($e.EMPTY_BYTE_STRING,u);return s.os=s.os.insert(l.targetId,l),s.Ur.updateTargetData(a,l).next(()=>s.Ur.removeMatchingKeysForTargetId(a,o.targetId)).next(()=>s.Ur.addMatchingKeys(a,t,o.targetId)).next(()=>s.Gr.saveNamedQuery(a,e))})})}function Wb(n,e){return`firestore_clients_${n}_${e}`}function Kb(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Wm(n,e){return`firestore_targets_${n}_${e}`}var rh=class n{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Rs(e,t,r){let i=JSON.parse(r),o,s=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return s&&i.error&&(s=typeof i.error.message=="string"&&typeof i.error.code=="string",s&&(o=new k(i.error.code,i.error.message))),s?new n(e,t,i.state,o):(Ve("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Vs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},su=class n{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Rs(e,t){let r=JSON.parse(t),i,o=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return o&&r.error&&(o=typeof r.error.message=="string"&&typeof r.error.code=="string",o&&(i=new k(r.error.code,r.error.message))),o?new n(e,r.state,i):(Ve("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},ih=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){let r=JSON.parse(t),i=typeof r=="object"&&r.activeTargetIds instanceof Array,o=n_();for(let s=0;i&&s<r.activeTargetIds.length;++s)i=fS(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new n(e,o):(Ve("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}},cv=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(Ve("SharedClientState",`Failed to parse online state: ${e}`),null)}},Du=class{constructor(){this.activeTargetIds=n_()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},au=class{constructor(e,t,r,i,o){this.window=e,this.ui=t,this.persistenceKey=r,this.ps=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new Ae(te),this.started=!1,this.bs=[];let s=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.Ds=Wb(this.persistenceKey,this.ps),this.vs=function(u){return`firestore_sequence_number_${u}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new Du),this.Cs=new RegExp(`^firestore_clients_${s}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${s}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${s}_(\\d+)$`),this.xs=function(u){return`firestore_online_state_${u}`}(this.persistenceKey),this.Os=function(u){return`firestore_bundle_loaded_v2_${u}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}start(){return x(this,null,function*(){let e=yield this.syncEngine.Qi();for(let r of e){if(r===this.ps)continue;let i=this.getItem(Wb(this.persistenceKey,r));if(i){let o=ih.Rs(r,i);o&&(this.Ss=this.Ss.insert(o.clientId,o))}}this.Ns();let t=this.storage.getItem(this.xs);if(t){let r=this.Ls(t);r&&this.Bs(r)}for(let r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,r){this.qs(e,t,r),this.Qs(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){let i=this.storage.getItem(Wm(this.persistenceKey,e));if(i){let o=su.Rs(e,i);o&&(r=o.state)}}return t&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Wm(this.persistenceKey,e))}updateQueryState(e,t,r){this.$s(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Qs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return P("SharedClientState","READ",e,t),t}setItem(e,t){P("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){P("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){let t=e;if(t.storageArea===this.storage){if(P("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void Ve("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(()=>x(this,null,function*(){if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){let r=this.Gs(t.key);return this.zs(r,null)}{let r=this.js(t.key,t.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){let r=this.Hs(t.key,t.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(t.key)){if(t.newValue!==null){let r=this.Ys(t.key,t.newValue);if(r)return this.Zs(r)}}else if(t.key===this.xs){if(t.newValue!==null){let r=this.Ls(t.newValue);if(r)return this.Bs(r)}}else if(t.key===this.vs){let r=function(o){let s=jt.oe;if(o!=null)try{let a=JSON.parse(o);z(typeof a=="number"),s=a}catch(a){Ve("SharedClientState","Failed to read sequence number from WebStorage",a)}return s}(t.newValue);r!==jt.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Os){let r=this.Xs(t.newValue);yield Promise.all(r.map(i=>this.syncEngine.eo(i)))}}}else this.bs.push(t)}))}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,r){let i=new rh(this.currentUser,e,t,r),o=Kb(this.persistenceKey,this.currentUser,e);this.setItem(o,i.Vs())}Qs(e){let t=Kb(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){let t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,r){let i=Wm(this.persistenceKey,e),o=new su(e,t,r);this.setItem(i,o.Vs())}Ws(e){let t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){let t=this.Cs.exec(e);return t?t[1]:null}js(e,t){let r=this.Gs(e);return ih.Rs(r,t)}Hs(e,t){let r=this.Fs.exec(e),i=Number(r[1]),o=r[2]!==void 0?r[2]:null;return rh.Rs(new We(o),i,t)}Ys(e,t){let r=this.Ms.exec(e),i=Number(r[1]);return su.Rs(i,t)}Ls(e){return cv.Rs(e)}Xs(e){return JSON.parse(e)}Js(e){return x(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);P("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){let r=t?this.Ss.insert(e,t):this.Ss.remove(e),i=this.ks(this.Ss),o=this.ks(r),s=[],a=[];return o.forEach(u=>{i.has(u)||s.push(u)}),i.forEach(u=>{o.has(u)||a.push(u)}),this.syncEngine.io(s,a).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=n_();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},oh=class{constructor(){this.so=new Du,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Du,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var lv=class{_o(e){}shutdown(){}};var sh=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){P("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){P("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Dd=null;function Km(){return Dd===null?Dd=function(){return 268435456+Math.round(2147483648*Math.random())}():Dd++,"0x"+Dd.toString(16)}var t2={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var dv=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var pt="WebChannelConnection",hv=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${o}`}get Fo(){return!1}Mo(t,r,i,o,s){let a=Km(),u=this.xo(t,r.toUriEncodedString());P("RestConnection",`Sending RPC '${t}' ${a}:`,u,i);let l={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(l,o,s),this.No(t,u,l,i).then(h=>(P("RestConnection",`Received RPC '${t}' ${a}: `,h),h),h=>{throw Kn("RestConnection",`RPC '${t}' ${a} failed with error: `,h,"url: ",u,"request:",i),h})}Lo(t,r,i,o,s,a){return this.Mo(t,r,i,o,s)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Cs}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,s)=>t[s]=o),i&&i.headers.forEach((o,s)=>t[s]=o)}xo(t,r){let i=t2[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){let o=Km();return new Promise((s,a)=>{let u=new Um;u.setWithCredentials(!0),u.listenOnce(Bm.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Ya.NO_ERROR:let h=u.getResponseJson();P(pt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(h)),s(h);break;case Ya.TIMEOUT:P(pt,`RPC '${e}' ${o} timed out`),a(new k(N.DEADLINE_EXCEEDED,"Request time out"));break;case Ya.HTTP_ERROR:let p=u.getStatus();if(P(pt,`RPC '${e}' ${o} failed with status:`,p,"response text:",u.getResponseText()),p>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);let y=m?.error;if(y&&y.status&&y.message){let D=function(S){let O=S.toLowerCase().replace(/_/g,"-");return Object.values(N).indexOf(O)>=0?O:N.UNKNOWN}(y.status);a(new k(D,y.message))}else a(new k(N.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new k(N.UNAVAILABLE,"Connection failed."));break;default:H()}}finally{P(pt,`RPC '${e}' ${o} completed.`)}});let l=JSON.stringify(i);P(pt,`RPC '${e}' ${o} sending request:`,i),u.send(t,"POST",l,r,15)})}Bo(e,t,r){let i=Km(),o=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=qm(),a=Hm(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(u.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;let h=o.join("");P(pt,`Creating RPC '${e}' stream ${i}: ${h}`,u);let p=s.createWebChannel(h,u),m=!1,y=!1,D=new dv({Io:S=>{y?P(pt,`Not sending because RPC '${e}' stream ${i} is closed:`,S):(m||(P(pt,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),P(pt,`RPC '${e}' stream ${i} sending:`,S),p.send(S))},To:()=>p.close()}),R=(S,O,U)=>{S.listen(O,V=>{try{U(V)}catch(q){setTimeout(()=>{throw q},0)}})};return R(p,Go.EventType.OPEN,()=>{y||(P(pt,`RPC '${e}' stream ${i} transport opened.`),D.yo())}),R(p,Go.EventType.CLOSE,()=>{y||(y=!0,P(pt,`RPC '${e}' stream ${i} transport closed`),D.So())}),R(p,Go.EventType.ERROR,S=>{y||(y=!0,Kn(pt,`RPC '${e}' stream ${i} transport errored:`,S),D.So(new k(N.UNAVAILABLE,"The operation could not be completed")))}),R(p,Go.EventType.MESSAGE,S=>{var O;if(!y){let U=S.data[0];z(!!U);let V=U,q=V.error||((O=V[0])===null||O===void 0?void 0:O.error);if(q){P(pt,`RPC '${e}' stream ${i} received error:`,q);let re=q.status,G=function(w){let E=ze[w];if(E!==void 0)return HS(E)}(re),I=q.message;G===void 0&&(G=N.INTERNAL,I="Unknown error status: "+re+" with message "+q.message),y=!0,D.So(new k(G,I)),p.close()}else P(pt,`RPC '${e}' stream ${i} received:`,U),D.bo(U)}}),R(a,$m.STAT_EVENT,S=>{S.stat===_d.PROXY?P(pt,`RPC '${e}' stream ${i} detected buffering proxy`):S.stat===_d.NOPROXY&&P(pt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{D.wo()},0),D}};function y0(){return typeof window<"u"?window:null}function Ad(){return typeof document<"u"?document:null}function ku(n){return new Sy(n,!0)}var Tu=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=o,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&P("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var ah=class{constructor(e,t,r,i,o,s,a,u){this.ui=e,this.Ho=r,this.Jo=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Tu(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return x(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return x(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return x(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===N.RESOURCE_EXHAUSTED?(Ve(t.toString()),Ve("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===N.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{let i=new k(N.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){let r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(()=>x(this,null,function*(){this.state=0,this.start()}))}I_(e){return P("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(P("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},fv=class extends ah{constructor(e,t,r,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=jV(this.serializer,e),r=function(o){if(!("targetChange"in o))return W.min();let s=o.targetChange;return s.targetIds&&s.targetIds.length?W.min():s.readTime?Ue(s.readTime):W.min()}(e);return this.listener.d_(t,r)}A_(e){let t={};t.database=xy(this.serializer),t.addTarget=function(o,s){let a,u=s.target;if(a=Vd(u)?{documents:ZS(o,u)}:{query:JS(o,u)._t},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=zS(o,s.resumeToken);let l=Ay(o,s.expectedCount);l!==null&&(a.expectedCount=l)}else if(s.snapshotVersion.compareTo(W.min())>0){a.readTime=ps(o,s.snapshotVersion.toTimestamp());let l=Ay(o,s.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,e);let r=BV(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){let t={};t.database=xy(this.serializer),t.removeTarget=e,this.a_(t)}},pv=class extends ah{constructor(e,t,r,i,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return z(!!e.streamToken),this.lastStreamToken=e.streamToken,z(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){z(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=UV(e.writeResults,e.commitTime),r=Ue(e.commitTime);return this.listener.g_(r,t)}p_(){let e={};e.database=xy(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>wu(this.serializer,r))};this.a_(t)}};var gv=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new k(N.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Mo(e,Ry(t,r),i,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new k(N.UNKNOWN,o.toString())})}Lo(e,t,r,i,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Lo(e,Ry(t,r),i,s,a,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new k(N.UNKNOWN,s.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},mv=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Ve(t),this.D_=!1):P("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var yv=class{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=o,this.k_._o(s=>{r.enqueueAndForget(()=>x(this,null,function*(){qr(this)&&(P("RemoteStore","Restarting streams for network reachability change."),yield function(u){return x(this,null,function*(){let l=j(u);l.L_.add(4),yield Ss(l),l.q_.set("Unknown"),l.L_.delete(4),yield Ou(l)})}(this))}))}),this.q_=new mv(r,i)}};function Ou(n){return x(this,null,function*(){if(qr(n))for(let e of n.B_)yield e(!0)})}function Ss(n){return x(this,null,function*(){for(let e of n.B_)yield e(!1)})}function Ah(n,e){let t=j(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),l_(t)?c_(t):Rs(t).r_()&&u_(t,e))}function _s(n,e){let t=j(n),r=Rs(t);t.N_.delete(e),r.r_()&&v0(t,e),t.N_.size===0&&(r.r_()?r.o_():qr(t)&&t.q_.set("Unknown"))}function u_(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(W.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Rs(n).A_(e)}function v0(n,e){n.Q_.xe(e),Rs(n).R_(e)}function c_(n){n.Q_=new by({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Rs(n).start(),n.q_.v_()}function l_(n){return qr(n)&&!Rs(n).n_()&&n.N_.size>0}function qr(n){return j(n).L_.size===0}function _0(n){n.Q_=void 0}function n2(n){return x(this,null,function*(){n.q_.set("Online")})}function r2(n){return x(this,null,function*(){n.N_.forEach((e,t)=>{u_(n,e)})})}function i2(n,e){return x(this,null,function*(){_0(n),l_(n)?(n.q_.M_(e),c_(n)):n.q_.set("Unknown")})}function o2(n,e,t){return x(this,null,function*(){if(n.q_.set("Online"),e instanceof $d&&e.state===2&&e.cause)try{yield function(i,o){return x(this,null,function*(){let s=o.cause;for(let a of o.targetIds)i.N_.has(a)&&(yield i.remoteSyncer.rejectListen(a,s),i.N_.delete(a),i.Q_.removeTarget(a))})}(n,e)}catch(r){P("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield uh(n,r)}else if(e instanceof os?n.Q_.Ke(e):e instanceof Bd?n.Q_.He(e):n.Q_.We(e),!t.isEqual(W.min()))try{let r=yield h0(n.localStore);t.compareTo(r)>=0&&(yield function(o,s){let a=o.Q_.rt(s);return a.targetChanges.forEach((u,l)=>{if(u.resumeToken.approximateByteSize()>0){let h=o.N_.get(l);h&&o.N_.set(l,h.withResumeToken(u.resumeToken,s))}}),a.targetMismatches.forEach((u,l)=>{let h=o.N_.get(u);if(!h)return;o.N_.set(u,h.withResumeToken($e.EMPTY_BYTE_STRING,h.snapshotVersion)),v0(o,u);let p=new gs(h.target,u,l,h.sequenceNumber);u_(o,p)}),o.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){P("RemoteStore","Failed to raise snapshot:",r),yield uh(n,r)}})}function uh(n,e,t){return x(this,null,function*(){if(!Hr(e))throw e;n.L_.add(1),yield Ss(n),n.q_.set("Offline"),t||(t=()=>h0(n.localStore)),n.asyncQueue.enqueueRetryable(()=>x(this,null,function*(){P("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield Ou(n)}))})}function w0(n,e){return e().catch(t=>uh(n,t,e))}function As(n){return x(this,null,function*(){let e=j(n),t=Vr(e),r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;s2(e);)try{let i=yield JV(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,a2(e,i)}catch(i){yield uh(e,i)}I0(e)&&E0(e)})}function s2(n){return qr(n)&&n.O_.length<10}function a2(n,e){n.O_.push(e);let t=Vr(n);t.r_()&&t.V_&&t.m_(e.mutations)}function I0(n){return qr(n)&&!Vr(n).n_()&&n.O_.length>0}function E0(n){Vr(n).start()}function u2(n){return x(this,null,function*(){Vr(n).p_()})}function c2(n){return x(this,null,function*(){let e=Vr(n);for(let t of n.O_)e.m_(t.mutations)})}function l2(n,e,t){return x(this,null,function*(){let r=n.O_.shift(),i=Dy.from(r,e,t);yield w0(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield As(n)})}function d2(n,e){return x(this,null,function*(){e&&Vr(n).V_&&(yield function(r,i){return x(this,null,function*(){if(function(s){return $S(s)&&s!==N.ABORTED}(i.code)){let o=r.O_.shift();Vr(r).s_(),yield w0(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield As(r)}})}(n,e)),I0(n)&&E0(n)})}function Qb(n,e){return x(this,null,function*(){let t=j(n);t.asyncQueue.verifyOperationInProgress(),P("RemoteStore","RemoteStore received new credentials");let r=qr(t);t.L_.add(3),yield Ss(t),r&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield Ou(t)})}function vv(n,e){return x(this,null,function*(){let t=j(n);e?(t.L_.delete(2),yield Ou(t)):e||(t.L_.add(2),yield Ss(t),t.q_.set("Unknown"))})}function Rs(n){return n.K_||(n.K_=function(t,r,i){let o=j(t);return o.w_(),new fv(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Eo:n2.bind(null,n),Ro:r2.bind(null,n),mo:i2.bind(null,n),d_:o2.bind(null,n)}),n.B_.push(e=>x(this,null,function*(){e?(n.K_.s_(),l_(n)?c_(n):n.q_.set("Unknown")):(yield n.K_.stop(),_0(n))}))),n.K_}function Vr(n){return n.U_||(n.U_=function(t,r,i){let o=j(t);return o.w_(),new pv(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:u2.bind(null,n),mo:d2.bind(null,n),f_:c2.bind(null,n),g_:l2.bind(null,n)}),n.B_.push(e=>x(this,null,function*(){e?(n.U_.s_(),yield As(n)):(yield n.U_.stop(),n.O_.length>0&&(P("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var _v=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new et,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let s=Date.now()+r,a=new n(e,t,s,i,o);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new k(N.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function xs(n,e){if(Ve("AsyncQueue",`${e}: ${n}`),Hr(n))return new k(N.UNAVAILABLE,`${e}: ${n}`);throw n}var ch=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||B.comparator(t.key,r.key):(t,r)=>B.comparator(t.key,r.key),this.keyedMap=tu(),this.sortedSet=new Ae(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var lh=class{constructor(){this.W_=new Ae(B.comparator)}track(e){let t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):H():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}},ws=class n{constructor(e,t,r,i,o,s,a,u,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,o){let s=[];return t.forEach(a=>{s.push({type:0,doc:a})}),new n(e,t,ch.emptySet(t),s,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Nu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var wv=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},Iv=class{constructor(){this.queries=Yb(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){let i=j(t),o=i.queries;i.queries=Yb(),o.forEach((s,a)=>{for(let u of a.j_)u.onError(r)})})(this,new k(N.ABORTED,"Firestore shutting down"))}};function Yb(){return new Sn(n=>AS(n),Nu)}function d_(n,e){return x(this,null,function*(){let t=j(n),r=3,i=e.query,o=t.queries.get(i);o?!o.H_()&&e.J_()&&(r=2):(o=new wv,r=e.J_()?0:1);try{switch(r){case 0:o.z_=yield t.onListen(i,!0);break;case 1:o.z_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(s){let a=xs(s,`Initialization of query '${Jo(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,o),o.j_.push(e),e.Z_(t.onlineState),o.z_&&e.X_(o.z_)&&f_(t)})}function h_(n,e){return x(this,null,function*(){let t=j(n),r=e.query,i=3,o=t.queries.get(r);if(o){let s=o.j_.indexOf(e);s>=0&&(o.j_.splice(s,1),o.j_.length===0?i=e.J_()?0:1:!o.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function h2(n,e){let t=j(n),r=!1;for(let i of e){let o=i.query,s=t.queries.get(o);if(s){for(let a of s.j_)a.X_(i)&&(r=!0);s.z_=i}}r&&f_(t)}function f2(n,e,t){let r=j(n),i=r.queries.get(e);if(i)for(let o of i.j_)o.onError(t);r.queries.delete(e)}function f_(n){n.Y_.forEach(e=>{e.next()})}var Ev,Zb;(Zb=Ev||(Ev={})).ea="default",Zb.Cache="cache";var Cu=class{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new ws(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=ws.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Ev.Cache}};var Dv=class{constructor(e,t){this.aa=e,this.byteLength=t}ua(){return"metadata"in this.aa}};var dh=class{constructor(e){this.serializer=e}Es(e){return Dn(this.serializer,e)}ds(e){return e.metadata.exists?YS(this.serializer,e.document,!1):Ke.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return Ue(e)}},Tv=class{constructor(e,t,r){this.ca=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=D0(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++t;let r=pe.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ha(e){let t=new Map,r=new dh(this.serializer);for(let i of e)if(i.metadata.queries){let o=r.Es(i.metadata.name);for(let s of i.metadata.queries){let a=(t.get(s)||ne()).add(o);t.set(s,a)}}return t}complete(){return x(this,null,function*(){let e=yield XV(this.localStore,new dh(this.serializer),this.documents,this.ca.id),t=this.ha(this.documents);for(let r of this.queries)yield e2(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}})}};function D0(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var hh=class{constructor(e){this.key=e}},fh=class{constructor(e){this.key=e}},ph=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ne(),this.mutatedKeys=ne(),this.Aa=xS(e),this.Ra=new ch(this.Aa)}get Va(){return this.Ta}ma(e,t){let r=t?t.fa:new lh,i=t?t.Ra:this.Ra,o=t?t.mutatedKeys:this.mutatedKeys,s=i,a=!1,u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,p)=>{let m=i.get(h),y=Pu(this.query,p)?p:null,D=!!m&&this.mutatedKeys.has(m.key),R=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations),S=!1;m&&y?m.data.isEqual(y.data)?D!==R&&(r.track({type:3,doc:y}),S=!0):this.ga(m,y)||(r.track({type:2,doc:y}),S=!0,(u&&this.Aa(y,u)>0||l&&this.Aa(y,l)<0)&&(a=!0)):!m&&y?(r.track({type:0,doc:y}),S=!0):m&&!y&&(r.track({type:1,doc:m}),S=!0,(u||l)&&(a=!0)),S&&(y?(s=s.add(y),o=R?o.add(h):o.delete(h)):(s=s.delete(h),o=o.delete(h)))}),this.query.limit!==null)for(;s.size>this.query.limit;){let h=this.query.limitType==="F"?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{Ra:s,fa:r,ns:a,mutatedKeys:o}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let o=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let s=e.fa.G_();s.sort((h,p)=>function(y,D){let R=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return H()}};return R(y)-R(D)}(h.type,p.type)||this.Aa(h.doc,p.doc)),this.pa(r),i=i!=null&&i;let a=t&&!i?this.ya():[],u=this.da.size===0&&this.current&&!i?1:0,l=u!==this.Ea;return this.Ea=u,s.length!==0||l?{snapshot:new ws(this.query,e.Ra,o,s,e.mutatedKeys,u===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new lh,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=ne(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});let t=[];return e.forEach(r=>{this.da.has(r)||t.push(new fh(r))}),this.da.forEach(r=>{e.has(r)||t.push(new hh(r))}),t}ba(e){this.Ta=e.Ts,this.da=ne();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return ws.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},Cv=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},bv=class{constructor(e){this.key=e,this.va=!1}},Sv=class{constructor(e,t,r,i,o,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Ca={},this.Fa=new Sn(a=>AS(a),Nu),this.Ma=new Map,this.xa=new Set,this.Oa=new Ae(B.comparator),this.Na=new Map,this.La=new Eu,this.Ba={},this.ka=new Map,this.qa=ms.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function p2(n,e,t=!0){return x(this,null,function*(){let r=Rh(n),i,o=r.Fa.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.Da()):i=yield T0(r,e,t,!0),i})}function g2(n,e){return x(this,null,function*(){let t=Rh(n);yield T0(t,e,!0,!1)})}function T0(n,e,t,r){return x(this,null,function*(){let i=yield ys(n.localStore,bt(e)),o=i.targetId,s=n.sharedClientState.addLocalQueryTarget(o,t),a;return r&&(a=yield p_(n,e,o,s==="current",i.resumeToken)),n.isPrimaryClient&&t&&Ah(n.remoteStore,i),a})}function p_(n,e,t,r,i){return x(this,null,function*(){n.Ka=(p,m,y)=>function(R,S,O,U){return x(this,null,function*(){let V=S.view.ma(O);V.ns&&(V=yield nh(R.localStore,S.query,!1).then(({documents:I})=>S.view.ma(I,V)));let q=U&&U.targetChanges.get(S.targetId),re=U&&U.targetMismatches.get(S.targetId)!=null,G=S.view.applyChanges(V,R.isPrimaryClient,q,re);return Av(R,S.targetId,G.wa),G.snapshot})}(n,p,m,y);let o=yield nh(n.localStore,e,!0),s=new ph(e,o.Ts),a=s.ma(o.documents),u=vu.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=s.applyChanges(a,n.isPrimaryClient,u);Av(n,t,l.wa);let h=new Cv(e,t,s);return n.Fa.set(e,h),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),l.snapshot})}function m2(n,e,t){return x(this,null,function*(){let r=j(n),i=r.Fa.get(e),o=r.Ma.get(i.targetId);if(o.length>1)return r.Ma.set(i.targetId,o.filter(s=>!Nu(s,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield vs(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&_s(r.remoteStore,i.targetId),Is(r,i.targetId)}).catch($r))):(Is(r,i.targetId),yield vs(r.localStore,i.targetId,!0))})}function y2(n,e){return x(this,null,function*(){let t=j(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),_s(t.remoteStore,r.targetId))})}function v2(n,e,t){return x(this,null,function*(){let r=v_(n);try{let i=yield function(s,a){let u=j(s),l=je.now(),h=a.reduce((y,D)=>y.add(D.key),ne()),p,m;return u.persistence.runTransaction("Locally write mutations","readwrite",y=>{let D=kt(),R=ne();return u.cs.getEntries(y,h).next(S=>{D=S,D.forEach((O,U)=>{U.isValidDocument()||(R=R.add(O))})}).next(()=>u.localDocuments.getOverlayedDocuments(y,D)).next(S=>{p=S;let O=[];for(let U of a){let V=NV(U,p.get(U.key).overlayedDocument);V!=null&&O.push(new rn(U.key,V,IS(V.value.mapValue),Oe.exists(!0)))}return u.mutationQueue.addMutationBatch(y,l,O,a)}).next(S=>{m=S;let O=S.applyToLocalDocumentSet(p,R);return u.documentOverlayCache.saveOverlays(y,S.batchId,O)})}).then(()=>({batchId:m.batchId,changes:NS(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(s,a,u){let l=s.Ba[s.currentUser.toKey()];l||(l=new Ae(te)),l=l.insert(a,u),s.Ba[s.currentUser.toKey()]=l}(r,i.batchId,t),yield er(r,i.changes),yield As(r.remoteStore)}catch(i){let o=xs(i,"Failed to persist write");t.reject(o)}})}function C0(n,e){return x(this,null,function*(){let t=j(n);try{let r=yield ZV(t.localStore,e);e.targetChanges.forEach((i,o)=>{let s=t.Na.get(o);s&&(z(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?s.va=!0:i.modifiedDocuments.size>0?z(s.va):i.removedDocuments.size>0&&(z(s.va),s.va=!1))}),yield er(t,r,e)}catch(r){yield $r(r)}})}function Jb(n,e,t){let r=j(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Fa.forEach((o,s)=>{let a=s.view.Z_(e);a.snapshot&&i.push(a.snapshot)}),function(s,a){let u=j(s);u.onlineState=a;let l=!1;u.queries.forEach((h,p)=>{for(let m of p.j_)m.Z_(a)&&(l=!0)}),l&&f_(u)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function _2(n,e,t){return x(this,null,function*(){let r=j(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Na.get(e),o=i&&i.key;if(o){let s=new Ae(B.comparator);s=s.insert(o,Ke.newNoDocument(o,W.min()));let a=ne().add(o),u=new yu(W.min(),new Map,new Ae(te),s,a);yield C0(r,u),r.Oa=r.Oa.remove(o),r.Na.delete(e),y_(r)}else yield vs(r.localStore,e,!1).then(()=>Is(r,e,t)).catch($r)})}function w2(n,e){return x(this,null,function*(){let t=j(n),r=e.batch.batchId;try{let i=yield YV(t.localStore,e);m_(t,r,null),g_(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield er(t,i)}catch(i){yield $r(i)}})}function I2(n,e,t){return x(this,null,function*(){let r=j(n);try{let i=yield function(s,a){let u=j(s);return u.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let h;return u.mutationQueue.lookupMutationBatch(l,a).next(p=>(z(p!==null),h=p.keys(),u.mutationQueue.removeMutationBatch(l,p))).next(()=>u.mutationQueue.performConsistencyCheck(l)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(l,h,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,h)).next(()=>u.localDocuments.getDocuments(l,h))})}(r.localStore,e);m_(r,e,t),g_(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield er(r,i)}catch(i){yield $r(i)}})}function E2(n,e){return x(this,null,function*(){let t=j(n);qr(t.remoteStore)||P("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(s){let a=j(s);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",u=>a.mutationQueue.getHighestUnacknowledgedBatchId(u))}(t.localStore);if(r===-1)return void e.resolve();let i=t.ka.get(r)||[];i.push(e),t.ka.set(r,i)}catch(r){let i=xs(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function g_(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function m_(n,e,t){let r=j(n),i=r.Ba[r.currentUser.toKey()];if(i){let o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function Is(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||b0(n,r)})}function b0(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(_s(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),y_(n))}function Av(n,e,t){for(let r of t)r instanceof hh?(n.La.addReference(r.key,e),D2(n,r)):r instanceof fh?(P("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||b0(n,r.key)):H()}function D2(n,e){let t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(P("SyncEngine","New document in limbo: "+t),n.xa.add(r),y_(n))}function y_(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new B(pe.fromString(e)),r=n.qa.next();n.Na.set(r,new bv(t)),n.Oa=n.Oa.insert(t,r),Ah(n.remoteStore,new gs(bt(bs(t.path)),r,"TargetPurposeLimboResolution",jt.oe))}}function er(n,e,t){return x(this,null,function*(){let r=j(n),i=[],o=[],s=[];r.Fa.isEmpty()||(r.Fa.forEach((a,u)=>{s.push(r.Ka(u,e,t).then(l=>{var h;if((l||t)&&r.isPrimaryClient){let p=l?!l.fromCache:(h=t?.targetChanges.get(u.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(u.targetId,p?"current":"not-current")}if(l){i.push(l);let p=sv.Wi(u.targetId,l);o.push(p)}}))}),yield Promise.all(s),r.Ca.d_(i),yield function(u,l){return x(this,null,function*(){let h=j(u);try{yield h.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>A.forEach(l,m=>A.forEach(m.$i,y=>h.persistence.referenceDelegate.addReference(p,m.targetId,y)).next(()=>A.forEach(m.Ui,y=>h.persistence.referenceDelegate.removeReference(p,m.targetId,y)))))}catch(p){if(!Hr(p))throw p;P("LocalStore","Failed to update sequence numbers: "+p)}for(let p of l){let m=p.targetId;if(!p.fromCache){let y=h.os.get(m),D=y.snapshotVersion,R=y.withLastLimboFreeSnapshotVersion(D);h.os=h.os.insert(m,R)}}})}(r.localStore,o))})}function T2(n,e){return x(this,null,function*(){let t=j(n);if(!t.currentUser.isEqual(e)){P("SyncEngine","User change. New user:",e.toKey());let r=yield d0(t.localStore,e);t.currentUser=e,function(o,s){o.ka.forEach(a=>{a.forEach(u=>{u.reject(new k(N.CANCELLED,s))})}),o.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield er(t,r.hs)}})}function C2(n,e){let t=j(n),r=t.Na.get(e);if(r&&r.va)return ne().add(r.key);{let i=ne(),o=t.Ma.get(e);if(!o)return i;for(let s of o){let a=t.Fa.get(s);i=i.unionWith(a.view.Va)}return i}}function b2(n,e){return x(this,null,function*(){let t=j(n),r=yield nh(t.localStore,e.query,!0),i=e.view.ba(r);return t.isPrimaryClient&&Av(t,e.targetId,i.wa),i})}function S2(n,e){return x(this,null,function*(){let t=j(n);return g0(t.localStore,e).then(r=>er(t,r))})}function A2(n,e,t,r){return x(this,null,function*(){let i=j(n),o=yield function(a,u){let l=j(a),h=j(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",p=>h.Mn(p,u).next(m=>m?l.localDocuments.getDocuments(p,m):A.resolve(null)))}(i.localStore,e);o!==null?(t==="pending"?yield As(i.remoteStore):t==="acknowledged"||t==="rejected"?(m_(i,e,r||null),g_(i,e),function(a,u){j(j(a).mutationQueue).On(u)}(i.localStore,e)):H(),yield er(i,o)):P("SyncEngine","Cannot apply mutation batch with id: "+e)})}function R2(n,e){return x(this,null,function*(){let t=j(n);if(Rh(t),v_(t),e===!0&&t.Qa!==!0){let r=t.sharedClientState.getAllActiveQueryTargets(),i=yield Xb(t,r.toArray());t.Qa=!0,yield vv(t.remoteStore,!0);for(let o of i)Ah(t.remoteStore,o)}else if(e===!1&&t.Qa!==!1){let r=[],i=Promise.resolve();t.Ma.forEach((o,s)=>{t.sharedClientState.isLocalQueryTarget(s)?r.push(s):i=i.then(()=>(Is(t,s),vs(t.localStore,s,!0))),_s(t.remoteStore,s)}),yield i,yield Xb(t,r),function(s){let a=j(s);a.Na.forEach((u,l)=>{_s(a.remoteStore,l)}),a.La.pr(),a.Na=new Map,a.Oa=new Ae(B.comparator)}(t),t.Qa=!1,yield vv(t.remoteStore,!1)}})}function Xb(n,e,t){return x(this,null,function*(){let r=j(n),i=[],o=[];for(let s of e){let a,u=r.Ma.get(s);if(u&&u.length!==0){a=yield ys(r.localStore,bt(u[0]));for(let l of u){let h=r.Fa.get(l),p=yield b2(r,h);p.snapshot&&o.push(p.snapshot)}}else{let l=yield p0(r.localStore,s);a=yield ys(r.localStore,l),yield p_(r,S0(l),s,!1,a.resumeToken)}i.push(a)}return r.Ca.d_(o),i})}function S0(n){return SS(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function x2(n){return function(t){return j(j(t).persistence).Qi()}(j(n).localStore)}function M2(n,e,t,r){return x(this,null,function*(){let i=j(n);if(i.Qa)return void P("SyncEngine","Ignoring unexpected query state notification.");let o=i.Ma.get(e);if(o&&o.length>0)switch(t){case"current":case"not-current":{let s=yield g0(i.localStore,RS(o[0])),a=yu.createSynthesizedRemoteEventForCurrentChange(e,t==="current",$e.EMPTY_BYTE_STRING);yield er(i,s,a);break}case"rejected":yield vs(i.localStore,e,!0),Is(i,e,r);break;default:H()}})}function N2(n,e,t){return x(this,null,function*(){let r=Rh(n);if(r.Qa){for(let i of e){if(r.Ma.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){P("SyncEngine","Adding an already active target "+i);continue}let o=yield p0(r.localStore,i),s=yield ys(r.localStore,o);yield p_(r,S0(o),s.targetId,!1,s.resumeToken),Ah(r.remoteStore,s)}for(let i of t)r.Ma.has(i)&&(yield vs(r.localStore,i,!1).then(()=>{_s(r.remoteStore,i),Is(r,i)}).catch($r))}})}function Rh(n){let e=j(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=C0.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=C2.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=_2.bind(null,e),e.Ca.d_=h2.bind(null,e.eventManager),e.Ca.$a=f2.bind(null,e.eventManager),e}function v_(n){let e=j(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=w2.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=I2.bind(null,e),e}function P2(n,e,t){let r=j(n);(function(o,s,a){return x(this,null,function*(){try{let u=yield s.getMetadata();if(yield function(y,D){let R=j(y),S=Ue(D.createTime);return R.persistence.runTransaction("hasNewerBundle","readonly",O=>R.Gr.getBundleMetadata(O,D.id)).then(O=>!!O&&O.createTime.compareTo(S)>=0)}(o.localStore,u))return yield s.close(),a._completeWith(function(y){return{taskState:"Success",documentsLoaded:y.totalDocuments,bytesLoaded:y.totalBytes,totalDocuments:y.totalDocuments,totalBytes:y.totalBytes}}(u)),Promise.resolve(new Set);a._updateProgress(D0(u));let l=new Tv(u,o.localStore,s.serializer),h=yield s.Ua();for(;h;){let m=yield l.la(h);m&&a._updateProgress(m),h=yield s.Ua()}let p=yield l.complete();return yield er(o,p.Ia,void 0),yield function(y,D){let R=j(y);return R.persistence.runTransaction("Save bundle","readwrite",S=>R.Gr.saveBundleMetadata(S,D))}(o.localStore,u),a._completeWith(p.progress),Promise.resolve(p.Pa)}catch(u){return Kn("SyncEngine",`Loading bundle failed with ${u}`),a._failWith(u),Promise.resolve(new Set)}})})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var Rv=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return x(this,null,function*(){this.serializer=ku(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),yield this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)})}ja(t,r){return null}Ha(t,r){return null}za(t){return l0(this.persistence,new th,t.initialUser,this.serializer)}Ga(t){return new Xd(eh.Zr,this.serializer)}Wa(t){return new oh}terminate(){return x(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})();var gh=class n extends Rv{constructor(e,t,r){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}initialize(e){return x(this,null,function*(){yield ff(n.prototype,this,"initialize").call(this,e),yield this.Ja.initialize(this,e),yield v_(this.Ja.syncEngine),yield As(this.Ja.remoteStore),yield this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}za(e){return l0(this.persistence,new th,e.initialUser,this.serializer)}ja(e,t){let r=this.persistence.referenceDelegate.garbageCollector;return new qy(r,e.asyncQueue,t)}Ha(e,t){let r=new ay(t,this.persistence);return new sy(e.asyncQueue,r)}Ga(e){let t=a_(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Wt.withCacheSize(this.cacheSizeBytes):Wt.DEFAULT;return new ov(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,y0(),Ad(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new oh}},xv=class n extends gh{constructor(e,t){super(e,t,!1),this.Ja=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return x(this,null,function*(){yield ff(n.prototype,this,"initialize").call(this,e);let t=this.Ja.syncEngine;this.sharedClientState instanceof au&&(this.sharedClientState.syncEngine={no:A2.bind(null,t),ro:M2.bind(null,t),io:N2.bind(null,t),Qi:x2.bind(null,t),eo:S2.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.yi(r=>x(this,null,function*(){yield R2(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}Wa(e){let t=y0();if(!au.D(t))throw new k(N.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=a_(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new au(t,e.asyncQueue,r,e.clientId,e.initialUser)}},__=(()=>{class n{initialize(t,r){return x(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Jb(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=T2.bind(null,this.syncEngine),yield vv(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new Iv}()}createDatastore(t){let r=ku(t.databaseInfo.databaseId),i=function(s){return new hv(s)}(t.databaseInfo);return function(s,a,u,l){return new gv(s,a,u,l)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,o,s,a,u){return new yv(i,o,s,a,u)}(this.localStore,this.datastore,t.asyncQueue,r=>Jb(this.syncEngine,r,0),function(){return sh.D()?new sh:new lv}())}createSyncEngine(t,r){return function(o,s,a,u,l,h,p){let m=new Sv(o,s,a,u,l,h);return p&&(m.Qa=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return x(this,null,function*(){var t,r;yield function(o){return x(this,null,function*(){let s=j(o);P("RemoteStore","RemoteStore shutting down."),s.L_.add(5),yield Ss(s),s.k_.shutdown(),s.q_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();function eS(n,e=10240){let t=0;return{read(){return x(this,null,function*(){if(t<n.byteLength){let i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})},cancel(){return x(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var Es=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Ve("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var Mv=class{constructor(e,t){this.Xa=e,this.serializer=t,this.metadata=new et,this.buffer=new Uint8Array,this.eu=function(){return new TextDecoder("utf-8")}(),this.tu().then(r=>{r&&r.ua()?this.metadata.resolve(r.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.aa)}`))},r=>this.metadata.reject(r))}close(){return this.Xa.cancel()}getMetadata(){return x(this,null,function*(){return this.metadata.promise})}Ua(){return x(this,null,function*(){return yield this.getMetadata(),this.tu()})}tu(){return x(this,null,function*(){let e=yield this.nu();if(e===null)return null;let t=this.eu.decode(e),r=Number(t);isNaN(r)&&this.ru(`length string (${t}) is not valid number`);let i=yield this.iu(r);return new Dv(JSON.parse(i),e.length+r)})}su(){return this.buffer.findIndex(e=>e===123)}nu(){return x(this,null,function*(){for(;this.su()<0&&!(yield this.ou()););if(this.buffer.length===0)return null;let e=this.su();e<0&&this.ru("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}iu(e){return x(this,null,function*(){for(;this.buffer.length<e;)(yield this.ou())&&this.ru("Reached the end of bundle when more is expected.");let t=this.eu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}ru(e){throw this.Xa.cancel(),new Error(`Invalid bundle format: ${e}`)}ou(){return x(this,null,function*(){let e=yield this.Xa.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var Nv=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return x(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new k(N.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(i,o){return x(this,null,function*(){let s=j(i),a={documents:o.map(p=>_u(s.serializer,p))},u=yield s.Lo("BatchGetDocuments",s.serializer.databaseId,pe.emptyPath(),a,o.length),l=new Map;u.forEach(p=>{let m=VV(s.serializer,p);l.set(m.key.toString(),m)});let h=[];return o.forEach(p=>{let m=l.get(p.toString());z(!!m),h.push(m)}),h})}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Lr(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return x(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{let i=B.fromPath(r);this.mutations.push(new pu(i,this.precondition(i)))}),yield function(r,i){return x(this,null,function*(){let o=j(r),s={writes:i.map(a=>wu(o.serializer,a))};yield o.Mo("Commit",o.serializer.databaseId,pe.emptyPath(),s)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw H();t=W.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new k(N.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(W.min())?Oe.exists(!1):Oe.updateTime(t):Oe.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(W.min()))throw new k(N.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Oe.updateTime(t)}return Oe.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var Pv=class{constructor(e,t,r,i,o){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=o,this._u=r.maxAttempts,this.t_=new Tu(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(()=>x(this,null,function*(){let e=new Nv(this.datastore),t=this.cu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.lu(i)}))}).catch(r=>{this.lu(r)})}))}cu(e){try{let t=this.updateFunction(e);return!xu(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!$S(t)}return!1}};var kv=class{constructor(e,t,r,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=We.UNAUTHENTICATED,this.clientId=xd.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,s=>x(this,null,function*(){P("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(P("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new et;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>x(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=xs(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Qm(n,e){return x(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),P("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>x(this,null,function*(){r.isEqual(i)||(yield d0(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function tS(n,e){return x(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield w_(n);P("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>Qb(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>Qb(e.remoteStore,i)),n._onlineComponents=e})}function w_(n){return x(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){P("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Qm(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===N.FAILED_PRECONDITION||i.code===N.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Kn("Error using user provided cache. Falling back to memory cache: "+t),yield Qm(n,new Rv)}}else P("FirestoreClient","Using default OfflineComponentProvider"),yield Qm(n,new Rv);return n._offlineComponents})}function xh(n){return x(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(P("FirestoreClient","Using user provided OnlineComponentProvider"),yield tS(n,n._uninitializedComponentsProvider._online)):(P("FirestoreClient","Using default OnlineComponentProvider"),yield tS(n,new __))),n._onlineComponents})}function A0(n){return w_(n).then(e=>e.persistence)}function I_(n){return w_(n).then(e=>e.localStore)}function R0(n){return xh(n).then(e=>e.remoteStore)}function E_(n){return xh(n).then(e=>e.syncEngine)}function k2(n){return xh(n).then(e=>e.datastore)}function Ds(n){return x(this,null,function*(){let e=yield xh(n),t=e.eventManager;return t.onListen=p2.bind(null,e.syncEngine),t.onUnlisten=m2.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=g2.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=y2.bind(null,e.syncEngine),t})}function O2(n){return n.asyncQueue.enqueue(()=>x(this,null,function*(){let e=yield A0(n),t=yield R0(n);return e.setNetworkEnabled(!0),function(i){let o=j(i);return o.L_.delete(0),Ou(o)}(t)}))}function F2(n){return n.asyncQueue.enqueue(()=>x(this,null,function*(){let e=yield A0(n),t=yield R0(n);return e.setNetworkEnabled(!1),function(i){return x(this,null,function*(){let o=j(i);o.L_.add(0),yield Ss(o),o.q_.set("Offline")})}(t)}))}function L2(n,e){let t=new et;return n.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return function(i,o,s){return x(this,null,function*(){try{let a=yield function(l,h){let p=j(l);return p.persistence.runTransaction("read document","readonly",m=>p.localDocuments.getDocument(m,h))}(i,o);a.isFoundDocument()?s.resolve(a):a.isNoDocument()?s.resolve(null):s.reject(new k(N.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let u=xs(a,`Failed to get document '${o} from cache`);s.reject(u)}})}(yield I_(n),e,t)})),t.promise}function x0(n,e,t={}){let r=new et;return n.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return function(o,s,a,u,l){let h=new Es({next:m=>{h.Za(),s.enqueueAndForget(()=>h_(o,p));let y=m.docs.has(a);!y&&m.fromCache?l.reject(new k(N.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&m.fromCache&&u&&u.source==="server"?l.reject(new k(N.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(m)},error:m=>l.reject(m)}),p=new Cu(bs(a.path),h,{includeMetadataChanges:!0,_a:!0});return d_(o,p)}(yield Ds(n),n.asyncQueue,e,t,r)})),r.promise}function V2(n,e){let t=new et;return n.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return function(i,o,s){return x(this,null,function*(){try{let a=yield nh(i,o,!0),u=new ph(o,a.Ts),l=u.ma(a.documents),h=u.applyChanges(l,!1);s.resolve(h.snapshot)}catch(a){let u=xs(a,`Failed to execute query '${o} against cache`);s.reject(u)}})}(yield I_(n),e,t)})),t.promise}function M0(n,e,t={}){let r=new et;return n.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return function(o,s,a,u,l){let h=new Es({next:m=>{h.Za(),s.enqueueAndForget(()=>h_(o,p)),m.fromCache&&u.source==="server"?l.reject(new k(N.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(m)},error:m=>l.reject(m)}),p=new Cu(a,h,{includeMetadataChanges:!0,_a:!0});return d_(o,p)}(yield Ds(n),n.asyncQueue,e,t,r)})),r.promise}function j2(n,e){let t=new Es(e);return n.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return function(i,o){j(i).Y_.add(o),o.next()}(yield Ds(n),t)})),()=>{t.Za(),n.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return function(i,o){j(i).Y_.delete(o)}(yield Ds(n),t)}))}}function U2(n,e,t,r){let i=function(s,a){let u;return u=typeof s=="string"?qS().encode(s):s,function(h,p){return new Mv(h,p)}(function(h,p){if(h instanceof Uint8Array)return eS(h,p);if(h instanceof ArrayBuffer)return eS(new Uint8Array(h),p);if(h instanceof ReadableStream)return h.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(u),a)}(t,ku(e));n.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){P2(yield E_(n),i,r)}))}function B2(n,e){return n.asyncQueue.enqueue(()=>x(this,null,function*(){return function(r,i){let o=j(r);return o.persistence.runTransaction("Get named query","readonly",s=>o.Gr.getNamedQuery(s,i))}(yield I_(n),e)}))}function N0(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var nS=new Map;function D_(n,e,t){if(!t)throw new k(N.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function $2(n,e,t,r){if(e===!0&&r===!0)throw new k(N.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function rS(n){if(!B.isDocumentKey(n))throw new k(N.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function iS(n){if(B.isDocumentKey(n))throw new k(N.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Mh(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":H()}function ye(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new k(N.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Mh(n);throw new k(N.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function P0(n,e){if(e<=0)throw new k(N.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}var mh=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new k(N.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new k(N.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}$2("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=N0((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new k(N.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new k(N.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new k(N.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},ki=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new mh({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new k(N.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new k(N.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new mh(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Ym;switch(r.type){case"firstParty":return new ey(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new k(N.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return x(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=nS.get(t);r&&(P("ComponentProvider","Removing Datastore"),nS.delete(t),r.terminate())}(this),Promise.resolve()}};function k0(n,e,t,r={}){var i;let o=(n=ye(n,ki))._getSettings(),s=`${e}:${t}`;if(o.host!=="firestore.googleapis.com"&&o.host!==s&&Kn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},o),{host:s,ssl:!1})),r.mockUserToken){let a,u;if(typeof r.mockUserToken=="string")a=r.mockUserToken,u=We.MOCK_USER;else{a=oc(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new k(N.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new We(l)}n._authCredentials=new Zm(new Rd(a,u))}}var st=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Be=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Tn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},Tn=class n extends st{constructor(e,t,r){super(e,t,bs(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Be(this.firestore,null,new B(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function O0(n,e,...t){if(n=Re(n),D_("collection","path",e),n instanceof ki){let r=pe.fromString(e,...t);return iS(r),new Tn(n,null,r)}{if(!(n instanceof Be||n instanceof Tn))throw new k(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(pe.fromString(e,...t));return iS(r),new Tn(n.firestore,null,r)}}function H2(n,e){if(n=ye(n,ki),D_("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new k(N.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new st(n,null,function(r){return new nn(pe.emptyPath(),r)}(e))}function T_(n,e,...t){if(n=Re(n),arguments.length===1&&(e=xd.newId()),D_("doc","path",e),n instanceof ki){let r=pe.fromString(e,...t);return rS(r),new Be(n,null,new B(r))}{if(!(n instanceof Be||n instanceof Tn))throw new k(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(pe.fromString(e,...t));return rS(r),new Be(n.firestore,n instanceof Tn?n.converter:null,new B(r))}}function q2(n,e){return n=Re(n),e=Re(e),(n instanceof Be||n instanceof Tn)&&(e instanceof Be||e instanceof Tn)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function F0(n,e){return n=Re(n),e=Re(e),n instanceof st&&e instanceof st&&n.firestore===e.firestore&&Nu(n._query,e._query)&&n.converter===e.converter}var yh=class{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Tu(this,"async_queue_retry"),this.Vu=()=>{let r=Ad();r&&P("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;let t=Ad();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;let t=Ad();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});let t=new et;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}pu(){return x(this,null,function*(){if(this.Pu.length!==0){try{yield this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Hr(e))throw e;P("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}})}gu(e){let t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;let i=function(s){let a=s.message||"";return s.stack&&(a=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),a}(r);throw Ve("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);let i=_v.createAndSchedule(this,e,t,r,o=>this.yu(o));return this.Tu.push(i),i}fu(){this.Eu&&H()}verifyOperationInProgress(){}wu(){return x(this,null,function*(){let e;do e=this.mu,yield e;while(e!==this.mu)})}Su(e){for(let t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){let t=this.Tu.indexOf(e);this.Tu.splice(t,1)}};function Ov(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let o of r)if(o in i&&typeof i[o]=="function")return!0;return!1}(n,["next","error","complete"])}var Fv=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new et,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var e3=-1,Ne=class extends ki{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new yh,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return x(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new yh(e),this._firestoreClient=void 0,yield e}})}};function L0(n,e){let t=typeof n=="object"?n:zi(),r=typeof n=="string"?n:e||"(default)",i=cc(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let o=ic("firestore");o&&k0(i,...o)}return i}function St(n){if(n._terminated)throw new k(N.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||V0(n),n._firestoreClient}function V0(n){var e,t,r;let i=n._freezeSettings(),o=function(a,u,l,h){return new uy(a,u,l,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,N0(h.experimentalLongPollingOptions),h.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new kv(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&function(a){let u=a?._online.build();return{_offline:a?._offline.build(u),_online:u}}(n._componentsProvider))}function z2(n,e){Kn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings();return j0(n,__.provider,{build:r=>new gh(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function G2(n){return x(this,null,function*(){Kn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let e=n._freezeSettings();j0(n,__.provider,{build:t=>new xv(t,e.cacheSizeBytes)})})}function j0(n,e,t){if((n=ye(n,Ne))._firestoreClient||n._terminated)throw new k(N.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new k(N.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},V0(n)}function W2(n){if(n._initialized&&!n._terminated)throw new k(N.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new et;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>x(this,null,function*(){try{yield function(r){return x(this,null,function*(){if(!Mr.D())return Promise.resolve();let i=r+"main";yield Mr.delete(i)})}(a_(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function K2(n){return function(t){let r=new et;return t.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return E2(yield E_(t),r)})),r.promise}(St(n=ye(n,Ne)))}function Q2(n){return O2(St(n=ye(n,Ne)))}function Y2(n){return F2(St(n=ye(n,Ne)))}function Z2(n,e){let t=St(n=ye(n,Ne)),r=new Fv;return U2(t,n._databaseId,e,r),r}function J2(n,e){return B2(St(n=ye(n,Ne)),e).then(t=>t?new st(n,null,t.query):null)}var Ts=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n($e.fromBase64String(e))}catch(t){throw new k(N.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n($e.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var jr=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new k(N.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new tt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Jn=class{constructor(e){this._methodName=e}};var bu=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new k(N.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new k(N.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return te(this._lat,e._lat)||te(this._long,e._long)}};var Su=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,e._values)}};var X2=/^__.*__$/,Lv=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new rn(e,this.data,this.fieldMask,t,this.fieldTransforms):new Fr(e,this.data,t,this.fieldTransforms)}},vh=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new rn(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function U0(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw H()}}var _h=class n{constructor(e,t,r,i,o,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.vu(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return wh(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(U0(this.Cu)&&X2.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}},Vv=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||ku(e)}Qu(e,t,r,i=!1){return new _h({Cu:e,methodName:t,qu:r,path:tt.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Vi(n){let e=n._freezeSettings(),t=ku(n._databaseId);return new Vv(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Nh(n,e,t,r,i,o={}){let s=n.Qu(o.merge||o.mergeFields?2:0,e,t,i);S_("Data must be an object, but it was:",s,r);let a=H0(r,s),u,l;if(o.merge)u=new Ut(s.fieldMask),l=s.fieldTransforms;else if(o.mergeFields){let h=[];for(let p of o.mergeFields){let m=Hv(e,p,t);if(!s.contains(m))throw new k(N.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);z0(h,m)||h.push(m)}u=new Ut(h),l=s.fieldTransforms.filter(p=>u.covers(p.field))}else u=null,l=s.fieldTransforms;return new Lv(new gt(a),u,l)}var Au=class n extends Jn{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function B0(n,e,t){return new _h({Cu:3,qu:e.settings.qu,methodName:n._methodName,xu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var jv=class n extends Jn{_toFieldTransform(e){return new Mi(e.path,new kr)}isEqual(e){return e instanceof n}},Uv=class n extends Jn{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){let t=B0(this,e,!0),r=this.Ku.map(o=>ji(o,t)),i=new Yn(r);return new Mi(e.path,i)}isEqual(e){return e instanceof n&&gf(this.Ku,e.Ku)}},Bv=class n extends Jn{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){let t=B0(this,e,!0),r=this.Ku.map(o=>ji(o,t)),i=new Zn(r);return new Mi(e.path,i)}isEqual(e){return e instanceof n&&gf(this.Ku,e.Ku)}},$v=class n extends Jn{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){let t=new Or(e.serializer,OS(e.serializer,this.$u));return new Mi(e.path,t)}isEqual(e){return e instanceof n&&this.$u===e.$u}};function C_(n,e,t,r){let i=n.Qu(1,e,t);S_("Data must be an object, but it was:",i,r);let o=[],s=gt.empty();Li(r,(u,l)=>{let h=A_(e,u,t);l=Re(l);let p=i.Nu(h);if(l instanceof Au)o.push(h);else{let m=ji(l,p);m!=null&&(o.push(h),s.set(h,m))}});let a=new Ut(o);return new vh(s,a,i.fieldTransforms)}function b_(n,e,t,r,i,o){let s=n.Qu(1,e,t),a=[Hv(e,r,t)],u=[i];if(o.length%2!=0)throw new k(N.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<o.length;m+=2)a.push(Hv(e,o[m])),u.push(o[m+1]);let l=[],h=gt.empty();for(let m=a.length-1;m>=0;--m)if(!z0(l,a[m])){let y=a[m],D=u[m];D=Re(D);let R=s.Nu(y);if(D instanceof Au)l.push(y);else{let S=ji(D,R);S!=null&&(l.push(y),h.set(y,S))}}let p=new Ut(l);return new vh(h,p,s.fieldTransforms)}function $0(n,e,t,r=!1){return ji(t,n.Qu(r?4:3,e))}function ji(n,e){if(q0(n=Re(n)))return S_("Unsupported field value:",e,n),H0(n,e);if(n instanceof Jn)return function(r,i){if(!U0(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){let o=[],s=0;for(let a of r){let u=ji(a,i.Lu(s));u==null&&(u={nullValue:"NULL_VALUE"}),o.push(u),s++}return{arrayValue:{values:o}}}(n,e)}return function(r,i){if((r=Re(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return OS(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=je.fromDate(r);return{timestampValue:ps(i.serializer,o)}}if(r instanceof je){let o=new je(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:ps(i.serializer,o)}}if(r instanceof bu)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ts)return{bytesValue:zS(i.serializer,r._byteString)};if(r instanceof Be){let o=i.databaseId,s=r.firestore._databaseId;if(!s.isEqual(o))throw i.Bu(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:i_(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Su)return function(s,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:s.toArray().map(u=>{if(typeof u!="number")throw a.Bu("VectorValues must only contain numeric values.");return r_(a.serializer,u)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${Mh(r)}`)}(n,e)}function H0(n,e){let t={};return vS(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Li(n,(r,i)=>{let o=ji(i,e.Mu(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function q0(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof je||n instanceof bu||n instanceof Ts||n instanceof Be||n instanceof Jn||n instanceof Su)}function S_(n,e,t){if(!q0(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=Mh(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function Hv(n,e,t){if((e=Re(e))instanceof jr)return e._internalPath;if(typeof e=="string")return A_(n,e);throw wh("Field path arguments must be of type string or ",n,!1,void 0,t)}var ej=new RegExp("[~\\*/\\[\\]]");function A_(n,e,t){if(e.search(ej)>=0)throw wh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new jr(...e.split("."))._internalPath}catch{throw wh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function wh(n,e,t,r,i){let o=r&&!r.isEmpty(),s=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(o||s)&&(u+=" (found",o&&(u+=` in field ${r}`),s&&(u+=` in document ${i}`),u+=")"),new k(N.INVALID_ARGUMENT,a+n+u)}function z0(n,e){return n.some(t=>t.isEqual(e))}var Oi=class{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Be(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new qv(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Ph("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},qv=class extends Oi{data(){return super.data()}};function Ph(n,e){return typeof e=="string"?A_(n,e):e instanceof jr?e._internalPath:e._delegate._internalPath}function G0(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new k(N.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Ru=class{},Fi=class extends Ru{};function tj(n,e,...t){let r=[];e instanceof Ru&&r.push(e),r=r.concat(t),function(o){let s=o.filter(u=>u instanceof zv).length,a=o.filter(u=>u instanceof Ih).length;if(s>1||s>0&&a>0)throw new k(N.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var Ih=class n extends Fi{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return K0(e._query,t),new st(e.firestore,e.converter,Iy(e._query,t))}_parse(e){let t=Vi(e.firestore);return function(o,s,a,u,l,h,p){let m;if(l.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new k(N.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){sS(p,h);let y=[];for(let D of p)y.push(oS(u,o,D));m={arrayValue:{values:y}}}else m=oS(u,o,p)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||sS(p,h),m=$0(a,s,p,h==="in"||h==="not-in");return de.create(l,h,m)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function nj(n,e,t){let r=e,i=Ph("where",n);return Ih._create(i,r,t)}var zv=class n extends Ru{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:we.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,o){let s=i,a=o.getFlattenedFilters();for(let u of a)K0(s,u),s=Iy(s,u)}(e._query,t),new st(e.firestore,e.converter,Iy(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var Gv=class n extends Fi{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,o,s){if(i.startAt!==null)throw new k(N.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new k(N.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ri(o,s)}(e._query,this._field,this._direction);return new st(e.firestore,e.converter,function(i,o){let s=i.explicitOrderBy.concat([o]);return new nn(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function rj(n,e="asc"){let t=e,r=Ph("orderBy",n);return Gv._create(r,t)}var Eh=class n extends Fi{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new st(e.firestore,e.converter,Ud(e._query,this._limit,this._limitType))}};function ij(n){return P0("limit",n),Eh._create("limit",n,"F")}function oj(n){return P0("limitToLast",n),Eh._create("limitToLast",n,"L")}var Dh=class n extends Fi{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=W0(e,this.type,this._docOrFields,this._inclusive);return new st(e.firestore,e.converter,function(i,o){return new nn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,o,i.endAt)}(e._query,t))}};function sj(...n){return Dh._create("startAt",n,!0)}function aj(...n){return Dh._create("startAfter",n,!1)}var Th=class n extends Fi{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=W0(e,this.type,this._docOrFields,this._inclusive);return new st(e.firestore,e.converter,function(i,o){return new nn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,o)}(e._query,t))}};function uj(...n){return Th._create("endBefore",n,!1)}function cj(...n){return Th._create("endAt",n,!0)}function W0(n,e,t,r){if(t[0]=Re(t[0]),t[0]instanceof Oi)return function(o,s,a,u,l){if(!u)throw new k(N.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let h=[];for(let p of is(o))if(p.field.isKeyField())h.push(Ai(s,u.key));else{let m=u.data.field(p.field);if(bh(m))throw new k(N.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+p.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){let y=p.field.canonicalString();throw new k(N.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${y}' (used as the orderBy) does not exist.`)}h.push(m)}return new bn(h,l)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=Vi(n.firestore);return function(s,a,u,l,h,p){let m=s.explicitOrderBy;if(h.length>m.length)throw new k(N.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let y=[];for(let D=0;D<h.length;D++){let R=h[D];if(m[D].field.isKeyField()){if(typeof R!="string")throw new k(N.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof R}`);if(!t_(s)&&R.indexOf("/")!==-1)throw new k(N.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${R}' contains a slash.`);let S=s.path.child(pe.fromString(R));if(!B.isDocumentKey(S))throw new k(N.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${S}' is not because it contains an odd number of segments.`);let O=new B(S);y.push(Ai(a,O))}else{let S=$0(u,l,R);y.push(S)}}return new bn(y,p)}(n._query,n.firestore._databaseId,i,e,t,r)}}function oS(n,e,t){if(typeof(t=Re(t))=="string"){if(t==="")throw new k(N.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!t_(e)&&t.indexOf("/")!==-1)throw new k(N.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(pe.fromString(t));if(!B.isDocumentKey(r))throw new k(N.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ai(n,new B(r))}if(t instanceof Be)return Ai(n,t._key);throw new k(N.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Mh(t)}.`)}function sS(n,e){if(!Array.isArray(n)||n.length===0)throw new k(N.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function K0(n,e){let t=function(i,o){for(let s of i)for(let a of s.getFlattenedFilters())if(o.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new k(N.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new k(N.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Ch=class{convertValue(e,t="none"){switch(Si(e)){case 0:return null;case 1:return e.booleanValue;case 2:return xe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Nr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw H()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Li(e,(i,o)=>{r[i]=this.convertValue(o,t)}),r}convertVectorValue(e){var t,r,i;let o=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(s=>xe(s.doubleValue));return new Su(o)}convertGeoPoint(e){return new bu(xe(e.latitude),xe(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=Xv(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(du(e));default:return null}}convertTimestamp(e){let t=Qn(e);return new je(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=pe.fromString(e);z(n0(r));let i=new cs(r.get(1),r.get(3)),o=new B(r.popFirst(5));return i.isEqual(t)||Ve(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};function kh(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var Wv=class extends Ch{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ts(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Be(this.firestore,null,t)}};var Wn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Ur=class extends Oi{constructor(e,t,r,i,o,s){super(e,t,r,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new ss(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(Ph("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},ss=class extends Ur{data(e={}){return super.data(e)}},Br=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Wn(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new ss(this._firestore,this._userDataWriter,r.key,r,new Wn(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new k(N.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(a=>{let u=new ss(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Wn(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:u,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>o||a.type!==3).map(a=>{let u=new ss(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Wn(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,h=-1;return a.type!==0&&(l=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),a.type!==1&&(s=s.add(a.doc),h=s.indexOf(a.doc.key)),{type:lj(a.type),doc:u,oldIndex:l,newIndex:h}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function lj(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return H()}}function dj(n,e){return n instanceof Ur&&e instanceof Ur?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Br&&e instanceof Br&&n._firestore===e._firestore&&F0(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function Q0(n){n=ye(n,Be);let e=ye(n.firestore,Ne);return x0(St(e),n._key).then(t=>R_(e,n,t))}var Xn=class extends Ch{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ts(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Be(this.firestore,null,t)}};function hj(n){n=ye(n,Be);let e=ye(n.firestore,Ne),t=St(e),r=new Xn(e);return L2(t,n._key).then(i=>new Ur(e,r,n._key,i,new Wn(i!==null&&i.hasLocalMutations,!0),n.converter))}function fj(n){n=ye(n,Be);let e=ye(n.firestore,Ne);return x0(St(e),n._key,{source:"server"}).then(t=>R_(e,n,t))}function Y0(n){n=ye(n,st);let e=ye(n.firestore,Ne),t=St(e),r=new Xn(e);return G0(n._query),M0(t,n._query).then(i=>new Br(e,r,n,i))}function pj(n){n=ye(n,st);let e=ye(n.firestore,Ne),t=St(e),r=new Xn(e);return V2(t,n._query).then(i=>new Br(e,r,n,i))}function gj(n){n=ye(n,st);let e=ye(n.firestore,Ne),t=St(e),r=new Xn(e);return M0(t,n._query,{source:"server"}).then(i=>new Br(e,r,n,i))}function Z0(n,e,t){n=ye(n,Be);let r=ye(n.firestore,Ne),i=kh(n.converter,e,t);return Oh(r,[Nh(Vi(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Oe.none())])}function J0(n,e,t,...r){n=ye(n,Be);let i=ye(n.firestore,Ne),o=Vi(i),s;return s=typeof(e=Re(e))=="string"||e instanceof jr?b_(o,"updateDoc",n._key,e,t,r):C_(o,"updateDoc",n._key,e),Oh(i,[s.toMutation(n._key,Oe.exists(!0))])}function mj(n){return Oh(ye(n.firestore,Ne),[new Lr(n._key,Oe.none())])}function yj(n,e){let t=ye(n.firestore,Ne),r=T_(n),i=kh(n.converter,e);return Oh(t,[Nh(Vi(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Oe.exists(!1))]).then(()=>r)}function vj(n,...e){var t,r,i;n=Re(n);let o={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||Ov(e[s])||(o=e[s],s++);let a={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(Ov(e[s])){let p=e[s];e[s]=(t=p.next)===null||t===void 0?void 0:t.bind(p),e[s+1]=(r=p.error)===null||r===void 0?void 0:r.bind(p),e[s+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let u,l,h;if(n instanceof Be)l=ye(n.firestore,Ne),h=bs(n._key.path),u={next:p=>{e[s]&&e[s](R_(l,n,p))},error:e[s+1],complete:e[s+2]};else{let p=ye(n,st);l=ye(p.firestore,Ne),h=p._query;let m=new Xn(l);u={next:y=>{e[s]&&e[s](new Br(l,m,p,y))},error:e[s+1],complete:e[s+2]},G0(n._query)}return function(m,y,D,R){let S=new Es(R),O=new Cu(y,S,D);return m.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return d_(yield Ds(m),O)})),()=>{S.Za(),m.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return h_(yield Ds(m),O)}))}}(St(l),h,a,u)}function _j(n,e){return j2(St(n=ye(n,Ne)),Ov(e)?e:{next:e})}function Oh(n,e){return function(r,i){let o=new et;return r.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return v2(yield E_(r),i,o)})),o.promise}(St(n),e)}function R_(n,e,t){let r=t.docs.get(e._key),i=new Xn(n);return new Ur(n,i,e._key,r,new Wn(t.hasPendingWrites,t.fromCache),e.converter)}var wj={maxAttempts:5};var aS=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Vi(e)}set(e,t,r){this._verifyNotCommitted();let i=Ar(e,this._firestore),o=kh(i.converter,t,r),s=Nh(this._dataReader,"WriteBatch.set",i._key,o,i.converter!==null,r);return this._mutations.push(s.toMutation(i._key,Oe.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let o=Ar(e,this._firestore),s;return s=typeof(t=Re(t))=="string"||t instanceof jr?b_(this._dataReader,"WriteBatch.update",o._key,t,r,i):C_(this._dataReader,"WriteBatch.update",o._key,t),this._mutations.push(s.toMutation(o._key,Oe.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=Ar(e,this._firestore);return this._mutations=this._mutations.concat(new Lr(t._key,Oe.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new k(N.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Ar(n,e){if((n=Re(n)).firestore!==e)throw new k(N.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var Kv=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=Vi(t)}get(t){let r=Ar(t,this._firestore),i=new Wv(this._firestore);return this._transaction.lookup([r._key]).then(o=>{if(!o||o.length!==1)return H();let s=o[0];if(s.isFoundDocument())return new Oi(this._firestore,i,s.key,s,r.converter);if(s.isNoDocument())return new Oi(this._firestore,i,r._key,null,r.converter);throw H()})}set(t,r,i){let o=Ar(t,this._firestore),s=kh(o.converter,r,i),a=Nh(this._dataReader,"Transaction.set",o._key,s,o.converter!==null,i);return this._transaction.set(o._key,a),this}update(t,r,i,...o){let s=Ar(t,this._firestore),a;return a=typeof(r=Re(r))=="string"||r instanceof jr?b_(this._dataReader,"Transaction.update",s._key,r,i,o):C_(this._dataReader,"Transaction.update",s._key,r),this._transaction.update(s._key,a),this}delete(t){let r=Ar(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=Ar(e,this._firestore),r=new Xn(this._firestore);return super.get(e).then(i=>new Ur(this._firestore,r,t._key,i._document,new Wn(!1,!1),t.converter))}};function Ij(n,e,t){n=ye(n,Ne);let r=Object.assign(Object.assign({},wj),t);return function(o){if(o.maxAttempts<1)throw new k(N.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(o,s,a){let u=new et;return o.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){let l=yield k2(o);new Pv(o.asyncQueue,l,a,s,u).au()})),u.promise}(St(n),i=>e(new Kv(n,i)),r)}function Ej(){return new Au("deleteField")}function Dj(){return new jv("serverTimestamp")}function Tj(...n){return new Uv("arrayUnion",n)}function Cj(...n){return new Bv("arrayRemove",n)}function bj(n){return new $v("increment",n)}(function(e,t=!0){(function(i){Cs=i})(lc),uc(new ac("firestore",(r,{instanceIdentifier:i,options:o})=>{let s=r.getProvider("app").getImmediate(),a=new Ne(new Jm(r.getProvider("auth-internal")),new ny(r.getProvider("app-check-internal")),function(l,h){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new k(N.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new cs(l.options.projectId,h)}(s,i),s);return o=Object.assign({useFetchStreams:t},o),a._setSettings(o),a},"PUBLIC").setMultipleInstances(!0)),ot(ib,"4.7.3",e),ot(ib,"4.7.3","esm2017")})();var Ui=class{constructor(e){return e}},X0="firestore",x_=class{constructor(){return zo(X0)}};var M_=new Y("angularfire2.firestore-instances");function Sj(n,e){let t=Ka(X0,n,e);return t&&new Ui(t)}function Aj(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Ui(r)}}var Rj={provide:x_,deps:[[new ft,M_]]},xj={provide:Ui,useFactory:Sj,deps:[[new ft,M_],qn]};function L3(n,...e){return ot("angularfire",Dr.full,"fst"),mn([xj,Rj,{provide:M_,useFactory:Aj(n),multi:!0,deps:[ve,ht,mi,yi,[new ft,Qa],[new ft,gi],...e]}])}var eA=Le(O0,!0);var Ms=Le(T_,!0);var tA=Le(Q0,!0);var nA=Le(Y0,!0);var V3=Le(L0,!0);var rA=Le(Z0,!0);var Fh=Le(J0,!0);var lA="firebasestorage.googleapis.com",dA="storageBucket",Nj=2*60*1e3,Pj=10*60*1e3;var Fe=class n extends sc{constructor(e,t,r=0){super(N_(e),`Firebase Storage: ${t} (${N_(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,n.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return N_(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},He=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(He||{});function N_(n){return"storage/"+n}function V_(){let n="An unknown error occurred, please check the error payload for server response.";return new Fe(He.UNKNOWN,n)}function kj(n){return new Fe(He.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function Oj(n){return new Fe(He.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function Fj(){let n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Fe(He.UNAUTHENTICATED,n)}function Lj(){return new Fe(He.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function Vj(n){return new Fe(He.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function jj(){return new Fe(He.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Uj(){return new Fe(He.CANCELED,"User canceled the upload/download.")}function Bj(n){return new Fe(He.INVALID_URL,"Invalid URL '"+n+"'.")}function $j(n){return new Fe(He.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function Hj(){return new Fe(He.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+dA+"' property when initializing the app?")}function qj(){return new Fe(He.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function zj(){return new Fe(He.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function Gj(n){return new Fe(He.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function P_(n){return new Fe(He.INVALID_ARGUMENT,n)}function hA(){return new Fe(He.APP_DELETED,"The Firebase app was deleted.")}function Wj(n){return new Fe(He.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Lu(n,e){return new Fe(He.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Fu(n){throw new Fe(He.INTERNAL_ERROR,"Internal error: "+n)}var on=class n{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=n.makeFromUrl(e,t)}catch{return new n(e,"")}if(r.path==="")return r;throw $j(e)}static makeFromUrl(e,t){let r=null,i="([A-Za-z0-9.\\-_]+)";function o(q){q.path.charAt(q.path.length-1)==="/"&&(q.path_=q.path_.slice(0,-1))}let s="(/(.*))?$",a=new RegExp("^gs://"+i+s,"i"),u={bucket:1,path:3};function l(q){q.path_=decodeURIComponent(q.path)}let h="v[A-Za-z0-9_]+",p=t.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",y=new RegExp(`^https?://${p}/${h}/b/${i}/o${m}`,"i"),D={bucket:1,path:3},R=t===lA?"(?:storage.googleapis.com|storage.cloud.google.com)":t,S="([^?#]*)",O=new RegExp(`^https?://${R}/${i}/${S}`,"i"),V=[{regex:a,indices:u,postModify:o},{regex:y,indices:D,postModify:l},{regex:O,indices:{bucket:1,path:2},postModify:l}];for(let q=0;q<V.length;q++){let re=V[q],G=re.regex.exec(e);if(G){let I=G[re.indices.bucket],v=G[re.indices.path];v||(v=""),r=new n(I,v),re.postModify(r);break}}if(r==null)throw Bj(e);return r}},k_=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function Kj(n,e,t){let r=1,i=null,o=null,s=!1,a=0;function u(){return a===2}let l=!1;function h(...S){l||(l=!0,e.apply(null,S))}function p(S){i=setTimeout(()=>{i=null,n(y,u())},S)}function m(){o&&clearTimeout(o)}function y(S,...O){if(l){m();return}if(S){m(),h.call(null,S,...O);return}if(u()||s){m(),h.call(null,S,...O);return}r<64&&(r*=2);let V;a===1?(a=2,V=0):V=(r+Math.random())*1e3,p(V)}let D=!1;function R(S){D||(D=!0,m(),!l&&(i!==null?(S||(a=2),clearTimeout(i),p(0)):S||(a=1)))}return p(0),o=setTimeout(()=>{s=!0,R(!0)},t),R}function Qj(n){n(!1)}function Yj(n){return n!==void 0}function Zj(n){return typeof n=="object"&&!Array.isArray(n)}function j_(n){return typeof n=="string"||n instanceof String}function iA(n){return U_()&&n instanceof Blob}function U_(){return typeof Blob<"u"}function oA(n,e,t,r){if(r<e)throw P_(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw P_(`Invalid value for '${n}'. Expected ${t} or less.`)}function B_(n,e,t){let r=e;return t==null&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function fA(n){let e=encodeURIComponent,t="?";for(let r in n)if(n.hasOwnProperty(r)){let i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var Ps=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}(Ps||{});function Jj(n,e){let t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,o=e.indexOf(n)!==-1;return t||i||o}var O_=class{constructor(e,t,r,i,o,s,a,u,l,h,p,m=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=o,this.additionalRetryCodes_=s,this.callback_=a,this.errorCallback_=u,this.timeout_=l,this.progressCallback_=h,this.connectionFactory_=p,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((y,D)=>{this.resolve_=y,this.reject_=D,this.start_()})}start_(){let e=(r,i)=>{if(i){r(!1,new Ns(!1,null,!0));return}let o=this.connectionFactory_();this.pendingConnection_=o;let s=a=>{let u=a.loaded,l=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,l)};this.progressCallback_!==null&&o.addUploadProgressListener(s),o.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(s),this.pendingConnection_=null;let a=o.getErrorCode()===Ps.NO_ERROR,u=o.getStatus();if(!a||Jj(u,this.additionalRetryCodes_)&&this.retry){let h=o.getErrorCode()===Ps.ABORT;r(!1,new Ns(!1,null,h));return}let l=this.successCodes_.indexOf(u)!==-1;r(!0,new Ns(l,o))})},t=(r,i)=>{let o=this.resolve_,s=this.reject_,a=i.connection;if(i.wasSuccessCode)try{let u=this.callback_(a,a.getResponse());Yj(u)?o(u):o()}catch(u){s(u)}else if(a!==null){let u=V_();u.serverResponse=a.getErrorText(),this.errorCallback_?s(this.errorCallback_(a,u)):s(u)}else if(i.canceled){let u=this.appDelete_?hA():Uj();s(u)}else{let u=jj();s(u)}};this.canceled_?t(!1,new Ns(!1,null,!0)):this.backoffId_=Kj(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Qj(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},Ns=class{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}};function Xj(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function eU(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function tU(n,e){e&&(n["X-Firebase-GMPID"]=e)}function nU(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function rU(n,e,t,r,i,o,s=!0){let a=fA(n.urlParams),u=n.url+a,l=Object.assign({},n.headers);return tU(l,e),Xj(l,t),eU(l,o),nU(l,r),new O_(u,n.method,l,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,s)}function iU(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function oU(...n){let e=iU();if(e!==void 0){let t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}else{if(U_())return new Blob(n);throw new Fe(He.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function sU(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function aU(n){if(typeof atob>"u")throw Gj("base-64");return atob(n)}var An={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},Vu=class{constructor(e,t){this.data=e,this.contentType=t||null}};function uU(n,e){switch(n){case An.RAW:return new Vu(pA(e));case An.BASE64:case An.BASE64URL:return new Vu(gA(n,e));case An.DATA_URL:return new Vu(lU(e),dU(e))}throw V_()}function pA(n){let e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{let o=r,s=n.charCodeAt(++t);r=65536|(o&1023)<<10|s&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function cU(n){let e;try{e=decodeURIComponent(n)}catch{throw Lu(An.DATA_URL,"Malformed data URL.")}return pA(e)}function gA(n,e){switch(n){case An.BASE64:{let i=e.indexOf("-")!==-1,o=e.indexOf("_")!==-1;if(i||o)throw Lu(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case An.BASE64URL:{let i=e.indexOf("+")!==-1,o=e.indexOf("/")!==-1;if(i||o)throw Lu(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=aU(e)}catch(i){throw i.message.includes("polyfill")?i:Lu(n,"Invalid character found")}let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}var Vh=class{constructor(e){this.base64=!1,this.contentType=null;let t=e.match(/^data:([^,]+)?,/);if(t===null)throw Lu(An.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let r=t[1]||null;r!=null&&(this.base64=hU(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}};function lU(n){let e=new Vh(n);return e.base64?gA(An.BASE64,e.rest):cU(e.rest)}function dU(n){return new Vh(n).contentType}function hU(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}var jh=class n{constructor(e,t){let r=0,i="";iA(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(iA(this.data_)){let r=this.data_,i=sU(r,e,t);return i===null?null:new n(i)}else{let r=new Uint8Array(this.data_.buffer,e,t-e);return new n(r,!0)}}static getBlob(...e){if(U_()){let t=e.map(r=>r instanceof n?r.data_:r);return new n(oU.apply(null,t))}else{let t=e.map(s=>j_(s)?uU(An.RAW,s).data:s.data_),r=0;t.forEach(s=>{r+=s.byteLength});let i=new Uint8Array(r),o=0;return t.forEach(s=>{for(let a=0;a<s.length;a++)i[o++]=s[a]}),new n(i,!0)}}uploadData(){return this.data_}};function mA(n){let e;try{e=JSON.parse(n)}catch{return null}return Zj(e)?e:null}function fU(n){if(n.length===0)return null;let e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function pU(n,e){let t=e.split("/").filter(r=>r.length>0).join("/");return n.length===0?t:n+"/"+t}function yA(n){let e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function gU(n,e){return e}var at=class{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||gU}},Lh=null;function mU(n){return!j_(n)||n.length<2?n:yA(n)}function vA(){if(Lh)return Lh;let n=[];n.push(new at("bucket")),n.push(new at("generation")),n.push(new at("metageneration")),n.push(new at("name","fullPath",!0));function e(o,s){return mU(s)}let t=new at("name");t.xform=e,n.push(t);function r(o,s){return s!==void 0?Number(s):s}let i=new at("size");return i.xform=r,n.push(i),n.push(new at("timeCreated")),n.push(new at("updated")),n.push(new at("md5Hash",null,!0)),n.push(new at("cacheControl",null,!0)),n.push(new at("contentDisposition",null,!0)),n.push(new at("contentEncoding",null,!0)),n.push(new at("contentLanguage",null,!0)),n.push(new at("contentType",null,!0)),n.push(new at("metadata","customMetadata",!0)),Lh=n,Lh}function yU(n,e){function t(){let r=n.bucket,i=n.fullPath,o=new on(r,i);return e._makeStorageReference(o)}Object.defineProperty(n,"ref",{get:t})}function vU(n,e,t){let r={};r.type="file";let i=t.length;for(let o=0;o<i;o++){let s=t[o];r[s.local]=s.xform(r,e[s.server])}return yU(r,n),r}function _A(n,e,t){let r=mA(e);return r===null?null:vU(n,r,t)}function _U(n,e,t,r){let i=mA(e);if(i===null||!j_(i.downloadTokens))return null;let o=i.downloadTokens;if(o.length===0)return null;let s=encodeURIComponent;return o.split(",").map(l=>{let h=n.bucket,p=n.fullPath,m="/b/"+s(h)+"/o/"+s(p),y=B_(m,t,r),D=fA({alt:"media",token:l});return y+D})[0]}function wU(n,e){let t={},r=e.length;for(let i=0;i<r;i++){let o=e[i];o.writable&&(t[o.server]=n[o.local])}return JSON.stringify(t)}var Uh=class{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}};function wA(n){if(!n)throw V_()}function IU(n,e){function t(r,i){let o=_A(n,i,e);return wA(o!==null),o}return t}function EU(n,e){function t(r,i){let o=_A(n,i,e);return wA(o!==null),_U(o,i,n.host,n._protocol)}return t}function IA(n){function e(t,r){let i;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?i=Lj():i=Fj():t.getStatus()===402?i=Oj(n.bucket):t.getStatus()===403?i=Vj(n.path):i=r,i.status=t.getStatus(),i.serverResponse=r.serverResponse,i}return e}function DU(n){let e=IA(n);function t(r,i){let o=e(r,i);return r.getStatus()===404&&(o=kj(n.path)),o.serverResponse=i.serverResponse,o}return t}function TU(n,e,t){let r=e.fullServerUrl(),i=B_(r,n.host,n._protocol),o="GET",s=n.maxOperationRetryTime,a=new Uh(i,o,EU(n,t),s);return a.errorHandler=DU(e),a}function CU(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function bU(n,e,t){let r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=CU(null,e)),r}function SU(n,e,t,r,i){let o=e.bucketOnlyServerUrl(),s={"X-Goog-Upload-Protocol":"multipart"};function a(){let V="";for(let q=0;q<2;q++)V=V+Math.random().toString().slice(2);return V}let u=a();s["Content-Type"]="multipart/related; boundary="+u;let l=bU(e,r,i),h=wU(l,t),p="--"+u+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+u+`\r
Content-Type: `+l.contentType+`\r
\r
`,m=`\r
--`+u+"--",y=jh.getBlob(p,r,m);if(y===null)throw qj();let D={name:l.fullPath},R=B_(o,n.host,n._protocol),S="POST",O=n.maxUploadRetryTime,U=new Uh(R,S,IU(n,t),O);return U.urlParams=D,U.headers=s,U.body=y.uploadData(),U.errorHandler=IA(e),U}var H3=256*1024;var sA=null,F_=class{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Ps.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Ps.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Ps.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i){if(this.sent_)throw Fu("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),i!==void 0)for(let o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Fu("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Fu("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Fu("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Fu("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}},L_=class extends F_{initXhr(){this.xhr_.responseType="text"}};function EA(){return sA?sA():new L_}var ks=class n{constructor(e,t){this._service=e,t instanceof on?this._location=t:this._location=on.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new n(e,t)}get root(){let e=new on(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return yA(this._location.path)}get storage(){return this._service}get parent(){let e=fU(this._location.path);if(e===null)return null;let t=new on(this._location.bucket,e);return new n(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw Wj(e)}};function AU(n,e,t){n._throwIfRoot("uploadBytes");let r=SU(n.storage,n._location,vA(),new jh(e,!0),t);return n.storage.makeRequestWithTokens(r,EA).then(i=>({metadata:i,ref:n}))}function RU(n){n._throwIfRoot("getDownloadURL");let e=TU(n.storage,n._location,vA());return n.storage.makeRequestWithTokens(e,EA).then(t=>{if(t===null)throw zj();return t})}function xU(n,e){let t=pU(n._location.path,e),r=new on(n._location.bucket,t);return new ks(n.storage,r)}function MU(n){return/^[A-Za-z]+:\/\//.test(n)}function NU(n,e){return new ks(n,e)}function DA(n,e){if(n instanceof ju){let t=n;if(t._bucket==null)throw Hj();let r=new ks(t,t._bucket);return e!=null?DA(r,e):r}else return e!==void 0?xU(n,e):n}function PU(n,e){if(e&&MU(e)){if(n instanceof ju)return NU(n,e);throw P_("To use ref(service, url), the first argument must be a Storage instance.")}else return DA(n,e)}function aA(n,e){let t=e?.[dA];return t==null?null:on.makeFromBucketSpec(t,n)}function kU(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";let{mockUserToken:i}=r;i&&(n._overrideAuthToken=typeof i=="string"?i:oc(i,n.app.options.projectId))}var ju=class{constructor(e,t,r,i,o){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=o,this._bucket=null,this._host=lA,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Nj,this._maxUploadRetryTime=Pj,this._requests=new Set,i!=null?this._bucket=on.makeFromBucketSpec(i,this._host):this._bucket=aA(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=on.makeFromBucketSpec(this._url,e):this._bucket=aA(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){oA("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){oA("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return x(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let t=yield e.getToken();if(t!==null)return t.accessToken}return null})}_getAppCheckToken(){return x(this,null,function*(){let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ks(this,e)}_makeRequest(e,t,r,i,o=!0){if(this._deleted)return new k_(hA());{let s=rU(e,this._appId,r,i,t,this._firebaseVersion,o);return this._requests.add(s),s.getPromise().then(()=>this._requests.delete(s),()=>this._requests.delete(s)),s}}makeRequestWithTokens(e,t){return x(this,null,function*(){let[r,i]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()})}},uA="@firebase/storage",cA="0.13.2";var TA="storage";function CA(n,e,t){return n=Re(n),AU(n,e,t)}function bA(n){return n=Re(n),RU(n)}function SA(n,e){return n=Re(n),PU(n,e)}function AA(n=zi(),e){n=Re(n);let r=cc(n,TA).getImmediate({identifier:e}),i=ic("storage");return i&&RA(r,...i),r}function RA(n,e,t,r={}){kU(n,e,t,r)}function OU(n,{instanceIdentifier:e}){let t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new ju(t,r,i,e,lc)}function FU(){uc(new ac(TA,OU,"PUBLIC").setMultipleInstances(!0)),ot(uA,cA,""),ot(uA,cA,"esm2017")}FU();var xA=Le(bA,!0);var MA=Le(AA,!0);var NA=Le(SA,!0);var PA=Le(CA,!0);var kA=class n{constructor(e,t){this.auth=e;this.firestore=t}userSubject=new Ze(null);uploadImage(e){return x(this,null,function*(){let t=MA(),r=NA(t,`images/${e.name}`);try{return yield PA(r,e),yield xA(r)}catch(i){throw console.error("Error al subir la imagen:",i),i}})}registerUser(e,t,r,i){return x(this,null,function*(){try{let o=yield JC(this.auth,e,t);yield XC(o.user);let s=i!=="especialista",a=De($({uid:o.user.uid},r),{role:i,createdAt:new Date,habilitado:s,emailVerificado:!1});return yield rA(Ms(this.firestore,"users",o.user.uid),a),De($({},o.user),{role:i})}catch(o){throw console.error(`Error al registrar el ${i}:`,o),o}})}verificarCorreo(e){return x(this,null,function*(){let t=this.auth.currentUser;if(t){yield t.reload();let r=yield this.getUserData(t.uid);t.emailVerified&&(yield Fh(Ms(this.firestore,`users/${t.uid}`),{emailVerificado:!0}))}})}login(e,t){return x(this,null,function*(){try{let r=yield eb(this.auth,e,t);yield this.verificarCorreo(r.user.uid);let i=yield this.getUserData(r.user.uid);if(i.role==="especialista"){if(!i.habilitado)throw new Error("Tu cuenta debe ser aprobada por un administrador antes de poder iniciar sesi\xF3n.");if(!i.emailVerificado)throw new Error("Debes verificar tu correo electr\xF3nico para ingresar.")}else if(!i.emailVerificado)throw new Error("Debes verificar tu correo electr\xF3nico para ingresar.");return this.userSubject.next($($({},r.user),i)),$($({},r.user),i)}catch(r){throw console.error("Error en el login:",r),r}})}getUserData(e){return x(this,null,function*(){let t=Ms(this.firestore,`users/${e}`),r=yield tA(t);if(r.exists())return r.data();throw new Error("No se encontr\xF3 el documento del usuario")})}logout(){return tb(this.auth).then(()=>{this.userSubject.next(null)})}habilitarUsuario(e){return x(this,null,function*(){let t=Ms(this.firestore,"users",e);yield Fh(t,{habilitado:!0})})}inhabilitarUsuario(e){return x(this,null,function*(){let t=Ms(this.firestore,"users",e);yield Fh(t,{habilitado:!1})})}obtenerUsuarios(){return x(this,null,function*(){let e=eA(this.firestore,"users");return(yield nA(e)).docs.map(r=>$({id:r.id},r.data()))})}getUser(){return this.userSubject.asObservable()}static \u0275fac=function(t){return new(t||n)(Z(vi),Z(Ui))};static \u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})};export{he as a,Ye as b,Lf as c,or as d,sr as e,Me as f,J as g,le as h,BR as i,$R as j,Bt as k,HR as l,un as m,GR as n,Hf as o,WR as p,zf as q,wt as r,KR as s,Q as t,mE as u,K as v,ya as w,Y as x,Z as y,xE as z,_a as A,Do as B,Rl as C,M9 as D,N9 as E,hg as F,Et as G,ve as H,Ia as I,vn as J,P9 as K,k9 as L,Nt as M,Bl as N,V9 as O,BP as P,XP as Q,ET as R,h1 as S,f1 as T,DT as U,TT as V,xg as W,j9 as X,CT as Y,U9 as Z,B9 as _,N1 as $,ST as aa,P1 as ba,$9 as ca,k1 as da,H9 as ea,RT as fa,q9 as ga,z9 as ha,G9 as ia,Ro as ja,W9 as ka,K9 as la,xo as ma,LT as na,Q9 as oa,kg as pa,Mo as qa,IG as ra,EG as sa,DG as ta,TG as ua,yk as va,Gg as wa,ZG as xa,mO as ya,Ir as za,_8 as Aa,w8 as Ba,gi as Ca,mi as Da,$F as Ea,B8 as Fa,$8 as Ga,O6 as Ha,F6 as Ia,YL as Ja,Kn as Ka,Q6 as La,k as Ma,je as Na,tt as Oa,B as Pa,Z6 as Qa,cs as Ra,$2 as Sa,ye as Ta,k0 as Ua,Be as Va,O0 as Wa,H2 as Xa,T_ as Ya,q2 as Za,F0 as _a,e3 as $a,St as ab,z2 as bb,G2 as cb,W2 as db,K2 as eb,Q2 as fb,Y2 as gb,Z2 as hb,J2 as ib,Ts as jb,jr as kb,bu as lb,tj as mb,nj as nb,rj as ob,ij as pb,oj as qb,sj as rb,aj as sb,uj as tb,cj as ub,Ch as vb,Ur as wb,ss as xb,Br as yb,dj as zb,Q0 as Ab,hj as Bb,fj as Cb,Y0 as Db,pj as Eb,gj as Fb,Z0 as Gb,J0 as Hb,mj as Ib,yj as Jb,vj as Kb,_j as Lb,Oh as Mb,aS as Nb,Ij as Ob,Ej as Pb,Dj as Qb,Tj as Rb,Cj as Sb,bj as Tb,L3 as Ub,V3 as Vb,kA as Wb};
