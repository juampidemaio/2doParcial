import{a as ye,b as A}from"./chunk-BNGB2G7Z.js";import{a as Ue,b as qe,c as We}from"./chunk-LRE7NJHY.js";import{a as q}from"./chunk-LKYCJ56J.js";import{A as p,Aa as je,B as be,Ba as He,C as s,D as f,Da as Ge,E as F,Ea as Be,F as z,Fa as Le,G as we,Ga as Y,H as ve,I as Se,J as xe,L as Ie,O as Me,P as Oe,S as k,T as D,U as Fe,V as Ce,Y as $,_ as Ee,a as H,c as W,d as m,da as ke,e as U,f as R,fa as G,g as X,h as M,i as O,ia as B,j as Z,ka as De,l as _,m as b,na as Ae,oa as T,pa as te,q as l,qa as j,r as x,ra as ie,sa as ne,t as S,ta as Ve,u as d,ua as Ne,v as a,va as oe,w as n,x as ee,xa as ze,y as v,ya as Re,z as h,za as $e}from"./chunk-YGP5ZKKQ.js";var Q=W(Y());var V=class r{constructor(t){this.firestore=t}getEspecialistasPorEspecialidad(t){return m(this,null,function*(){let e=G(this.firestore,"users"),o=(yield B(e)).docs.map(c=>H({id:c.id},c.data())).filter(c=>this.especialistaValido(c,t));return console.log("Especialistas filtrados:",o),o})}especialistaValido(t,e){return t.role==="especialista"&&t.especialidades.includes(e)}getPacientesUnicosPorEspecialidad(t,e){return m(this,null,function*(){let i=G(this.firestore,"Turnos"),o=yield B(i),c=new Set,u=[],g=o.docs.map(I=>{let K=I.data();return H({id:I.id},K)}).filter(I=>{let K=I.especialista_id===t,Pe=I.especialidad===e;return K&&Pe&&c.add(I.pacienteId),K&&Pe});console.log("Turnos solicitados:",g);let y=Array.from(c);return yield this.getPacientesPorIds(y)})}getPacientesUnicosPorEspecialista(t){return m(this,null,function*(){let e=G(this.firestore,"Turnos"),i=yield B(e),o=new Set,c=[],u=i.docs.map(w=>{let I=w.data();return H({id:w.id},I)}).filter(w=>{let I=w.especialista_id===t;return I&&w.pacienteId&&o.add(w.pacienteId),I});console.log("Turnos solicitados:",u);let g=Array.from(o);return yield this.getPacientesPorIds(g)})}getPacientesPorIds(t){return m(this,null,function*(){let e=G(this.firestore,"users"),i=[];for(let o of t)if(o){let c=De(e,Ae("uid","==",o));(yield B(c)).forEach(g=>{let y=g.data();i.push(H({id:g.id},y))})}else console.warn("ID de paciente es undefined, omitiendo este ID.");return i})}getHorariosPorEspecialista(t){return m(this,null,function*(){let e=G(this.firestore,"horarios"),i=yield B(e),o=yield this.getTurnosPorEspecialista(t);return i.docs.map(c=>{let u=c.data();return H({id:c.id},u)}).filter(c=>c.especialistaId===t&&this.isWithinNext15Days(c.fecha)&&!this.isHorarioOcupado(c,o))})}getTurnosPorEspecialista(t){return m(this,null,function*(){let e=G(this.firestore,"turnos");return(yield B(e)).docs.map(o=>{let c=o.data();return H({id:o.id},c)}).filter(o=>o.especialistaId===t)})}isHorarioOcupado(t,e){let i=new Date(t.fecha),o=new Date(i);return o.setMinutes(o.getMinutes()+30),e.some(c=>{let u=new Date(c.fecha),g=new Date(u);return g.setMinutes(g.getMinutes()+30),u<o&&g>i})}isWithinNext15Days(t){let e=new Date(t),i=new Date,o=new Date;return o.setDate(i.getDate()+15),e>=i&&e<=o}static \u0275fac=function(e){return new(e||r)(M(ke))};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})};function Ke(r,t){if(r&1&&(a(0,"option",12),s(1),n()),r&2){let e=t.$implicit;d("value",e.nombre),l(),f(e.nombre)}}function Xe(r,t){if(r&1){let e=v();a(0,"option",13),h("nombreEspecialista",function(){let o=_(e).$implicit;return b(o)}),s(1),n()}if(r&2){let e=t.$implicit;d("value",e.uid),l(),f(e.nombre)}}function Ze(r,t){if(r&1&&(a(0,"option",12),s(1),n()),r&2){let e=t.$implicit;d("value",e.id),l(),we("",e.fecha," - ",e.hora_inicio,"hs hasta ",e.hora_fin,"hs")}}function et(r,t){if(r&1&&(a(0,"div")(1,"label",14),s(2,"Paciente:"),n(),ee(3,"input",15),a(4,"label",16),s(5,"DNI:"),n(),ee(6,"input",17),a(7,"label",18),s(8,"Obra Social:"),n(),ee(9,"input",19),n()),r&2){let e=p();l(3),d("readonly",e.isAdmin),l(3),d("readonly",e.isAdmin),l(3),d("readonly",e.isAdmin)}}function tt(r,t){if(r&1){let e=v();a(0,"app-listado-paciente",20),h("usuarioSeleccionado",function(o){_(e);let c=p();return b(c.setPacienteData(o))}),n()}}var re=class r{constructor(t,e,i,o,c,u){this.especialidadService=t;this.especialistaService=e;this.turnoService=i;this.authService=o;this.fb=c;this.router=u;this.turnoForm=this.fb.group({especialidad:["",j.required],especialista:["",j.required],horario:["",j.required],paciente:["",j.required],dni:["",[j.required,j.pattern(/^[0-9]{8,}$/)]],obraSocial:["",j.required]})}especialidades=[];especialistas=[];horarios=[];turnoForm;isAdmin=!1;isPaciente=!1;usuarioSeleccionado;obtenerIdPaciente;nombreEspecialista;especialiadaSeleccionada;ngOnInit(){this.cargarEspecialidades(),this.checkUserRole()}cargarEspecialidades(){return m(this,null,function*(){this.especialidades=yield this.especialidadService.getEspecialidades()})}checkUserRole(){return m(this,null,function*(){this.authService.getUser().subscribe(t=>{t&&(this.isAdmin=t.role==="administrador",this.isPaciente=t.role==="paciente")})})}setPacienteData(t){return m(this,null,function*(){this.usuarioSeleccionado=t,t&&this.turnoForm.patchValue({paciente:t.nombre,dni:t.dni,obraSocial:t.obraSocial,especialista:""})})}onEspecialidadChange(t){return m(this,null,function*(){let i=t.target.value;if(this.especialiadaSeleccionada=i,console.log("Nombre de especialidad seleccionada:",i),this.turnoForm.patchValue({especialista:""}),this.horarios=[],i)try{this.especialistas=yield this.especialistaService.getEspecialistasPorEspecialidad(i),console.log("Especialistas cargados:",this.especialistas)}catch(o){console.error("Error al cargar especialistas:",o),Q.default.fire("Error","No se pudieron cargar los especialistas","error")}else this.especialistas=[]})}onEspecialistaChange(t){return m(this,null,function*(){let i=t.target.value;if(console.log("ID del especialista seleccionado:",i),i)try{let o=this.especialistas.find(c=>c.uid===i);o&&(this.nombreEspecialista=`${o.nombre} ${o.apellido}`),this.horarios=yield this.turnoService.obtenerTurnosDisponibles(i,this.especialiadaSeleccionada),this.horarios.sort((c,u)=>{let g=new Date(c.fecha),y=new Date(u.fecha);return g.getTime()!==y.getTime()?g.getTime()-y.getTime():c.hora_inicio.localeCompare(u.hora_inicio)}),console.log("Turnos disponibles cargados:",this.horarios)}catch(o){console.error("Error al cargar turnos:",o),Q.default.fire("Error","No se pudieron cargar los turnos","error")}else this.horarios=[]})}solicitarTurno(){return m(this,null,function*(){try{this.authService.getUser().subscribe(e=>{e.role==="paciente"?(this.obtenerIdPaciente=e.uid,this.turnoForm.patchValue({especialista:this.nombreEspecialista,paciente:e.nombre,dni:e.dni,obraSocial:e.obraSocial})):(this.obtenerIdPaciente=this.usuarioSeleccionado.uid,this.turnoForm.patchValue({especialista:this.nombreEspecialista}))});let t=this.turnoForm.value;yield this.turnoService.solicitarTurno(t,this.obtenerIdPaciente),Q.default.fire("Registro exitoso","El turno ha sido solicitado correctamente","success"),this.router.navigate(["/bienvenida"])}catch(t){console.error("Error al solicitar el turno:",t),Q.default.fire("Error","No se pudo solicitar el turno. Int\xE9ntalo nuevamente.","error")}})}static \u0275fac=function(e){return new(e||r)(x(q),x(V),x(A),x(T),x(Ge),x($))};static \u0275cmp=O({type:r,selectors:[["app-solicitar-turno"]],decls:17,vars:6,consts:[[3,"ngSubmit","formGroup"],["for","especialidad"],["id","especialidad","formControlName","especialidad",3,"change"],[3,"value",4,"ngFor","ngForOf"],["for","especialista"],["id","especialista","formControlName","especialista",3,"change"],[3,"value","nombreEspecialista",4,"ngFor","ngForOf"],["for","horario"],["id","horario","formControlName","horario"],[4,"ngIf"],[3,"usuarioSeleccionado",4,"ngIf"],["type","submit"],[3,"value"],[3,"nombreEspecialista","value"],["for","paciente"],["id","paciente","formControlName","paciente","type","text",3,"readonly"],["for","dni"],["id","dni","formControlName","dni","type","text",3,"readonly"],["for","obraSocial"],["id","obraSocial","formControlName","obraSocial","type","text",3,"readonly"],[3,"usuarioSeleccionado"]],template:function(e,i){e&1&&(a(0,"form",0),h("ngSubmit",function(){return i.solicitarTurno()}),a(1,"label",1),s(2,"Especialidad:"),n(),a(3,"select",2),h("change",function(c){return i.onEspecialidadChange(c)}),S(4,Ke,2,2,"option",3),n(),a(5,"label",4),s(6,"Especialista:"),n(),a(7,"select",5),h("change",function(c){return i.onEspecialistaChange(c)}),S(8,Xe,2,2,"option",6),n(),a(9,"label",7),s(10,"Horario:"),n(),a(11,"select",8),S(12,Ze,2,4,"option",3),n(),S(13,et,10,3,"div",9)(14,tt,1,0,"app-listado-paciente",10),a(15,"button",11),s(16,"Solicitar Turno"),n()()),e&2&&(d("formGroup",i.turnoForm),l(4),d("ngForOf",i.especialidades),l(4),d("ngForOf",i.especialistas),l(4),d("ngForOf",i.horarios),l(),d("ngIf",i.isAdmin),l(),d("ngIf",i.isAdmin))},dependencies:[k,D,oe,je,He,te,$e,ie,ne,ze,Re,Ue],styles:['@charset "UTF-8";form[_ngcontent-%COMP%]{max-width:800px;margin:20px auto;padding:30px;border:2px solid #007bff;border-radius:15px;background-color:#e0f7fa;box-shadow:0 4px 20px #0003}label[_ngcontent-%COMP%]{font-weight:700;margin-bottom:5px;display:block;color:#007bff}input[type=text][_ngcontent-%COMP%], select[_ngcontent-%COMP%]{width:100%;padding:12px;border:1px solid #007bff;border-radius:6px;font-size:16px;margin-bottom:15px;box-sizing:border-box;transition:border-color .3s,background-color .3s;background-color:#f1f1f1}input[type=text][_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus{border-color:#0056b3;outline:none;background-color:#fff}div[ngIf][_ngcontent-%COMP%]{color:#dc3545;font-size:.9em;margin-top:-10px;margin-bottom:10px}button[type=submit][_ngcontent-%COMP%]{background-color:#007bff;color:#fff;padding:12px 15px;border:none;border-radius:6px;cursor:pointer;transition:background-color .3s,transform .2s;width:100%;font-size:1em}button[type=submit][_ngcontent-%COMP%]:hover{background-color:#0056b3;transform:translateY(-2px)}div[_ngcontent-%COMP%]{margin-bottom:20px}div[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]   ngIf[_ngcontent-%COMP%]{margin-bottom:20px}']})};var de=class r{constructor(t,e){this.authService=t;this.router=e}canActivate(t,e){return this.authService.getUser().pipe(U(i=>i&&(i.role==="administrador"||i.role==="paciente")?!0:(this.router.navigate(["/bienvenida"]),console.log("Acceso denegado: no es administrador ni paciente"),!1)))}static \u0275fac=function(e){return new(e||r)(M(T),M($))};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})};var P=W(Y());var it=()=>["lunes","martes","mi\xE9rcoles","jueves","viernes","s\xE1bado","domingo"];function nt(r,t){if(r&1){let e=v();a(0,"div")(1,"label"),s(2),Me(3,"titlecase"),n(),a(4,"div",5)(5,"input",6),xe("ngModelChange",function(o){let c=_(e).$implicit,u=p(2);return Se(u.disponibilidadSemana[c].horaInicio,o)||(u.disponibilidadSemana[c].horaInicio=o),b(o)}),n(),a(6,"input",7),xe("ngModelChange",function(o){let c=_(e).$implicit,u=p(2);return Se(u.disponibilidadSemana[c].horaFin,o)||(u.disponibilidadSemana[c].horaFin=o),b(o)}),n()()()}if(r&2){let e=t.$implicit,i=p(2);l(2),f(Oe(3,7,e)),l(3),be("name","",e,"HoraInicio"),ve("ngModel",i.disponibilidadSemana[e].horaInicio),l(),be("name","",e,"HoraFin"),ve("ngModel",i.disponibilidadSemana[e].horaFin)}}function ot(r,t){if(r&1){let e=v();a(0,"div")(1,"form",2),h("ngSubmit",function(){_(e);let o=p();return b(o.guardarDisponibilidad())}),S(2,nt,7,9,"div",3),a(3,"button",4),s(4,"Guardar Disponibilidad"),n()()()}r&2&&(l(2),d("ngForOf",Ie(1,it)))}function at(r,t){r&1&&(a(0,"p"),s(1,"Selecciona un especialista para asignar disponibilidad."),n())}var pe=class r{constructor(t){this.turnoService=t}usuarioSeleccionado=null;disponibilidadSemana={lunes:{horaInicio:"",horaFin:""},martes:{horaInicio:"",horaFin:""},mi\u00E9rcoles:{horaInicio:"",horaFin:""},jueves:{horaInicio:"",horaFin:""},viernes:{horaInicio:"",horaFin:""},s\u00E1bado:{horaInicio:"",horaFin:""},domingo:{horaInicio:"",horaFin:""}};horariosClinica={lunes:{apertura:"08:00",cierre:"19:00"},martes:{apertura:"08:00",cierre:"19:00"},mi\u00E9rcoles:{apertura:"08:00",cierre:"19:00"},jueves:{apertura:"08:00",cierre:"19:00"},viernes:{apertura:"08:00",cierre:"19:00"},s\u00E1bado:{apertura:"08:00",cierre:"14:00"},domingo:{apertura:null,cierre:null}};mostrarUsuario(t){this.usuarioSeleccionado=t}esHorarioValido(t){let e=parseInt(t.split(":")[1],10);return e===0||e===30}guardarDisponibilidad(){return m(this,null,function*(){if(!this.usuarioSeleccionado){P.default.fire("Error","Por favor, selecciona un especialista.","error");return}for(let t in this.disponibilidadSemana){let e=this.disponibilidadSemana[t],i=this.horariosClinica[t];if(e.horaInicio&&!this.esHorarioValido(e.horaInicio)||e.horaFin&&!this.esHorarioValido(e.horaFin)){P.default.fire("Error",`Los horarios de ${t} deben ser en intervalos de media hora (ej. 08:00 o 08:30).`,"error");return}if(i.apertura&&i.cierre){if(e.horaInicio<i.apertura||e.horaInicio>i.cierre||e.horaFin<i.apertura||e.horaFin>i.cierre){P.default.fire("Error",`El horario de ${t} debe estar entre ${i.apertura} y ${i.cierre}.`,"error");return}if(e.horaInicio>=e.horaFin){P.default.fire("Error",`En ${t}, la hora de inicio debe ser anterior a la hora de fin.`,"error");return}}else if(e.horaInicio||e.horaFin){P.default.fire("Error",`El d\xEDa ${t} est\xE1 cerrado, no debe haber horarios de disponibilidad.`,"error");return}}try{yield this.turnoService.guardarDisponibilidad(this.usuarioSeleccionado.uid,this.disponibilidadSemana),this.generarTurnosProximos15Dias(),P.default.fire("\xC9xito","Disponibilidad guardada correctamente.","success")}catch(t){console.error("Error al guardar la disponibilidad:",t),P.default.fire("Error","No se pudo guardar la disponibilidad.","error")}})}generarTurnosProximos15Dias(){return m(this,null,function*(){if(console.log("entramos a la creacion de turnos"),!this.usuarioSeleccionado){P.default.fire("Error","Por favor, selecciona un especialista.","error");return}let t=yield this.turnoService.obtenerDisponibilidad(this.usuarioSeleccionado.uid);if(!t){P.default.fire("Error","No se encontr\xF3 disponibilidad para el especialista seleccionado.","error");return}let e=[],i=new Date;for(let o=0;o<15;o++){let c=new Date(i);c.setDate(i.getDate()+o);let u=this.obtenerNombreDia(c);if(t[u]){let g=t[u];if(g.horaInicio&&g.horaFin){let y=g.horaInicio;for(;y<g.horaFin;){let w=this.sumarMinutos(y,30);w<=g.horaFin&&e.push({especialista_id:this.usuarioSeleccionado.uid,fecha:c.toISOString().split("T")[0],hora_inicio:y,hora_fin:w,estado:"disponible"}),y=w}}}}try{yield this.turnoService.guardarTurnos(e),P.default.fire("\xC9xito","Turnos generados para los pr\xF3ximos 15 d\xEDas.","success")}catch(o){console.error("Error al generar los turnos:",o),P.default.fire("Error","No se pudieron generar los turnos.","error")}})}obtenerNombreDia(t){return["domingo","lunes","martes","mi\xE9rcoles","jueves","viernes","s\xE1bado"][t.getDay()]}sumarMinutos(t,e){let[i,o]=t.split(":").map(Number),c=new Date;c.setHours(i,o+e);let u=String(c.getHours()).padStart(2,"0"),g=String(c.getMinutes()).padStart(2,"0");return`${u}:${g}`}static \u0275fac=function(e){return new(e||r)(x(A))};static \u0275cmp=O({type:r,selectors:[["app-gestion-horarios"]],decls:5,vars:3,consts:[[3,"usuarioSeleccionado"],[4,"ngIf"],[3,"ngSubmit"],[4,"ngFor","ngForOf"],["type","submit"],[1,"horarios"],["type","time","placeholder","Hora de inicio",3,"ngModelChange","ngModel","name"],["type","time","placeholder","Hora de fin",3,"ngModelChange","ngModel","name"]],template:function(e,i){e&1&&(a(0,"app-listado-especialista",0),h("usuarioSeleccionado",function(c){return i.mostrarUsuario(c)}),n(),a(1,"h2"),s(2),n(),S(3,ot,5,2,"div",1)(4,at,2,0,"p",1)),e&2&&(l(2),F("Asignar Disponibilidad para ",(i.usuarioSeleccionado==null?null:i.usuarioSeleccionado.nombre)||"Selecciona un especialista",""),l(),d("ngIf",i.usuarioSeleccionado),l(),d("ngIf",!i.usuarioSeleccionado))},dependencies:[k,D,oe,te,ie,ne,qe,Ne,Ve,Fe],styles:['@charset "UTF-8";form[_ngcontent-%COMP%]{max-width:800px;margin:20px auto;padding:30px;border:2px solid #007bff;border-radius:15px;background-color:#e0f7fa;box-shadow:0 4px 20px #0003}label[_ngcontent-%COMP%]{font-weight:700;margin-bottom:5px;display:block;color:#007bff}.horarios[_ngcontent-%COMP%]{display:flex;gap:15px}input[type=time][_ngcontent-%COMP%]{width:48%;padding:12px;border:1px solid #007bff;border-radius:6px;font-size:16px;box-sizing:border-box;background-color:#f1f1f1;transition:border-color .3s,background-color .3s}input[type=time][_ngcontent-%COMP%]:focus{border-color:#0056b3;outline:none;background-color:#fff}button[type=submit][_ngcontent-%COMP%]{background-color:#007bff;color:#fff;padding:12px 15px;border:none;border-radius:6px;cursor:pointer;transition:background-color .3s,transform .2s;width:100%;font-size:1em}button[type=submit][_ngcontent-%COMP%]:hover{background-color:#0056b3;transform:translateY(-2px)}div[_ngcontent-%COMP%]{margin-bottom:20px}']})};var L=W(Y());function rt(r,t){if(r&1){let e=v();a(0,"div")(1,"input",1),h("change",function(o){_(e);let c=p();return b(c.onEspecialidadChange(o))}),n(),s(2),n()}if(r&2){let e=t.$implicit;l(),d("value",e.nombre),l(),F(" ",e.nombre,`
`)}}function st(r,t){if(r&1){let e=v();a(0,"div")(1,"input",2),h("change",function(o){let c=_(e).$implicit,u=p();return b(u.onEspecialistaChange(o,c))}),n(),s(2),n()}if(r&2){let e=t.$implicit;l(),d("value",e.uid),l(),z(" ",e.nombre," ",e.apellido,`
`)}}function ct(r,t){if(r&1){let e=v();a(0,"button",5),h("click",function(){_(e);let o=p().$implicit,c=p();return b(c.cancelarTurno(o))}),s(1," Cancelar Turno "),n()}}function lt(r,t){r&1&&(a(0,"button",6),s(1," no acciones "),n())}function dt(r,t){if(r&1&&(a(0,"tr")(1,"td"),s(2),n(),a(3,"td"),s(4),n(),a(5,"td"),s(6),n(),a(7,"td"),s(8),n(),a(9,"td"),s(10),n(),a(11,"td"),s(12),n(),a(13,"td"),s(14),n(),a(15,"td"),s(16),n(),a(17,"td"),S(18,ct,2,0,"button",3)(19,lt,2,0,"button",4),n()()),r&2){let e=t.$implicit,i=p();l(2),f(e.dni),l(2),f(e.paciente),l(2),f(e.obraSocial),l(2),f(i.nombreEspecialista),l(2),f(e.especialidad),l(2),f(e.fecha),l(2),z("",e.hora_inicio," - ",e.hora_fin,""),l(2),f(e.estado),l(2),d("ngIf",e.estado==="solicitado"),l(),d("ngIf",e.estado!=="solicitado")}}var ue=class r{constructor(t,e,i){this.turnoService=t;this.especialidadService=e;this.especialistaService=i}especialidades=[];especialistas=[];horarios=[];nombreEspecialista;especialidadSeleccionada="";ngOnInit(){this.cargarEspecialidades()}cargarEspecialidades(){return m(this,null,function*(){this.especialidades=yield this.especialidadService.getEspecialidades()})}onEspecialidadChange(t){return m(this,null,function*(){let e=t.target;if(this.especialidadSeleccionada=e.value,this.especialidadSeleccionada)try{this.especialistas=yield this.especialistaService.getEspecialistasPorEspecialidad(this.especialidadSeleccionada),this.horarios=[]}catch{L.default.fire("Error","No se pudieron cargar los especialistas","error")}else this.especialistas=[],this.horarios=[]})}onEspecialistaChange(t,e){return m(this,null,function*(){let o=t.target.value;if(o){this.nombreEspecialista=`${e.nombre} ${e.apellido}`;try{let c=yield this.turnoService.obtenerTurnosDisponiblesEspecialista(o);this.horarios=c.filter(u=>u.especialidad===this.especialidadSeleccionada),this.horarios.sort((u,g)=>new Date(u.fecha).getTime()-new Date(g.fecha).getTime())}catch{L.default.fire("Error","No se pudieron cargar los turnos","error")}}else this.horarios=[]})}cancelarTurno(t){return m(this,null,function*(){if(["Aceptado","Realizado","Rechazado"].includes(t.estado)){L.default.fire("Aviso","No se puede cancelar un turno aceptado, realizado o rechazado","info");return}let{isConfirmed:e,value:i}=yield L.default.fire({title:"\xBFEst\xE1s seguro de cancelar el turno?",text:"Por favor, ingresa el motivo de la cancelaci\xF3n",input:"textarea",inputPlaceholder:"Escribe aqu\xED el motivo...",inputAttributes:{"aria-label":"Motivo de cancelaci\xF3n"},confirmButtonText:"Cancelar turno",showCancelButton:!0,cancelButtonText:"Volver",inputValidator:o=>o?null:"El motivo es requerido para cancelar el turno"});if(e&&i)try{yield this.turnoService.cancelarTurno(t.id,i),L.default.fire("Cancelado","El turno ha sido cancelado con \xE9xito","success"),yield this.onEspecialistaChange({target:{value:t.especialistaId}},{nombre:t.nombreEspecialista,apellido:t.apellidoEspecialista})}catch{L.default.fire("Error","No se pudo cancelar el turno","error")}})}static \u0275fac=function(e){return new(e||r)(x(A),x(q),x(V))};static \u0275cmp=O({type:r,selectors:[["app-gestionar-turnos"]],decls:31,vars:3,consts:[[4,"ngFor","ngForOf"],["type","radio","name","especialidad",3,"change","value"],["type","radio","name","especialista",3,"change","value"],["class","cancelar",3,"click",4,"ngIf"],["class","no-accion","disabled","",4,"ngIf"],[1,"cancelar",3,"click"],["disabled","",1,"no-accion"]],template:function(e,i){e&1&&(a(0,"h2"),s(1,"Listado de Turnos"),n(),a(2,"label"),s(3,"Especialidad:"),n(),S(4,rt,3,2,"div",0),a(5,"label"),s(6,"Especialista:"),n(),S(7,st,3,3,"div",0),a(8,"table")(9,"thead")(10,"tr")(11,"th"),s(12,"DNI"),n(),a(13,"th"),s(14,"Paciente"),n(),a(15,"th"),s(16,"Obra Social"),n(),a(17,"th"),s(18,"Especialista"),n(),a(19,"th"),s(20,"Especialidad"),n(),a(21,"th"),s(22,"Fecha"),n(),a(23,"th"),s(24,"Horario"),n(),a(25,"th"),s(26,"Estado"),n(),a(27,"th"),s(28,"Acciones"),n()()(),a(29,"tbody"),S(30,dt,20,11,"tr",0),n()()),e&2&&(l(4),d("ngForOf",i.especialidades),l(3),d("ngForOf",i.especialistas),l(23),d("ngForOf",i.horarios))},dependencies:[k,D],styles:['@charset "UTF-8";h2[_ngcontent-%COMP%]{color:#154360;text-align:center;margin-bottom:1rem;font-weight:700;font-size:1.5rem}label[_ngcontent-%COMP%]{font-weight:700;color:#154360;margin-right:.5rem}select[_ngcontent-%COMP%]{padding:.5rem;border-radius:4px;border:1px solid #D5D8DC;margin-bottom:1rem;margin-right:1rem;outline:none;transition:border-color .3s ease}select[_ngcontent-%COMP%]:focus{border-color:#154360}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;background-color:#fff;box-shadow:0 4px 8px #0000001a;margin:0 auto;border-radius:8px;overflow:hidden}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:1rem;text-align:left}thead[_ngcontent-%COMP%]{background-color:#154360;color:#fff}thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:700;text-transform:uppercase;letter-spacing:.05em}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:background-color .3s ease,transform .2s ease}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f2f3f4}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#d5e8e8;transform:scale(1.01)}tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom:1px solid #F2F3F4}button[_ngcontent-%COMP%]{padding:.5rem 1rem;font-size:.9rem;border:none;border-radius:4px;color:#fff;cursor:pointer;transition:background-color .3s ease,transform .2s ease;width:100%}button.no-accion[_ngcontent-%COMP%]{background-color:#b0e915}button.cancelar[_ngcontent-%COMP%]{background-color:#c0392b}button.cancelar[_ngcontent-%COMP%]:hover{background-color:#a93226;transform:scale(1.05)}td.estado[_ngcontent-%COMP%]{font-weight:700;color:#1e8449}td.estado.inhabilitado[_ngcontent-%COMP%]{color:#c0392b}']})};var C=W(Y());function pt(r,t){if(r&1){let e=v();a(0,"div")(1,"input",1),h("change",function(o){_(e);let c=p();return b(c.onEspecialidadChange(o))}),n(),s(2),n()}if(r&2){let e=t.$implicit;l(),d("value",e),l(),F(" ",e,`
`)}}function ut(r,t){if(r&1){let e=v();a(0,"div")(1,"input",2),h("change",function(o){let c=_(e).$implicit,u=p();return b(u.onPacienteChange(o,c))}),n(),s(2),n()}if(r&2){let e=t.$implicit;l(),d("value",e.uid),l(),z(" ",e.nombre," ",e.apellido,`
`)}}function mt(r,t){if(r&1){let e=v();a(0,"button",7),h("click",function(){_(e);let o=p().$implicit,c=p();return b(c.cancelarTurno(o))}),s(1," Cancelar Turno "),n()}}function ft(r,t){if(r&1){let e=v();a(0,"button",8),h("click",function(){_(e);let o=p().$implicit,c=p();return b(c.aceptarTurno(o))}),s(1," aceptar turno "),n()}}function ht(r,t){if(r&1){let e=v();a(0,"button",9),h("click",function(){_(e);let o=p().$implicit,c=p();return b(c.finalizarTurno(o))}),s(1," finalizar turno "),n()}}function gt(r,t){if(r&1){let e=v();a(0,"button",10),h("click",function(){_(e);let o=p().$implicit,c=p();return b(c.verResenaTurno(o))}),s(1," ver rese\xF1a "),n()}}function _t(r,t){if(r&1&&(a(0,"tr")(1,"td"),s(2),n(),a(3,"td"),s(4),n(),a(5,"td"),s(6),n(),a(7,"td"),s(8),n(),a(9,"td"),s(10),n(),a(11,"td"),s(12),n(),a(13,"td"),s(14),n(),a(15,"td"),s(16),n(),a(17,"td"),S(18,mt,2,0,"button",3)(19,ft,2,0,"button",4)(20,ht,2,0,"button",5)(21,gt,2,0,"button",6),n()()),r&2){let e=t.$implicit,i=p();l(2),f(e.dni),l(2),f(i.nombrePaciente),l(2),f(e.obraSocial),l(2),f(e.especialista),l(2),f(i.especialidadSeleccionada),l(2),f(e.fecha),l(2),z("",e.hora_inicio," - ",e.hora_fin,""),l(2),f(e.estado),l(2),d("ngIf",e.estado==="solicitado"),l(),d("ngIf",e.estado==="solicitado"),l(),d("ngIf",e.estado==="aceptado"),l(),d("ngIf",e.estado==="realizado")}}var me=class r{constructor(t,e,i){this.turnoService=t;this.especialistaService=e;this.authenticationService=i}especialidades=[];pacientes=[];horarios=[];nombrePaciente="";especialidadSeleccionada="";especialistaIniciado;pacienteSeleccionadoId="";ngOnInit(){this.authenticationService.getUser().subscribe(t=>{t?(this.especialistaIniciado=t,this.cargarPacientes(t.uid),this.cargarEspecialidades()):C.default.fire("Error","No se encontr\xF3 el usuario","error")})}cargarPacientes(t){return m(this,null,function*(){try{this.pacientes=yield this.especialistaService.getPacientesUnicosPorEspecialista(t),console.log("Pacientes cargados:",this.pacientes)}catch(e){console.error("Error cargando pacientes:",e),C.default.fire("Error","No se pudieron cargar los pacientes","error")}})}cargarEspecialidades(){return m(this,null,function*(){this.especialistaIniciado&&this.especialistaIniciado.especialidades?(this.especialidades=this.especialistaIniciado.especialidades,console.log("Especialidades cargadas:",this.especialidades)):(this.especialidades=[],C.default.fire("Error","No se encontraron especialidades para este especialista","error"))})}onEspecialidadChange(t){return m(this,null,function*(){let e=t.target;if(this.especialidadSeleccionada=e.value,this.especialidadSeleccionada)try{this.pacientes=yield this.especialistaService.getPacientesUnicosPorEspecialidad(this.especialistaIniciado.uid,this.especialidadSeleccionada),this.horarios=[]}catch{C.default.fire("Error","No se pudieron cargar los pacientes","error")}else this.pacientes=[],this.horarios=[]})}onPacienteChange(t,e){return m(this,null,function*(){let i=t.target;if(this.pacienteSeleccionadoId=i.value,this.pacienteSeleccionadoId){this.nombrePaciente=`${e.nombre} ${e.apellido}`;try{let o=yield this.turnoService.obtenerTurnosDisponiblesPaciente(this.pacienteSeleccionadoId);this.horarios=o.filter(c=>c.especialidad===this.especialidadSeleccionada),this.horarios.sort((c,u)=>new Date(c.fecha).getTime()-new Date(u.fecha).getTime())}catch{C.default.fire("Error","No se pudieron cargar los turnos","error")}}else this.horarios=[]})}cancelarTurno(t){return m(this,null,function*(){if(["Aceptado","Realizado","Rechazado"].includes(t.estado)){C.default.fire("Aviso","No se puede cancelar un turno aceptado, realizado o rechazado","info");return}let{isConfirmed:e,value:i}=yield C.default.fire({title:"\xBFEst\xE1s seguro de cancelar el turno?",text:"Por favor, ingresa el motivo de la cancelaci\xF3n",input:"textarea",inputPlaceholder:"Escribe aqu\xED el motivo...",inputAttributes:{"aria-label":"Motivo de cancelaci\xF3n"},confirmButtonText:"Cancelar turno",showCancelButton:!0,cancelButtonText:"Volver",inputValidator:o=>o?null:"El motivo es requerido para cancelar el turno"});if(e&&i)try{yield this.turnoService.cancelarTurno(t.id,i),C.default.fire("Cancelado","El turno ha sido cancelado con \xE9xito","success"),this.onPacienteChange({target:{value:this.pacienteSeleccionadoId}},{nombre:this.nombrePaciente})}catch{C.default.fire("Error","No se pudo cancelar el turno","error")}})}aceptarTurno(t){return m(this,null,function*(){if(["Aceptado","Realizado","Rechazado"].includes(t.estado)){C.default.fire("Aviso","No se puede cancelar un turno aceptado, realizado o rechazado","info");return}let{isConfirmed:e}=yield C.default.fire({title:"\xBFEst\xE1s seguro de aceptar el turno?",confirmButtonText:"aceptar turno",showCancelButton:!0,cancelButtonText:"Volver"});if(e)try{yield this.turnoService.aceptarTurno(t.id),C.default.fire("aceptado","El turno ha sido aceptado con \xE9xito","success")}catch{C.default.fire("Error","No se pudo aceptar el turno","error")}})}finalizarTurno(t){return m(this,null,function*(){if(t.estado!=="aceptado"){C.default.fire("Aviso","Solo puedes finalizar un turno aceptado","info");return}let{isConfirmed:e,value:{diagnostico:i,rese\u00F1a:o}}=yield C.default.fire({title:"Finalizar Turno",html:`
        <label for="diagnostico">Diagn\xF3stico:</label>
        <textarea id="diagnostico" rows="3" style="width: 100%;" placeholder="Escribe aqu\xED el diagn\xF3stico..."></textarea>
        <label for="rese\xF1a">Rese\xF1a/Comentario:</label>
        <textarea id="rese\xF1a" rows="3" style="width: 100%;" placeholder="Escribe aqu\xED la rese\xF1a..."></textarea>
      `,focusConfirm:!1,preConfirm:()=>({diagnostico:document.getElementById("diagnostico").value,rese\u00F1a:document.getElementById("rese\xF1a").value}),confirmButtonText:"Finalizar Turno",showCancelButton:!0,cancelButtonText:"Cancelar"});if(e){if(!i||!o){C.default.fire("Error","Ambos campos son obligatorios","error");return}try{yield this.turnoService.finalizarTurno(t.id,{diagnostico:i,rese\u00F1a:o}),C.default.fire("Finalizado","El turno ha sido finalizado con \xE9xito","success"),this.onPacienteChange({target:{value:this.pacienteSeleccionadoId}},{nombre:this.nombrePaciente})}catch{C.default.fire("Error","No se pudo finalizar el turno","error")}}})}verResenaTurno(t){return m(this,null,function*(){if(t.estado!=="realizado"){C.default.fire("Aviso","Solo puedes ver la rese\xF1a de un turno realizado","info");return}try{yield this.turnoService.obtenerRese\u00F1aTurno(t.id)}catch(e){console.error("Error al obtener rese\xF1a:",e),C.default.fire("Error","No se pudo obtener la rese\xF1a","error")}})}static \u0275fac=function(e){return new(e||r)(x(A),x(V),x(T))};static \u0275cmp=O({type:r,selectors:[["app-turnos-especialista"]],decls:31,vars:3,consts:[[4,"ngFor","ngForOf"],["type","radio","name","especialidad",3,"change","value"],["type","radio","name","paciente",3,"change","value"],["class","cancelar",3,"click",4,"ngIf"],["class","aceptar",3,"click",4,"ngIf"],["class","finalizar",3,"click",4,"ngIf"],["class","realizado",3,"click",4,"ngIf"],[1,"cancelar",3,"click"],[1,"aceptar",3,"click"],[1,"finalizar",3,"click"],[1,"realizado",3,"click"]],template:function(e,i){e&1&&(a(0,"h2"),s(1,"Listado de Turnos"),n(),a(2,"label"),s(3,"Especialidad:"),n(),S(4,pt,3,2,"div",0),a(5,"label"),s(6,"Pacientes:"),n(),S(7,ut,3,3,"div",0),a(8,"table")(9,"thead")(10,"tr")(11,"th"),s(12,"DNI"),n(),a(13,"th"),s(14,"Paciente"),n(),a(15,"th"),s(16,"Obra Social"),n(),a(17,"th"),s(18,"Especialista"),n(),a(19,"th"),s(20,"Especialidad"),n(),a(21,"th"),s(22,"Fecha"),n(),a(23,"th"),s(24,"Horario"),n(),a(25,"th"),s(26,"Estado"),n(),a(27,"th"),s(28,"Acciones"),n()()(),a(29,"tbody"),S(30,_t,22,13,"tr",0),n()()),e&2&&(l(4),d("ngForOf",i.especialidades),l(3),d("ngForOf",i.pacientes),l(23),d("ngForOf",i.horarios))},dependencies:[k,D],styles:['@charset "UTF-8";h2[_ngcontent-%COMP%]{color:#154360;text-align:center;margin-bottom:1rem;font-weight:700;font-size:1.5rem}label[_ngcontent-%COMP%]{font-weight:700;color:#154360;margin-right:.5rem}select[_ngcontent-%COMP%]{padding:.5rem;border-radius:4px;border:1px solid #D5D8DC;margin-bottom:1rem;margin-right:1rem;outline:none;transition:border-color .3s ease}select[_ngcontent-%COMP%]:focus{border-color:#154360}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;background-color:#fff;box-shadow:0 4px 8px #0000001a;margin:0 auto;border-radius:8px;overflow:hidden}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:1rem;text-align:left}thead[_ngcontent-%COMP%]{background-color:#154360;color:#fff}thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:700;text-transform:uppercase;letter-spacing:.05em}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:background-color .3s ease,transform .2s ease}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f2f3f4}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#d5e8e8;transform:scale(1.01)}tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom:1px solid #F2F3F4}button[_ngcontent-%COMP%]{padding:.5rem 1rem;font-size:.9rem;border:none;border-radius:4px;color:#fff;cursor:pointer;transition:background-color .3s ease,transform .2s ease;width:100%}button.aceptar[_ngcontent-%COMP%], button.finalizar[_ngcontent-%COMP%], button.realizado[_ngcontent-%COMP%]{background-color:#b0e915}button.aceptar[_ngcontent-%COMP%], button.finalizar[_ngcontent-%COMP%], button.realizado[_ngcontent-%COMP%]{background-color:#82b825;transform:scale(1.05)}button.cancelar[_ngcontent-%COMP%]{background-color:#c0392b}button.cancelar[_ngcontent-%COMP%]:hover{background-color:#a93226;transform:scale(1.05)}td.estado[_ngcontent-%COMP%]{font-weight:700;color:#1e8449}td.estado.inhabilitado[_ngcontent-%COMP%]{color:#c0392b}']})};var fe=class r{constructor(t,e){this.authService=t;this.router=e}canActivate(t,e){return this.authService.getUser().pipe(U(i=>i&&i.role==="especialista"?!0:(this.router.navigate(["/bienvenida"]),console.log("no es especialista verifica las cosas bien"),!1)))}static \u0275fac=function(e){return new(e||r)(M(T),M($))};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})};var E=W(Y());function bt(r,t){if(r&1){let e=v();a(0,"div")(1,"input",1),h("change",function(o){_(e);let c=p();return b(c.onEspecialidadChange(o))}),n(),s(2),n()}if(r&2){let e=t.$implicit;l(),d("value",e.nombre),l(),F(" ",e.nombre,`
`)}}function vt(r,t){if(r&1){let e=v();a(0,"div")(1,"input",2),h("change",function(o){let c=_(e).$implicit,u=p();return b(u.onEspecialistaChange(o,c))}),n(),s(2),n()}if(r&2){let e=t.$implicit;l(),d("value",e.uid),l(),z(" ",e.nombre," ",e.apellido,`
`)}}function St(r,t){if(r&1){let e=v();a(0,"button",7),h("click",function(){_(e);let o=p().$implicit,c=p();return b(c.cancelarTurno(o))}),s(1," Cancelar Turno "),n()}}function xt(r,t){if(r&1){let e=v();a(0,"button",8),h("click",function(){_(e);let o=p().$implicit,c=p();return b(c.verResenaTurno(o))}),s(1," ver rese\xF1a "),n()}}function Ct(r,t){if(r&1){let e=v();a(0,"button",9),h("click",function(){_(e);let o=p().$implicit,c=p();return b(c.mostrarEncuesta(o))}),s(1),n()}if(r&2){let e=p().$implicit;d("disabled",e.encuesta),l(),F(" ",e.encuesta?"Encuesta Realizada":"Realizar Encuesta"," ")}}function Et(r,t){if(r&1){let e=v();a(0,"button",10),h("click",function(){_(e);let o=p().$implicit,c=p();return b(c.calificarAtencion(o))}),s(1),n()}if(r&2){let e=p().$implicit;d("disabled",e.calificacionTurno),l(),F(" ",e.calificacionTurno?"Calificaci\xF3n Realizada":"Calificar Atenci\xF3n"," ")}}function yt(r,t){if(r&1&&(a(0,"tr")(1,"td"),s(2),n(),a(3,"td"),s(4),n(),a(5,"td"),s(6),n(),a(7,"td"),s(8),n(),a(9,"td"),s(10),n(),a(11,"td"),s(12),n(),a(13,"td"),s(14),n(),a(15,"td"),s(16),n(),a(17,"td"),S(18,St,2,0,"button",3)(19,xt,2,0,"button",4)(20,Ct,2,2,"button",5)(21,Et,2,2,"button",6),n()()),r&2){let e=t.$implicit,i=p();l(2),f(e.dni),l(2),f(e.paciente),l(2),f(e.obraSocial),l(2),f(i.nombreEspecialista),l(2),f(e.especialidad),l(2),f(e.fecha),l(2),z("",e.hora_inicio," - ",e.hora_fin,""),l(2),f(e.estado),l(2),d("ngIf",e.estado==="solicitado"),l(),d("ngIf",e.estado==="realizado"),l(),d("ngIf",e.estado==="realizado"),l(),d("ngIf",e.estado==="realizado")}}var he=class r{constructor(t,e,i,o){this.turnoService=t;this.especialidadService=e;this.especialistaService=i;this.authenticationService=o}especialidades=[];especialistas=[];horarios=[];nombreEspecialista;especialidadSeleccionada="";encuesta={};pacienteActual="";ngOnInit(){this.cargarEspecialidades(),this.authenticationService.getUser().subscribe(t=>{t?this.pacienteActual=t:E.default.fire("Error","No se encontr\xF3 el usuario","error")})}cargarEspecialidades(){return m(this,null,function*(){this.especialidades=yield this.especialidadService.getEspecialidades()})}onEspecialidadChange(t){return m(this,null,function*(){let e=t.target;if(this.especialidadSeleccionada=e.value,this.especialidadSeleccionada)try{this.especialistas=yield this.especialistaService.getEspecialistasPorEspecialidad(this.especialidadSeleccionada),this.horarios=[]}catch{E.default.fire("Error","No se pudieron cargar los especialistas","error")}else this.especialistas=[],this.horarios=[]})}onEspecialistaChange(t,e){return m(this,null,function*(){let o=t.target.value;if(o){this.nombreEspecialista=`${e.nombre} ${e.apellido}`;try{let c=yield this.turnoService.obtenerTurnosDisponiblesPacienteEspecialista(this.pacienteActual.uid,o);this.horarios=c.filter(u=>u.especialidad===this.especialidadSeleccionada),this.horarios.sort((u,g)=>new Date(u.fecha).getTime()-new Date(g.fecha).getTime())}catch{E.default.fire("Error","No se pudieron cargar los turnos","error")}}else this.horarios=[]})}cancelarTurno(t){return m(this,null,function*(){if(["Aceptado","Realizado","Rechazado"].includes(t.estado)){E.default.fire("Aviso","No se puede cancelar un turno aceptado, realizado o rechazado","info");return}let{isConfirmed:e,value:i}=yield E.default.fire({title:"\xBFEst\xE1s seguro de cancelar el turno?",text:"Por favor, ingresa el motivo de la cancelaci\xF3n",input:"textarea",inputPlaceholder:"Escribe aqu\xED el motivo...",inputAttributes:{"aria-label":"Motivo de cancelaci\xF3n"},confirmButtonText:"Cancelar turno",showCancelButton:!0,cancelButtonText:"Volver",inputValidator:o=>o?null:"El motivo es requerido para cancelar el turno"});if(e&&i)try{yield this.turnoService.cancelarTurno(t.id,i),E.default.fire("Cancelado","El turno ha sido cancelado con \xE9xito","success"),yield this.onEspecialistaChange({target:{value:t.especialistaId}},{nombre:t.nombreEspecialista,apellido:t.apellidoEspecialista})}catch{E.default.fire("Error","No se pudo cancelar el turno","error")}})}verResenaTurno(t){return m(this,null,function*(){if(t.estado!=="realizado"){E.default.fire("Aviso","Solo puedes ver la rese\xF1a de un turno realizado","info");return}try{yield this.turnoService.obtenerRese\u00F1aTurno(t.id)}catch(e){console.error("Error al obtener rese\xF1a:",e),E.default.fire("Error","No se pudo obtener la rese\xF1a","error")}})}mostrarEncuesta(t){E.default.fire({title:"Completar Encuesta",html:`
        <label for="pregunta1">\xBFC\xF3mo calificar\xEDas la atenci\xF3n del especialista?</label>
        <input type="text" id="pregunta1" class="swal2-input" placeholder="Tu respuesta aqu\xED">
        
        <label for="pregunta2">\xBFEst\xE1s satisfecho con la duraci\xF3n de tu consulta?</label>
        <input type="text" id="pregunta2" class="swal2-input" placeholder="Tu respuesta aqu\xED">
      `,focusConfirm:!1,preConfirm:()=>{let e=document.getElementById("pregunta1").value,i=document.getElementById("pregunta2").value;return(!e||!i)&&E.default.showValidationMessage("Por favor completa todas las preguntas"),{pregunta1:e,pregunta2:i}}}).then(e=>m(this,null,function*(){e.isConfirmed&&(this.encuesta={turnoId:t.id,respuesta1:e.value.pregunta1,respuesta2:e.value.pregunta2},yield this.turnoService.guardarEncuesta(t.id,this.encuesta),E.default.fire("Gracias","Tus respuestas han sido guardadas","success"))}))}calificarAtencion(t){return m(this,null,function*(){if(t.estado!=="realizado"){E.default.fire("Aviso","Solo puedes calificar la atenci\xF3n de un turno realizado","info");return}let{value:e}=yield E.default.fire({title:"Calificar Atenci\xF3n",input:"textarea",inputPlaceholder:"Escribe aqu\xED tu comentario sobre la atenci\xF3n...",showCancelButton:!0,confirmButtonText:"Enviar Comentario",cancelButtonText:"Cancelar",inputValidator:i=>i?null:"El comentario es obligatorio"});e&&(yield this.turnoService.guardarCalificacion(t.id,e),E.default.fire("Gracias","Tu calificaci\xF3n ha sido guardada","success"))})}static \u0275fac=function(e){return new(e||r)(x(A),x(q),x(V),x(T))};static \u0275cmp=O({type:r,selectors:[["app-turnos-pacientes"]],decls:31,vars:3,consts:[[4,"ngFor","ngForOf"],["type","radio","name","especialidad",3,"change","value"],["type","radio","name","especialista",3,"change","value"],["class","cancelar",3,"click",4,"ngIf"],["class","realizado",3,"click",4,"ngIf"],["class","encuesta",3,"disabled","click",4,"ngIf"],["class","calificacion",3,"disabled","click",4,"ngIf"],[1,"cancelar",3,"click"],[1,"realizado",3,"click"],[1,"encuesta",3,"click","disabled"],[1,"calificacion",3,"click","disabled"]],template:function(e,i){e&1&&(a(0,"h2"),s(1,"Listado de Turnos"),n(),a(2,"label"),s(3,"Especialidad:"),n(),S(4,bt,3,2,"div",0),a(5,"label"),s(6,"Especialista:"),n(),S(7,vt,3,3,"div",0),a(8,"table")(9,"thead")(10,"tr")(11,"th"),s(12,"DNI"),n(),a(13,"th"),s(14,"Paciente"),n(),a(15,"th"),s(16,"Obra Social"),n(),a(17,"th"),s(18,"Especialista"),n(),a(19,"th"),s(20,"Especialidad"),n(),a(21,"th"),s(22,"Fecha"),n(),a(23,"th"),s(24,"Horario"),n(),a(25,"th"),s(26,"Estado"),n(),a(27,"th"),s(28,"Acciones"),n()()(),a(29,"tbody"),S(30,yt,22,13,"tr",0),n()()),e&2&&(l(4),d("ngForOf",i.especialidades),l(3),d("ngForOf",i.especialistas),l(23),d("ngForOf",i.horarios))},dependencies:[k,D],styles:['@charset "UTF-8";h2[_ngcontent-%COMP%]{color:#154360;text-align:center;margin-bottom:1rem;font-weight:700;font-size:1.5rem}label[_ngcontent-%COMP%]{font-weight:700;color:#154360;margin-right:.5rem}select[_ngcontent-%COMP%]{padding:.5rem;border-radius:4px;border:1px solid #D5D8DC;margin-bottom:1rem;margin-right:1rem;outline:none;transition:border-color .3s ease}select[_ngcontent-%COMP%]:focus{border-color:#154360}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;background-color:#fff;box-shadow:0 4px 8px #0000001a;margin:0 auto;border-radius:8px;overflow:hidden}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:1rem;text-align:left}thead[_ngcontent-%COMP%]{background-color:#154360;color:#fff}thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:700;text-transform:uppercase;letter-spacing:.05em}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:background-color .3s ease,transform .2s ease}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f2f3f4}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#d5e8e8;transform:scale(1.01)}tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom:1px solid #F2F3F4}button[_ngcontent-%COMP%]{padding:.5rem 1rem;font-size:.9rem;border:none;border-radius:4px;color:#fff;cursor:pointer;transition:background-color .3s ease,transform .2s ease;width:100%}button.realizado[_ngcontent-%COMP%], button.encuesta[_ngcontent-%COMP%], button.calificacion[_ngcontent-%COMP%]{margin-bottom:3px;background-color:#b0e915}button.realizado[_ngcontent-%COMP%]:hover, button.encuesta[_ngcontent-%COMP%]:hover, button.calificacion[_ngcontent-%COMP%]:hover{background-color:#82b825;transform:scale(1.05)}button.cancelar[_ngcontent-%COMP%]{background-color:#c0392b}button.cancelar[_ngcontent-%COMP%]:hover{background-color:#a93226;transform:scale(1.05)}td.estado[_ngcontent-%COMP%]{font-weight:700;color:#1e8449}td.estado.inhabilitado[_ngcontent-%COMP%]{color:#c0392b}']})};var ge=class r{constructor(t,e){this.authService=t;this.router=e}canActivate(t,e){return this.authService.getUser().pipe(U(i=>i&&i.role==="paciente"?!0:(this.router.navigate(["/bienvenida"]),console.log("no es paciente verifica las cosas bien"),!1)))}static \u0275fac=function(e){return new(e||r)(M(T),M($))};static \u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})};var Tt=[{path:"solicitar-turno",component:re,canActivate:[de]},{path:"gestionar-horarios",component:pe,canActivate:[ye]},{path:"gestionar-turnos",component:ue,canActivate:[ye]},{path:"turnos-especialista",component:me,canActivate:[fe]},{path:"turnos-pacientes",component:he,canActivate:[ge]}],_e=class r{static \u0275fac=function(e){return new(e||r)};static \u0275mod=Z({type:r});static \u0275inj=X({imports:[Ee.forChild(Tt),Ee]})};var Qe=class r{static \u0275fac=function(e){return new(e||r)};static \u0275mod=Z({type:r});static \u0275inj=X({imports:[Ce,_e,Le,We,Ce,Be]})};export{Qe as SeccionTurnosModule};
